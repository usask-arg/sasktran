#include <sasktran.h>
#include "include/short_test_suite.h"
#include <boost/timer/timer.hpp>


/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test		 2015- 3- 10*/
/** **/
/*---------------------------------------------------------------------------*/

class SKTRAN_Emission_Test
{
	private:
		bool											m_dolimb;					// if true then do the limb tests
//		bool											m_doSO;						// IF true then do SO testing;
		SKTRANSO_SpecificationsUser_Legacy				m_sospecs;
		SKTRAN_AtmosphericOpticalState_V21				m_opticalstateso;
		SKTRAN_LineOfSightArray_V21						m_linesofsight;
		std::vector<double>								m_tanheights_meters;
		nxVector										m_sun;
		std::vector<double>								m_wavelen;

	private:
		bool											SO_Scatter					( nx2dArray<double>& radiance, size_t scattorder );
		bool											MakeLimbBasedLinesOfSight	();
		bool											MakeGroundBasedLinesOfSight	();
		bool											MakeOpticalState			( SKTRAN_AtmosphericOpticalState_V21& opticalstate);
		bool											MakeWavelengths				();
		bool											RunStandardTest				();
		bool											Initialize					();

	public:
														SKTRAN_Emission_Test			();
													   ~SKTRAN_Emission_Test			();
		bool											RunTests					();
		bool											RunGroundBasedTests			();
		
};


static double g_emissionlayertable[]=
{
   1000.0000,   2.120116866051e-28,   1.413411244034e-27,   7.067056220170e-28, 
   1250.0000,   3.615129074449e-28,   2.410086049632e-27,   1.205043024816e-27, 
   1500.0000,   6.154342912648e-28,   4.102895275099e-27,   2.051447637549e-27, 
   1750.0000,   1.046004252164e-27,   6.973361681091e-27,   3.486680840546e-27, 
   2000.0000,   1.774921234167e-27,   1.183280822778e-26,   5.916404113890e-27, 
   2250.0000,   3.006897307695e-27,   2.004598205130e-26,   1.002299102565e-26, 
   2500.0000,   5.085714583448e-27,   3.390476388965e-26,   1.695238194483e-26, 
   2750.0000,   8.587747102793e-27,   5.725164735196e-26,   2.862582367598e-26, 
   3000.0000,   1.447772709163e-26,   9.651818061086e-26,   4.825909030543e-26, 
   3250.0000,   2.436774835660e-26,   1.624516557107e-25,   8.122582785534e-26, 
   3500.0000,   4.094720779532e-26,   2.729813853021e-25,   1.364906926511e-25, 
   3750.0000,   6.869530557992e-26,   4.579687038661e-25,   2.289843519331e-25, 
   4000.0000,   1.150598234100e-25,   7.670654893999e-25,   3.835327447000e-25, 
   4250.0000,   1.924040558105e-25,   1.282693705403e-24,   6.413468527016e-25, 
   4500.0000,   3.212170712569e-25,   2.141447141712e-24,   1.070723570856e-24, 
   4750.0000,   5.353981787659e-25,   3.569321191772e-24,   1.784660595886e-24, 
   5000.0000,   8.909411887091e-25,   5.939607924727e-24,   2.969803962364e-24, 
   5250.0000,   1.480181802514e-24,   9.867878683428e-24,   4.933939341714e-24, 
   5500.0000,   2.455132640871e-24,   1.636755093914e-23,   8.183775469570e-24, 
   5750.0000,   4.065638271494e-24,   2.710425514329e-23,   1.355212757165e-23, 
   6000.0000,   6.721657627653e-24,   4.481105085102e-23,   2.240552542551e-23, 
   6250.0000,   1.109476008288e-23,   7.396506721921e-23,   3.698253360961e-23, 
   6500.0000,   1.828324668972e-23,   1.218883112648e-22,   6.094415563241e-23, 
   6750.0000,   3.008033017066e-23,   2.005355344711e-22,   1.002677672355e-22, 
   7000.0000,   4.940896479275e-23,   3.293930986183e-22,   1.646965493092e-22, 
   7250.0000,   8.102569905079e-23,   5.401713270053e-22,   2.700856635026e-22, 
   7500.0000,   1.326580760850e-22,   8.843871739001e-22,   4.421935869501e-22, 
   7750.0000,   2.168395405810e-22,   1.445596937207e-21,   7.227984686033e-22, 
   8000.0000,   3.538646160603e-22,   2.359097440402e-21,   1.179548720201e-21, 
   8250.0000,   5.765403062799e-22,   3.843602041866e-21,   1.921801020933e-21, 
   8500.0000,   9.378126499452e-22,   6.252084332968e-21,   3.126042166484e-21, 
   8750.0000,   1.522987625501e-21,   1.015325083668e-20,   5.076625418338e-21, 
   9000.0000,   2.469281136799e-21,   1.646187424533e-20,   8.230937122663e-21, 
   9250.0000,   3.997040777826e-21,   2.664693851884e-20,   1.332346925942e-20, 
   9500.0000,   6.459523687647e-21,   4.306349125098e-20,   2.153174562549e-20, 
   9750.0000,   1.042212523406e-20,   6.948083489373e-20,   3.474041744687e-20, 
  10000.0000,   1.678827040598e-20,   1.119218027065e-19,   5.596090135327e-20, 
  10250.0000,   2.699911321672e-20,   1.799940881114e-19,   8.999704405572e-20, 
  10500.0000,   4.334978225792e-20,   2.889985483861e-19,   1.444992741931e-19, 
  10750.0000,   6.948934479447e-20,   4.632622986298e-19,   2.316311493149e-19, 
  11000.0000,   1.112098843801e-19,   7.413992292008e-19,   3.706996146004e-19, 
  11250.0000,   1.776897751119e-19,   1.184598500746e-18,   5.922992503730e-19, 
  11500.0000,   2.834492826498e-19,   1.889661884332e-18,   9.448309421661e-19, 
  11750.0000,   4.514214202241e-19,   3.009476134828e-18,   1.504738067414e-18, 
  12000.0000,   7.177659290251e-19,   4.785106193501e-18,   2.392553096750e-18, 
  12250.0000,   1.139403087582e-18,   7.596020583877e-18,   3.798010291939e-18, 
  12500.0000,   1.805784083045e-18,   1.203856055363e-17,   6.019280276816e-18, 
  12750.0000,   2.857249236559e-18,   1.904832824373e-17,   9.524164121864e-18, 
  13000.0000,   4.513612858929e-18,   3.009075239286e-17,   1.504537619643e-17, 
  13250.0000,   7.118596272667e-18,   4.745730848445e-17,   2.372865424222e-17, 
  13500.0000,   1.120877872310e-17,   7.472519148736e-17,   3.736259574368e-17, 
  13750.0000,   1.762041385274e-17,   1.174694256849e-16,   5.873471284247e-17, 
  14000.0000,   2.765462599647e-17,   1.843641733098e-16,   9.218208665490e-17, 
  14250.0000,   4.333246055270e-17,   2.888830703513e-16,   1.444415351757e-16, 
  14500.0000,   6.778799477305e-17,   4.519199651536e-16,   2.259599825768e-16, 
  14750.0000,   1.058732147585e-16,   7.058214317231e-16,   3.529107158615e-16, 
  15000.0000,   1.650871573093e-16,   1.100581048729e-15,   5.502905243645e-16, 
  15250.0000,   2.570007285090e-16,   1.713338190060e-15,   8.566690950300e-16, 
  15500.0000,   3.994379236585e-16,   2.662919491057e-15,   1.331459745528e-15, 
  15750.0000,   6.198093346768e-16,   4.132062231179e-15,   2.066031115589e-15, 
  16000.0000,   9.601980194969e-16,   6.401320129979e-15,   3.200660064990e-15, 
  16250.0000,   1.485105734613e-15,   9.900704897422e-15,   4.950352448711e-15, 
  16500.0000,   2.293231086553e-15,   1.528820724369e-14,   7.644103621843e-15, 
  16750.0000,   3.535347771050e-15,   2.356898514033e-14,   1.178449257017e-14, 
  17000.0000,   5.441396074605e-15,   3.627597383070e-14,   1.813798691535e-14, 
  17250.0000,   8.361465696078e-15,   5.574310464052e-14,   2.787155232026e-14, 
  17500.0000,   1.282768721623e-14,   8.551791477484e-14,   4.275895738742e-14, 
  17750.0000,   1.964754025350e-14,   1.309836016900e-13,   6.549180084501e-14, 
  18000.0000,   3.004428608362e-14,   2.002952405575e-13,   1.001476202787e-13, 
  18250.0000,   4.586796434405e-14,   3.057864289604e-13,   1.528932144802e-13, 
  18500.0000,   6.991187016396e-14,   4.660791344264e-13,   2.330395672132e-13, 
  18750.0000,   1.063864333906e-13,   7.092428892710e-13,   3.546214446355e-13, 
  19000.0000,   1.616275742723e-13,   1.077517161815e-12,   5.387585809075e-13, 
  19250.0000,   2.451537476733e-13,   1.634358317822e-12,   8.171791589110e-13, 
  19500.0000,   3.712406243714e-13,   2.474937495809e-12,   1.237468747905e-12, 
  19750.0000,   5.612628900098e-13,   3.741752600066e-12,   1.870876300033e-12, 
  20000.0000,   8.471709164864e-13,   5.647806109909e-12,   2.823903054955e-12, 
  20250.0000,   1.276643457094e-12,   8.510956380625e-12,   4.255478190313e-12, 
  20500.0000,   1.920711274354e-12,   1.280474182902e-11,   6.402370914512e-12, 
  20750.0000,   2.885017311939e-12,   1.923344874626e-11,   9.616724373130e-12, 
  21000.0000,   4.326419600632e-12,   2.884279733755e-11,   1.442139866877e-11, 
  21250.0000,   6.477429986360e-12,   4.318286657573e-11,   2.159143328787e-11, 
  21500.0000,   9.682125183144e-12,   6.454750122096e-11,   3.227375061048e-11, 
  21750.0000,   1.444882514848e-11,   9.632550098986e-11,   4.816275049493e-11, 
  22000.0000,   2.152723509057e-11,   1.435149006038e-10,   7.175745030192e-11, 
  22250.0000,   3.202121803320e-11,   2.134747868880e-10,   1.067373934440e-10, 
  22500.0000,   4.755337197711e-11,   3.170224798474e-10,   1.585112399237e-10, 
  22750.0000,   7.050479661011e-11,   4.700319774008e-10,   2.350159887004e-10, 
  23000.0000,   1.043638005946e-10,   6.957586706305e-10,   3.478793353152e-10, 
  23250.0000,   1.542321755329e-10,   1.028214503553e-09,   5.141072517763e-10, 
  23500.0000,   2.275589697696e-10,   1.517059798464e-09,   7.585298992319e-10, 
  23750.0000,   3.352021605848e-10,   2.234681070565e-09,   1.117340535283e-09, 
  24000.0000,   4.929621052160e-10,   3.286414034773e-09,   1.643207017387e-09, 
  24250.0000,   7.237925991223e-10,   4.825283994148e-09,   2.412641997074e-09, 
  24500.0000,   1.060983467168e-09,   7.073223114451e-09,   3.536611557226e-09, 
  24750.0000,   1.552733671937e-09,   1.035155781291e-08,   5.175778906457e-09, 
  25000.0000,   2.268711129633e-09,   1.512474086422e-08,   7.562370432109e-09, 
  25250.0000,   3.309446068724e-09,   2.206297379149e-08,   1.103148689575e-08, 
  25500.0000,   4.819758642513e-09,   3.213172428342e-08,   1.606586214171e-08, 
  25750.0000,   7.007920225538e-09,   4.671946817026e-08,   2.335973408513e-08, 
  26000.0000,   1.017294939445e-08,   6.781966262968e-08,   3.390983131484e-08, 
  26250.0000,   1.474342873270e-08,   9.828952488464e-08,   4.914476244232e-08, 
  26500.0000,   2.133260940394e-08,   1.422173960263e-07,   7.110869801313e-08, 
  26750.0000,   3.081650230046e-08,   2.054433486697e-07,   1.027216743349e-07, 
  27000.0000,   4.444435247727e-08,   2.962956831818e-07,   1.481478415909e-07, 
  27250.0000,   6.399465441046e-08,   4.266310294031e-07,   2.133155147015e-07, 
  27500.0000,   9.199509855478e-08,   6.133006570319e-07,   3.066503285159e-07, 
  27750.0000,   1.320321076206e-07,   8.802140508037e-07,   4.401070254019e-07, 
  28000.0000,   1.891856968196e-07,   1.261237978797e-06,   6.306189893986e-07, 
  28250.0000,   2.706393351925e-07,   1.804262234616e-06,   9.021311173082e-07, 
  28500.0000,   3.865337436927e-07,   2.576891624618e-06,   1.288445812309e-06, 
  28750.0000,   5.511601175958e-07,   3.674400783972e-06,   1.837200391986e-06, 
  29000.0000,   7.846248005530e-07,   5.230832003687e-06,   2.615416001843e-06, 
  29250.0000,   1.115167629431e-06,   7.434450862873e-06,   3.717225431437e-06, 
  29500.0000,   1.582384986197e-06,   1.054923324131e-05,   5.274616620657e-06, 
  29750.0000,   2.241702772259e-06,   1.494468514840e-05,   7.472342574198e-06, 
  30000.0000,   3.170573169751e-06,   2.113715446501e-05,   1.056857723250e-05, 
  30250.0000,   4.477044462835e-06,   2.984696308556e-05,   1.492348154278e-05, 
  30500.0000,   6.311591910544e-06,   4.207727940363e-05,   2.103863970181e-05, 
  30750.0000,   8.883421935629e-06,   5.922281290420e-05,   2.961140645210e-05, 
  31000.0000,   1.248290156064e-05,   8.321934373761e-05,   4.160967186880e-05, 
  31250.0000,   1.751236003137e-05,   1.167490668758e-04,   5.837453343790e-05, 
  31500.0000,   2.452831329475e-05,   1.635220886317e-04,   8.176104431584e-05, 
  31750.0000,   3.429924561985e-05,   2.286616374657e-04,   1.143308187328e-04, 
  32000.0000,   4.788454089063e-05,   3.192302726042e-04,   1.596151363021e-04, 
  32250.0000,   6.674211476943e-05,   4.449474317962e-04,   2.224737158981e-04, 
  32500.0000,   9.287492479806e-05,   6.191661653204e-04,   3.095830826602e-04, 
  32750.0000,   1.290300491826e-04,   8.602003278838e-04,   4.301001639419e-04, 
  33000.0000,   1.789687177570e-04,   1.193124785047e-03,   5.965623925235e-04, 
  33250.0000,   2.478319341921e-04,   1.652212894614e-03,   8.261064473071e-04, 
  33500.0000,   3.426346514985e-04,   2.284231009990e-03,   1.142115504995e-03, 
  33750.0000,   4.729325154154e-04,   3.152883436102e-03,   1.576441718051e-03, 
  34000.0000,   6.517198394797e-04,   4.344798929865e-03,   2.172399464932e-03, 
  34250.0000,   8.966368546582e-04,   5.977579031055e-03,   2.988789515527e-03, 
  34500.0000,   1.231589863323e-03,   8.210599088819e-03,   4.105299544409e-03, 
  34750.0000,   1.688921645635e-03,   1.125947763757e-02,   5.629738818783e-03, 
  35000.0000,   2.312313814443e-03,   1.541542542962e-02,   7.707712714810e-03, 
  35250.0000,   3.160661030849e-03,   2.107107353900e-02,   1.053553676950e-02, 
  35500.0000,   4.313233265142e-03,   2.875488843428e-02,   1.437744421714e-02, 
  35750.0000,   5.876542023001e-03,   3.917694682001e-02,   1.958847341000e-02, 
  36000.0000,   7.993456618182e-03,   5.328971078788e-02,   2.664485539394e-02, 
  36250.0000,   1.085528611022e-02,   7.236857406812e-02,   3.618428703406e-02, 
  36500.0000,   1.471776291845e-02,   9.811841945635e-02,   4.905920972818e-02, 
  36750.0000,   1.992215006364e-02,   1.328143337576e-01,   6.640716687880e-02, 
  37000.0000,   2.692306423888e-02,   1.794870949259e-01,   8.974354746294e-02, 
  37250.0000,   3.632508538453e-02,   2.421672358969e-01,   1.210836179484e-01, 
  37500.0000,   4.893084054368e-02,   3.262056036245e-01,   1.631028018123e-01, 
  37750.0000,   6.580404408876e-02,   4.386936272584e-01,   2.193468136292e-01, 
  38000.0000,   8.835199678504e-02,   5.890133119003e-01,   2.945066559501e-01, 
  38250.0000,   1.184333543070e-01,   7.895556953798e-01,   3.947778476899e-01, 
  38500.0000,   1.584986495407e-01,   1.056657663605e+00,   5.283288318023e-01, 
  38750.0000,   2.117731901335e-01,   1.411821267557e+00,   7.059106337783e-01, 
  39000.0000,   2.824946760778e-01,   1.883297840519e+00,   9.416489202594e-01, 
  39250.0000,   3.762213453854e-01,   2.508142302569e+00,   1.254071151285e+00, 
  39500.0000,   5.002308511952e-01,   3.334872341301e+00,   1.667436170651e+00, 
  39750.0000,   6.640356403707e-01,   4.426904269138e+00,   2.213452134569e+00, 
  40000.0000,   8.800476395115e-01,   5.866984263410e+00,   2.933492131705e+00, 
  40250.0000,   1.164433928731e+00,   7.762892858206e+00,   3.881446429103e+00, 
  40500.0000,   1.538216253796e+00,   1.025477502530e+01,   5.127387512652e+00, 
  40750.0000,   2.028681257974e+00,   1.352454171983e+01,   6.762270859913e+00, 
  41000.0000,   2.671185901915e+00,   1.780790601277e+01,   8.903953006385e+00, 
  41250.0000,   3.511464538173e+00,   2.340976358782e+01,   1.170488179391e+01, 
  41500.0000,   4.608571565069e+00,   3.072381043379e+01,   1.536190521690e+01, 
  41750.0000,   6.038627784948e+00,   4.025751856632e+01,   2.012875928316e+01, 
  42000.0000,   7.899581099256e+00,   5.266387399504e+01,   2.633193699752e+01, 
  42250.0000,   1.031724489208e+01,   6.878163261389e+01,   3.439081630695e+01, 
  42500.0000,   1.345294269720e+01,   8.968628464802e+01,   4.484314232401e+01, 
  42750.0000,   1.751316831189e+01,   1.167544554126e+02,   5.837722770628e+01, 
  43000.0000,   2.276176979702e+01,   1.517451319801e+02,   7.587256599006e+01, 
  43250.0000,   2.953528786326e+01,   1.969019190884e+02,   9.845095954419e+01, 
  43500.0000,   3.826222888578e+01,   2.550815259052e+02,   1.275407629526e+02, 
  43750.0000,   4.948723608636e+01,   3.299149072424e+02,   1.649574536212e+02, 
  44000.0000,   6.390134628899e+01,   4.260089752599e+02,   2.130044876300e+02, 
  44250.0000,   8.237979245977e+01,   5.491986163985e+02,   2.745993081992e+02, 
  44500.0000,   1.060291439287e+02,   7.068609595245e+02,   3.534304797623e+02, 
  44750.0000,   1.362459785502e+02,   9.083065236682e+02,   4.541532618341e+02, 
  45000.0000,   1.747897680290e+02,   1.165265120193e+03,   5.826325600966e+02, 
  45250.0000,   2.238732456415e+02,   1.492488304277e+03,   7.462441521383e+02, 
  45500.0000,   2.862742339363e+02,   1.908494892909e+03,   9.542474464543e+02, 
  45750.0000,   3.654737613057e+02,   2.436491742038e+03,   1.218245871019e+03, 
  46000.0000,   4.658263170248e+02,   3.105508780165e+03,   1.552754390083e+03, 
  46250.0000,   5.927693152123e+02,   3.951795434749e+03,   1.975897717374e+03, 
  46500.0000,   7.530802948977e+02,   5.020535299318e+03,   2.510267649659e+03, 
  46750.0000,   9.551921173040e+02,   6.367947448694e+03,   3.183973724347e+03, 
  47000.0000,   1.209578480223e+03,   8.063856534821e+03,   4.031928267411e+03, 
  47250.0000,   1.529224507706e+03,   1.019483005137e+04,   5.097415025685e+03, 
  47500.0000,   1.930200053920e+03,   1.286800035946e+04,   6.434000179732e+03, 
  47750.0000,   2.432356754447e+03,   1.621571169632e+04,   8.107855848158e+03, 
  48000.0000,   3.060173847771e+03,   2.040115898514e+04,   1.020057949257e+04, 
  48250.0000,   3.843782466260e+03,   2.562521644173e+04,   1.281260822087e+04, 
  48500.0000,   4.820203563346e+03,   3.213469042230e+04,   1.606734521115e+04, 
  48750.0000,   6.034841018208e+03,   4.023227345472e+04,   2.011613672736e+04, 
  49000.0000,   7.543278871384e+03,   5.028852580922e+04,   2.514426290461e+04, 
  49250.0000,   9.413440239026e+03,   6.275626826017e+04,   3.137813413009e+04, 
  49500.0000,   1.172817539041e+04,   7.818783593605e+04,   3.909391796802e+04, 
  49750.0000,   1.458835792924e+04,   9.725571952824e+04,   4.862785976412e+04, 
  50000.0000,   1.811658118774e+04,   1.207772079183e+05,   6.038860395913e+04, 
  50250.0000,   2.246156203382e+04,   1.497437468921e+05,   7.487187344606e+04, 
  50500.0000,   2.780337653360e+04,   1.853558435573e+05,   9.267792177865e+04, 
  50750.0000,   3.435967154902e+04,   2.290644769935e+05,   1.145322384967e+05, 
  51000.0000,   4.239301864361e+04,   2.826201242907e+05,   1.413100621454e+05, 
  51250.0000,   5.221960189480e+04,   3.481306792987e+05,   1.740653396493e+05, 
  51500.0000,   6.421945965729e+04,   4.281297310486e+05,   2.140648655243e+05, 
  51750.0000,   7.884853228736e+04,   5.256568819157e+05,   2.628284409579e+05, 
  52000.0000,   9.665280362959e+04,   6.443520241972e+05,   3.221760120986e+05, 
  52250.0000,   1.182848639928e+05,   7.885657599522e+05,   3.942828799761e+05, 
  52500.0000,   1.445232667072e+05,   9.634884447148e+05,   4.817442223574e+05, 
  52750.0000,   1.762950994535e+05,   1.175300663023e+06,   5.876503315117e+05, 
  53000.0000,   2.147022456680e+05,   1.431348304453e+06,   7.156741522267e+05, 
  53250.0000,   2.610518706999e+05,   1.740345804666e+06,   8.701729023331e+05, 
  53500.0000,   3.168917322447e+05,   2.112611548298e+06,   1.056305774149e+06, 
  53750.0000,   3.840509850562e+05,   2.560339900375e+06,   1.280169950187e+06, 
  54000.0000,   4.646872261468e+05,   3.097914840979e+06,   1.548957420489e+06, 
  54250.0000,   5.613406086262e+05,   3.742270724174e+06,   1.871135362087e+06, 
  54500.0000,   6.769959399229e+05,   4.513306266153e+06,   2.256653133076e+06, 
  54750.0000,   8.151537731654e+05,   5.434358487769e+06,   2.717179243885e+06, 
  55000.0000,   9.799115986170e+05,   6.532743990780e+06,   3.266371995390e+06, 
  55250.0000,   1.176056344761e+06,   7.840375631739e+06,   3.920187815869e+06, 
  55500.0000,   1.409169505192e+06,   9.394463367949e+06,   4.697231683974e+06, 
  55750.0000,   1.685746317006e+06,   1.123830878004e+07,   5.619154390019e+06, 
  56000.0000,   2.013330527675e+06,   1.342220351784e+07,   6.711101758918e+06, 
  56250.0000,   2.400666399137e+06,   1.600444266091e+07,   8.002221330456e+06, 
  56500.0000,   2.857869708125e+06,   1.905246472083e+07,   9.526232360416e+06, 
  56750.0000,   3.396619608833e+06,   2.264413072555e+07,   1.132206536278e+07, 
  57000.0000,   4.030373325219e+06,   2.686915550146e+07,   1.343457775073e+07, 
  57250.0000,   4.774605733099e+06,   3.183070488733e+07,   1.591535244366e+07, 
  57500.0000,   5.647075973436e+06,   3.764717315624e+07,   1.882358657812e+07, 
  57750.0000,   6.668123304473e+06,   4.445415536315e+07,   2.222707768158e+07, 
  58000.0000,   7.860994447692e+06,   5.240662965128e+07,   2.620331482564e+07, 
  58250.0000,   9.252204706764e+06,   6.168136471176e+07,   3.084068235588e+07, 
  58500.0000,   1.087193513505e+07,   7.247956756701e+07,   3.623978378351e+07, 
  58750.0000,   1.275446799085e+07,   8.502978660570e+07,   4.251489330285e+07, 
  59000.0000,   1.493866264510e+07,   9.959108430065e+07,   4.979554215033e+07, 
  59250.0000,   1.746847398807e+07,   1.164564932538e+08,   5.822824662690e+07, 
  59500.0000,   2.039351521417e+07,   1.359567680945e+08,   6.797838404723e+07, 
  59750.0000,   2.376966664059e+07,   1.584644442706e+08,   7.923222213531e+07, 
  60000.0000,   2.765973193145e+07,   1.843982128763e+08,   9.219910643817e+07, 
  60250.0000,   3.213414274694e+07,   2.142276183130e+08,   1.071138091565e+08, 
  60500.0000,   3.727171241217e+07,   2.484780827478e+08,   1.242390413739e+08, 
  60750.0000,   4.316043869666e+07,   2.877362579777e+08,   1.438681289889e+08, 
  61000.0000,   4.989835520831e+07,   3.326557013888e+08,   1.663278506944e+08, 
  61250.0000,   5.759443023049e+07,   3.839628682033e+08,   1.919814341016e+08, 
  61500.0000,   6.636951106420e+07,   4.424634070946e+08,   2.212317035473e+08, 
  61750.0000,   7.635731107699e+07,   5.090487405133e+08,   2.545243702566e+08, 
  62000.0000,   8.770543570464e+07,   5.847029046976e+08,   2.923514523488e+08, 
  62250.0000,   1.005764426011e+08,   6.705096173407e+08,   3.352548086703e+08, 
  62500.0000,   1.151489299891e+08,   7.676595332607e+08,   3.838297666303e+08, 
  62750.0000,   1.316186460315e+08,   8.774576402101e+08,   4.387288201050e+08, 
  63000.0000,   1.501996107282e+08,   1.001330738188e+09,   5.006653690940e+08, 
  63250.0000,   1.711252404533e+08,   1.140834936355e+09,   5.704174681776e+08, 
  63500.0000,   1.946494637938e+08,   1.297663091959e+09,   6.488315459795e+08, 
  63750.0000,   2.210478158476e+08,   1.473652105651e+09,   7.368260528254e+08, 
  64000.0000,   2.506184965984e+08,   1.670789977323e+09,   8.353949886615e+08, 
  64250.0000,   2.836833774368e+08,   1.891222516246e+09,   9.456112581228e+08, 
  64500.0000,   3.205889383467e+08,   2.137259588978e+09,   1.068629794489e+09, 
  64750.0000,   3.617071167680e+08,   2.411380778453e+09,   1.205690389227e+09, 
  65000.0000,   4.074360476915e+08,   2.716240317943e+09,   1.358120158972e+09, 
  65250.0000,   4.582006731828e+08,   3.054671154552e+09,   1.527335577276e+09, 
  65500.0000,   5.144531982944e+08,   3.429687988629e+09,   1.714843994315e+09, 
  65750.0000,   5.766733692462e+08,   3.844489128308e+09,   1.922244564154e+09, 
  66000.0000,   6.453685488773e+08,   4.302456992515e+09,   2.151228496258e+09, 
  66250.0000,   7.210735637201e+08,   4.807157091467e+09,   2.403578545734e+09, 
  66500.0000,   8.043502966792e+08,   5.362335311195e+09,   2.681167655597e+09, 
  66750.0000,   8.957869992335e+08,   5.971913328223e+09,   2.985956664112e+09, 
  67000.0000,   9.959972973720e+08,   6.639981982480e+09,   3.319990991240e+09, 
  67250.0000,   1.105618866153e+09,   7.370792441020e+09,   3.685396220510e+09, 
  67500.0000,   1.225311748874e+09,   8.168744992494e+09,   4.084372496247e+09, 
  67750.0000,   1.355756298399e+09,   9.038375322660e+09,   4.519187661330e+09, 
  68000.0000,   1.497650720222e+09,   9.984338134810e+09,   4.992169067405e+09, 
  68250.0000,   1.651708199385e+09,   1.101138799590e+10,   5.505693997950e+09, 
  68500.0000,   1.818653596438e+09,   1.212435730958e+10,   6.062178654792e+09, 
  68750.0000,   1.999219701183e+09,   1.332813134122e+10,   6.664065670609e+09, 
  69000.0000,   2.194143037108e+09,   1.462762024739e+10,   7.313810123693e+09, 
  69250.0000,   2.404159213998e+09,   1.602772809332e+10,   8.013864046662e+09, 
  69500.0000,   2.629997831384e+09,   1.753331887589e+10,   8.766659437947e+09, 
  69750.0000,   2.872376941076e+09,   1.914917960717e+10,   9.574589803586e+09, 
  70000.0000,   3.131997083089e+09,   2.087998055392e+10,   1.043999027696e+10, 
  70250.0000,   3.409534915676e+09,   2.273023277117e+10,   1.136511638559e+10, 
  70500.0000,   3.705636466947e+09,   2.470424311298e+10,   1.235212155649e+10, 
  70750.0000,   4.020910042537e+09,   2.680606695025e+10,   1.340303347512e+10, 
  71000.0000,   4.355918830954e+09,   2.903945887303e+10,   1.451972943651e+10, 
  71250.0000,   4.711173255473e+09,   3.140782170315e+10,   1.570391085158e+10, 
  71500.0000,   5.087123128617e+09,   3.391415419078e+10,   1.695707709539e+10, 
  71750.0000,   5.484149672349e+09,   3.656099781566e+10,   1.828049890783e+10, 
  72000.0000,   5.902557473855e+09,   3.935038315904e+10,   1.967519157952e+10, 
  72250.0000,   6.342566453203e+09,   4.228377635469e+10,   2.114188817734e+10, 
  72500.0000,   6.804303925046e+09,   4.536202616697e+10,   2.268101308349e+10, 
  72750.0000,   7.287796841740e+09,   4.858531227827e+10,   2.429265613913e+10, 
  73000.0000,   7.792964309727e+09,   5.195309539818e+10,   2.597654769909e+10, 
  73250.0000,   8.319610474534e+09,   5.546406983023e+10,   2.773203491511e+10, 
  73500.0000,   8.867417872296e+09,   5.911611914864e+10,   2.955805957432e+10, 
  73750.0000,   9.435941347068e+09,   6.290627564712e+10,   3.145313782356e+10, 
  74000.0000,   1.002460263335e+10,   6.683068422233e+10,   3.341534211117e+10, 
  74250.0000,   1.063268570204e+10,   7.088457134696e+10,   3.544228567348e+10, 
  74500.0000,   1.125933296554e+10,   7.506221977028e+10,   3.753110988514e+10, 
  74750.0000,   1.190354243355e+10,   7.935694955702e+10,   3.967847477851e+10, 
  75000.0000,   1.256416590586e+10,   8.376110603904e+10,   4.188055301952e+10, 
  75250.0000,   1.323990828112e+10,   8.826605520750e+10,   4.413302760375e+10, 
  75500.0000,   1.392932805257e+10,   9.286218701712e+10,   4.643109350856e+10, 
  75750.0000,   1.463083905123e+10,   9.753892700823e+10,   4.876946350411e+10, 
  76000.0000,   1.534271348658e+10,   1.022847565772e+11,   5.114237828860e+10, 
  76250.0000,   1.606308632146e+10,   1.070872421431e+11,   5.354362107153e+10, 
  76500.0000,   1.678996100497e+10,   1.119330733665e+11,   5.596653668324e+10, 
  76750.0000,   1.752121657204e+10,   1.168081104803e+11,   5.840405524013e+10, 
  77000.0000,   1.825461610308e+10,   1.216974406872e+11,   6.084872034359e+10, 
  77250.0000,   1.898781652099e+10,   1.265854434733e+11,   6.329272173664e+10, 
  77500.0000,   1.971837968629e+10,   1.314558645753e+11,   6.572793228764e+10, 
  77750.0000,   2.044378473425e+10,   1.362918982283e+11,   6.814594911417e+10, 
  78000.0000,   2.116144158148e+10,   1.410762772098e+11,   7.053813860492e+10, 
  78250.0000,   2.186870551277e+10,   1.457913700851e+11,   7.289568504255e+10, 
  78500.0000,   2.256289274334e+10,   1.504192849556e+11,   7.520964247778e+10, 
  78750.0000,   2.324129683643e+10,   1.549419789095e+11,   7.747098945476e+10, 
  79000.0000,   2.390120584233e+10,   1.593413722822e+11,   7.967068614111e+10, 
  79250.0000,   2.453992001216e+10,   1.635994667477e+11,   8.179973337385e+10, 
  79500.0000,   2.515476992855e+10,   1.676984661903e+11,   8.384923309516e+10, 
  79750.0000,   2.574313488613e+10,   1.716208992409e+11,   8.581044962044e+10, 
  80000.0000,   2.630246134694e+10,   1.753497423129e+11,   8.767487115647e+10, 
  80250.0000,   2.683028129079e+10,   1.788685419386e+11,   8.943427096931e+10, 
  80500.0000,   2.732423027734e+10,   1.821615351823e+11,   9.108076759113e+10, 
  80750.0000,   2.778206503575e+10,   1.852137669050e+11,   9.260688345249e+10, 
  81000.0000,   2.820168039953e+10,   1.880112026636e+11,   9.400560133178e+10, 
  81250.0000,   2.858112540808e+10,   1.905408360539e+11,   9.527041802693e+10, 
  81500.0000,   2.891861840276e+10,   1.927907893517e+11,   9.639539467585e+10, 
  81750.0000,   2.921256095439e+10,   1.947504063626e+11,   9.737520318132e+10, 
  82000.0000,   2.946155046981e+10,   1.964103364654e+11,   9.820516823270e+10, 
  82250.0000,   2.966439133834e+10,   1.977626089222e+11,   9.888130446112e+10, 
  82500.0000,   2.982010449445e+10,   1.988006966297e+11,   9.940034831485e+10, 
  82750.0000,   2.992793528945e+10,   1.995195685963e+11,   9.975978429817e+10, 
  83000.0000,   2.998735958363e+10,   1.999157305575e+11,   9.995786527875e+10, 
  83250.0000,   2.999808799017e+10,   1.999872532678e+11,   9.999362663391e+10, 
  83500.0000,   2.996006822270e+10,   1.997337881513e+11,   9.986689407565e+10, 
  83750.0000,   2.987348551968e+10,   1.991565701312e+11,   9.957828506561e+10, 
  84000.0000,   2.973876114113e+10,   1.982584076076e+11,   9.912920380378e+10, 
  84250.0000,   2.955654895441e+10,   1.970436596961e+11,   9.852182984803e+10, 
  84500.0000,   2.932773014802e+10,   1.955182009868e+11,   9.775910049340e+10, 
  84750.0000,   2.905340613316e+10,   1.936893742210e+11,   9.684468711052e+10, 
  85000.0000,   2.873488971295e+10,   1.915659314197e+11,   9.578296570984e+10, 
  85250.0000,   2.837369461858e+10,   1.891579641238e+11,   9.457898206192e+10, 
  85500.0000,   2.797152352882e+10,   1.864768235255e+11,   9.323841176274e+10, 
  85750.0000,   2.753025470581e+10,   1.835350313721e+11,   9.176751568604e+10, 
  86000.0000,   2.705192739358e+10,   1.803461826239e+11,   9.017309131194e+10, 
  86250.0000,   2.653872613820e+10,   1.769248409214e+11,   8.846242046068e+10, 
  86500.0000,   2.599296419793e+10,   1.732864279862e+11,   8.664321399312e+10, 
  86750.0000,   2.541706621938e+10,   1.694471081292e+11,   8.472355406460e+10, 
  87000.0000,   2.481355036064e+10,   1.654236690710e+11,   8.271183453548e+10, 
  87250.0000,   2.418501004514e+10,   1.612334003009e+11,   8.061670015045e+10, 
  87500.0000,   2.353409552995e+10,   1.568939701996e+11,   7.844698509982e+10, 
  87750.0000,   2.286349547051e+10,   1.524233031367e+11,   7.621165156837e+10, 
  88000.0000,   2.217591865893e+10,   1.478394577262e+11,   7.391972886310e+10, 
  88250.0000,   2.147407610669e+10,   1.431605073779e+11,   7.158025368897e+10, 
  88500.0000,   2.076066363400e+10,   1.384044242266e+11,   6.920221211332e+10, 
  88750.0000,   2.003834511744e+10,   1.335889674496e+11,   6.679448372481e+10, 
  89000.0000,   1.930973653580e+10,   1.287315769053e+11,   6.436578845266e+10, 
  89250.0000,   1.857739094013e+10,   1.238492729342e+11,   6.192463646709e+10, 
  89500.0000,   1.784378445998e+10,   1.189585630665e+11,   5.947928153327e+10, 
  89750.0000,   1.711130344176e+10,   1.140753562784e+11,   5.703767813919e+10, 
  90000.0000,   1.638223279919e+10,   1.092148853279e+11,   5.460744266397e+10, 
  90250.0000,   1.565874563937e+10,   1.043916375958e+11,   5.219581879791e+10, 
  90500.0000,   1.494289421086e+10,   9.961929473910e+10,   4.980964736955e+10, 
  90750.0000,   1.423660220395e+10,   9.491068135964e+10,   4.745534067982e+10, 
  91000.0000,   1.354165841658e+10,   9.027772277719e+10,   4.513886138860e+10, 
  91250.0000,   1.285971178402e+10,   8.573141189346e+10,   4.286570594673e+10, 
  91500.0000,   1.219226775489e+10,   8.128178503259e+10,   4.064089251630e+10, 
  91750.0000,   1.154068598248e+10,   7.693790654986e+10,   3.846895327493e+10, 
  92000.0000,   1.090617928700e+10,   7.270786191335e+10,   3.635393095667e+10, 
  92250.0000,   1.028981383273e+10,   6.859875888485e+10,   3.429937944242e+10, 
  92500.0000,   9.692510453446e+09,   6.461673635631e+10,   3.230836817815e+10, 
  92750.0000,   9.115047050630e+09,   6.076698033754e+10,   3.038349016877e+10, 
  93000.0000,   8.558061981023e+09,   5.705374654015e+10,   2.852687327008e+10, 
  93250.0000,   8.022058344244e+09,   5.348038896162e+10,   2.674019448081e+10, 
  93500.0000,   7.507409076336e+09,   5.004939384224e+10,   2.502469692112e+10, 
  93750.0000,   7.014362751975e+09,   4.676241834650e+10,   2.338120917325e+10, 
  94000.0000,   6.543049996264e+09,   4.362033330843e+10,   2.181016665421e+10, 
  94250.0000,   6.093490406631e+09,   4.062326937754e+10,   2.031163468877e+10, 
  94500.0000,   5.665599886184e+09,   3.777066590789e+10,   1.888533295395e+10, 
  94750.0000,   5.259198291897e+09,   3.506132194598e+10,   1.753066097299e+10, 
  95000.0000,   4.874017304137e+09,   3.249344869425e+10,   1.624672434712e+10, 
  95250.0000,   4.509708428069e+09,   3.006472285380e+10,   1.503236142690e+10, 
  95500.0000,   4.165851042410e+09,   2.777234028273e+10,   1.388617014137e+10, 
  95750.0000,   3.841960416572e+09,   2.561306944381e+10,   1.280653472191e+10, 
  96000.0000,   3.537495623455e+09,   2.358330415637e+10,   1.179165207818e+10, 
  96250.0000,   3.251867281744e+09,   2.167911521163e+10,   1.083955760581e+10, 
  96500.0000,   2.984445068523e+09,   1.989630045682e+10,   9.948150228409e+09, 
  96750.0000,   2.734564950186e+09,   1.823043300124e+10,   9.115216500619e+09, 
  97000.0000,   2.501536086824e+09,   1.667690724549e+10,   8.338453622747e+09, 
  97250.0000,   2.284647372488e+09,   1.523098248325e+10,   7.615491241625e+09, 
  97500.0000,   2.083173580799e+09,   1.388782387199e+10,   6.943911935995e+09, 
  97750.0000,   1.896381092259e+09,   1.264254061506e+10,   6.321270307529e+09, 
  98000.0000,   1.723533186168e+09,   1.149022124112e+10,   5.745110620559e+09, 
  98250.0000,   1.563894886290e+09,   1.042596590860e+10,   5.212982954300e+09, 
  98500.0000,   1.416737355211e+09,   9.444915701406e+09,   4.722457850703e+09, 
  98750.0000,   1.281341837672e+09,   8.542278917811e+09,   4.271139458905e+09, 
  99000.0000,   1.157003158032e+09,   7.713354386878e+09,   3.856677193439e+09, 
  99250.0000,   1.043032781347e+09,   6.953551875645e+09,   3.476775937823e+09, 
  99500.0000,   9.387614513750e+08,   6.258409675833e+09,   3.129204837917e+09, 
  99750.0000,   8.435414221076e+08,   5.623609480717e+09,   2.811804740359e+09, 
 100000.0000,   7.567483021931e+08,   5.044988681288e+09,   2.522494340644e+09, 
 100250.0000,   6.777825338720e+08,   4.518550225813e+09,   2.259275112907e+09, 
 100500.0000,   6.060705298080e+08,   4.040470198720e+09,   2.020235099360e+09, 
 100750.0000,   5.410654924967e+08,   3.607103283312e+09,   1.803551641656e+09, 
 101000.0000,   4.822479417920e+08,   3.214986278613e+09,   1.607493139307e+09, 
 101250.0000,   4.291259765488e+08,   2.860839843659e+09,   1.430419921829e+09, 
 101500.0000,   3.812352964694e+08,   2.541568643129e+09,   1.270784321565e+09, 
 101750.0000,   3.381390099992e+08,   2.254260066662e+09,   1.127130033331e+09, 
 102000.0000,   2.994272535882e+08,   1.996181690588e+09,   9.980908452942e+08, 
 102250.0000,   2.647166468498e+08,   1.764777645666e+09,   8.823888228328e+08, 
 102500.0000,   2.336496071546e+08,   1.557664047697e+09,   7.788320238485e+08, 
 102750.0000,   2.058935460238e+08,   1.372623640158e+09,   6.863118200792e+08, 
 103000.0000,   1.811399683782e+08,   1.207599789188e+09,   6.037998945941e+08, 
 103250.0000,   1.591034942806e+08,   1.060689961871e+09,   5.303449809354e+08, 
 103500.0000,   1.395208213215e+08,   9.301388088099e+08,   4.650694044050e+08, 
 103750.0000,   1.221496442639e+08,   8.143309617590e+08,   4.071654808795e+08, 
 104000.0000,   1.067675470100e+08,   7.117836467335e+08,   3.558918233667e+08, 
 104250.0000,   9.317088040674e+07,   6.211392027116e+08,   3.105696013558e+08, 
 104500.0000,   8.117363788410e+07,   5.411575858940e+08,   2.705787929470e+08, 
 104750.0000,   7.060633944578e+07,   4.707089296385e+08,   2.353544648193e+08, 
 105000.0000,   6.131493310879e+07,   4.087662207252e+08,   2.043831103626e+08, 
 105250.0000,   5.315972154157e+07,   3.543981436105e+08,   1.771990718052e+08, 
 105500.0000,   4.601432037973e+07,   3.067621358649e+08,   1.533810679324e+08, 
 105750.0000,   3.976465351545e+07,   2.650976901030e+08,   1.325488450515e+08, 
 106000.0000,   3.430798956526e+07,   2.287199304351e+08,   1.143599652175e+08, 
 106250.0000,   2.955202272329e+07,   1.970134848219e+08,   9.850674241095e+07, 
 106500.0000,   2.541400030478e+07,   1.694266686985e+08,   8.471333434926e+07, 
 106750.0000,   2.181989847729e+07,   1.454659898486e+08,   7.273299492431e+07, 
 107000.0000,   1.870364696161e+07,   1.246909797441e+08,   6.234548987204e+07, 
 107250.0000,   1.600640285927e+07,   1.067093523951e+08,   5.335467619757e+07, 
 107500.0000,   1.367587322366e+07,   9.117248815774e+07,   4.558624407887e+07, 
 107750.0000,   1.166568553273e+07,   7.777123688489e+07,   3.888561844245e+07, 
 108000.0000,   9.934804837986e+06,   6.623203225324e+07,   3.311601612662e+07, 
 108250.0000,   8.446996051049e+06,   5.631330700700e+07,   2.815665350350e+07, 
 108500.0000,   7.170329579851e+06,   4.780219719901e+07,   2.390109859950e+07, 
 108750.0000,   6.076728335077e+06,   4.051152223385e+07,   2.025576111692e+07, 
 109000.0000,   5.141553988462e+06,   3.427702658974e+07,   1.713851329487e+07, 
 109250.0000,   4.343230271490e+06,   2.895486847660e+07,   1.447743423830e+07, 
 109500.0000,   3.662901050597e+06,   2.441934033731e+07,   1.220967016866e+07, 
 109750.0000,   3.084120897578e+06,   2.056080598385e+07,   1.028040299193e+07, 
 110000.0000,   2.592575886476e+06,   1.728383924317e+07,   8.641919621586e+06, 
 110250.0000,   2.175832385884e+06,   1.450554923923e+07,   7.252774619614e+06, 
 110500.0000,   1.823111674055e+06,   1.215407782703e+07,   6.077038913515e+06, 
 110750.0000,   1.525088279286e+06,   1.016725519524e+07,   5.083627597620e+06, 
 111000.0000,   1.273710036212e+06,   8.491400241412e+06,   4.245700120706e+06, 
 111250.0000,   1.062037946512e+06,   7.080252976746e+06,   3.540126488373e+06, 
 111500.0000,   8.841040373630e+05,   5.894026915753e+06,   2.947013457877e+06, 
 111750.0000,   7.347855200870e+05,   4.898570133913e+06,   2.449285066957e+06, 
 112000.0000,   6.096936628015e+05,   4.064624418677e+06,   2.032312209338e+06, 
 112250.0000,   5.050759025516e+05,   3.367172683677e+06,   1.683586341839e+06, 
 112500.0000,   4.177298328718e+05,   2.784865552479e+06,   1.392432776239e+06, 
 112750.0000,   3.449278107262e+05,   2.299518738174e+06,   1.149759369087e+06, 
 113000.0000,   2.843510312676e+05,   1.895673541784e+06,   9.478367708919e+05, 
 113250.0000,   2.340320190693e+05,   1.560213460462e+06,   7.801067302311e+05, 
 113500.0000,   1.923045798036e+05,   1.282030532024e+06,   6.410152660120e+05, 
 113750.0000,   1.577603463616e+05,   1.051735642410e+06,   5.258678212052e+05, 
 114000.0000,   1.292111378555e+05,   8.614075857033e+05,   4.307037928517e+05, 
 114250.0000,   1.056564286779e+05,   7.043761911858e+05,   3.521880955929e+05, 
 114500.0000,   8.625529778400e+04,   5.750353185600e+05,   2.875176592800e+05, 
 114750.0000,   7.030229567398e+04,   4.686819711598e+05,   2.343409855799e+05, 
 115000.0000,   5.720672830804e+04,   3.813781887202e+05,   1.906890943601e+05, 
 115250.0000,   4.647491358773e+04,   3.098327572516e+05,   1.549163786258e+05, 
 115500.0000,   3.769501730771e+04,   2.513001153847e+05,   1.256500576924e+05, 
 115750.0000,   3.052412189523e+04,   2.034941459682e+05,   1.017470729841e+05, 
 116000.0000,   2.467722309654e+04,   1.645148206436e+05,   8.225741032179e+04, 
 116250.0000,   1.991788734126e+04,   1.327859156084e+05,   6.639295780420e+04, 
 116500.0000,   1.605033612724e+04,   1.070022408482e+05,   5.350112042412e+04, 
 116750.0000,   1.291275372544e+04,   8.608502483627e+04,   4.304251241814e+04, 
 117000.0000,   1.037164111066e+04,   6.914427407107e+04,   3.457213703553e+04, 
 117250.0000,   8.317062572437e+03,   5.544708381624e+04,   2.772354190812e+04, 
 117500.0000,   6.658652233657e+03,   4.439101489104e+04,   2.219550744552e+04, 
 117750.0000,   5.322265969056e+03,   3.548177312704e+04,   1.774088656352e+04, 
 118000.0000,   4.247180224459e+03,   2.831453482973e+04,   1.415726741486e+04, 
 118250.0000,   3.383753225129e+03,   2.255835483419e+04,   1.127917741710e+04, 
 118500.0000,   2.691476246186e+03,   1.794317497457e+04,   8.971587487286e+03, 
 118750.0000,   2.137353200615e+03,   1.424902133743e+04,   7.124510668716e+03, 
 119000.0000,   1.694555964716e+03,   1.129703976478e+04,   5.648519882388e+03, 
 119250.0000,   1.341310774380e+03,   8.942071829199e+03,   4.471035914600e+03, 
 119500.0000,   1.059977839805e+03,   7.066518932035e+03,   3.533259466018e+03, 
 119750.0000,   8.362921777254e+02,   5.575281184836e+03,   2.787640592418e+03, 
 120000.0000,   6.587386711889e+02,   4.391591141259e+03,   2.195795570630e+03, 
};


static double meso_heights [] = {     0.0,  2000.0,  4000.0,  6000.0,  8000.0, 10000.0, 12000.0, 14000.0, 16000.0, 18000.0,
	                       20000.0, 22000.0, 24000.0, 26000.0, 28000.0, 30000.0, 32000.0, 34000.0, 36000.0, 38000.0,
	                       40000.0, 41000.0, 42000.0, 43000.0, 44000.0, 45000.0, 46000.0, 47000.0, 48000.0, 49000.0,
	                       50000.0, 51000.0, 52000.0, 53000.0, 54000.0, 55000.0, 56000.0, 57000.0, 58000.0, 59000.0,
	                       60000.0, 61000.0, 62000.0, 63000.0, 64000.0, 65000.0, 66000.0, 67000.0, 68000.0, 69000.0,
						   70000.0, 70500.0, 71000.0, 71500.0, 72000.0, 72500.0, 73000.0, 73500.0, 74000.0, 74500.0,
						   75000.0, 75500.0, 76000.0, 76500.0, 77000.0, 77500.0, 78000.0, 78500.0, 79000.0, 79500.0,
						   80000.0, 80250.0, 80500.0, 80750.0, 81000.0, 81250.0, 81500.0, 81750.0, 82000.0, 82500.0,
						   82750.0, 83000.0, 83250.0, 83500.0, 83750.0, 84000.0, 84250.0, 84500.0, 84750.0, 85000.0,
						   85250.0, 85500.0, 85750.0, 86000.0, 86250.0, 86500.0, 86750.0, 87000.0, 87250.0, 87500.0,
						   87750.0, 88000.0, 88250.0, 88500.0, 88875.0, 89000.0, 89250.0, 89500.0, 89750.0,
					       90000.0, 90500.0, 91000.0, 91500.0, 92000.0, 92500.0, 93000.0, 93500.0, 94000.0, 94500.0,
						   95000.0, 95500.0, 96000.0, 96500.0, 97000.0, 97500.0, 98000.0, 98500.0, 99000.0, 99500.0,
						  100000.0,101000.0,102000.0,103000.0,104000.0,105000.0,106000.0,107000.0,108000.0,109000.0,
						  110000.0,111000.0,112000.0,113000.0,114000.0,115000.0,116000.0,117000.0,118000.0,119000.0,
						  120000.0,121000.0,122000.0,123000.0,124000.0,125000.0,126000.0,127000.0,128000.0,129000.0,
						  130000.0};


/*-----------------------------------------------------------------------------
 *					ConfigureMesosphericMode		 2015- 3- 10*/
/** **/
/*---------------------------------------------------------------------------*/

static bool ConfigureMesosphericMode( SKTRANSO_SpecificationsUser_Legacy* sospecs )
{
	std::vector<double>	shells;
	

	sospecs->RayTracingRegionManagerVar()->SetReferencePointTargetAltitude( 80000.0 );
	sospecs->RayTracingRegionManagerVar()->SetReferencePointTargetRange(20000.0);
	shells.assign( &meso_heights[0], &meso_heights[0] + N_ELEMENTS(meso_heights) );
	return sospecs->ConfigureUserDefinedShells( shells );
};

/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::SKTRAN_Emission_Test		2014-4-7*/
/** **/
/*---------------------------------------------------------------------------*/

SKTRAN_Emission_Test::SKTRAN_Emission_Test ()
{
	m_dolimb = true;
	ConfigureMesosphericMode( &m_sospecs);
}


/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::~SKTRAN_Emission_Test		2014-4-9*/
/** **/
/*---------------------------------------------------------------------------*/

SKTRAN_Emission_Test::~SKTRAN_Emission_Test()
{
}


/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::MakeGroundBasedLinesOfSight		2014-4-7*/
/** **/
/*---------------------------------------------------------------------------*/

bool SKTRAN_Emission_Test::MakeGroundBasedLinesOfSight()
{
	double			lat			= 48.4667;
	double			lng			= 81.3333;
	double			height		= 2000.0;
	double			solarazi    = 180;				// Sun is in the South 
	double			solarzen    = 60.0;				//     at 60 degrees zenitha angle
	double			obsazi      = 90.0;				// Observer is look East
	double			obszen;
	double			mjd			= 54832.0;
	double			azi;
	nxGeodetic		geoid;
	nxVector		observer;
	nxVector		look;
	nxVector		west, south, up;
	double			Re;

	geoid.FromGeodetic( lat,lng,height );
	observer = geoid.Location();
	Re       = observer.Magnitude() - height;
	geoid.GetGeodeticWestSouthUp( &west, &south, &up );
	azi = 270.0-solarazi;										// Convert compass azimuth to west, south, up coordinate system
	m_sun =  (nxmath::sind(solarzen)*nxmath::cosd(azi))*west  + (nxmath::sind(solarzen)*nxmath::sind(azi))*south + nxmath::cosd(solarzen)*up;

	azi = 270.0 - obsazi;
	for(int i = 0; i <= 30; i++ )
	{
		obszen = 3*i;
		look   =  (nxmath::sind(obszen)*nxmath::cosd(azi))*west  + (nxmath::sind(obszen)*nxmath::sind(azi))*south + nxmath::cosd(obszen)*up;
		m_linesofsight.AddLineOfSight( observer, look, mjd );
	}
	return true;
}



/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::MakeLimbBasedLinesOfSight		2014-4-7*/
/** **/
/*---------------------------------------------------------------------------*/

bool SKTRAN_Emission_Test::MakeLimbBasedLinesOfSight()
{
	bool 	ok;
	double	mjd 	= 56829.9479166666;
	double  lat 	= 66.5;
	double	lng 	= 23.00;
	double	sza     = 80.0;
	double	saa     = 0.0;
	double  rayazi 	= 180.0;
	const int numHeights = 710;

	double deltaHeight  = 100.0;
	double lowestHeight = 30000.0;

	m_tanheights_meters.resize(numHeights);
	// make the lines of sight
	for (int i=0; i < numHeights; i++)
	{
		m_tanheights_meters[i] = i*deltaHeight + lowestHeight;	
	}
	ok = m_linesofsight.SetRaysFromTangentHeightArray( mjd, lat, lng, sza, saa, rayazi, &m_tanheights_meters.front(), numHeights, 600000.0, &m_sun );
	return ok;
}

/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::MakeWavelengths		2014-4-7*/
/** **/
/*---------------------------------------------------------------------------*/

bool SKTRAN_Emission_Test::MakeWavelengths()
{
	m_wavelen.clear();
	/*
	wavelen.push_back( 280 );
	wavelen.push_back( 300 );
	wavelen.push_back( 320 );
	wavelen.push_back( 340 );
	wavelen.push_back( 360 );
	wavelen.push_back( 380 );
	wavelen.push_back( 400 );
	wavelen.push_back( 450 );
	wavelen.push_back( 500 );
	wavelen.push_back( 550 );
	wavelen.push_back( 600 );
	wavelen.push_back( 650 );
	wavelen.push_back( 700 );
	wavelen.push_back( 750 );
	wavelen.push_back( 800 );
	*/
	m_wavelen.push_back( 761 );
	m_wavelen.push_back( 762 );
	m_wavelen.push_back( 762.5);

	return true;
}




/*-----------------------------------------------------------------------------
 *					ConfigureEmissionLayer		 2015- 3- 10*/
/** **/
/*---------------------------------------------------------------------------*/

static bool ConfigureEmissionLayer( skEmission_Tabulated_HeightWavelength* emissionlayer)
{
	double				w[3] = {760, 762, 763};
	nx2dArray<double>	layers;
	nx2dArray<double>	emission;
	nx1dArray<double>	h;
	nx1dArray<double>	wavelen;
	size_t				numrows = N_ELEMENTS(g_emissionlayertable)/4;
	bool				ok;

	wavelen.Attach( 3, w);
	layers.Attach(4, numrows, g_emissionlayertable);
	layers.YSlice(0, &h);
	emission = layers.Slice( 1,3, 0, numrows-1);
	emission *= 3.0E-7; 
	ok = emissionlayer->SetEmissionTable( emission, wavelen, h );
	return ok;
}

/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::MakeOpticalState		2014-4-7*/
/** **/
/*---------------------------------------------------------------------------*/

bool SKTRAN_Emission_Test::MakeOpticalState( SKTRAN_AtmosphericOpticalState_V21& opticalstate)
{
	skOpticalProperties_RayleighDryAir*		rayleigh;					// Optical properties of one air molecule
	skClimatology_MSIS90*					msis90;	
	skClimatology_LabowOzoneVMR*			o3numberdensity;
	skOpticalProperties_O3_OSIRISRes*		o3_opticalprops;			// optical properties of one O3 molecule
	skEmission_Tabulated_HeightWavelength*	emissionlayer;	
	bool									ok = true;

	opticalstate.erase();
	rayleigh         = new skOpticalProperties_RayleighDryAir;
	msis90           = new skClimatology_MSIS90;
	o3numberdensity  = new skClimatology_LabowOzoneVMR;
	o3_opticalprops  = new skOpticalProperties_O3_OSIRISRes;
	emissionlayer     = new skEmission_Tabulated_HeightWavelength;

	ok =       (rayleigh != NULL) && (msis90 != NULL) && (o3_opticalprops != NULL) && (o3numberdensity != NULL);
	ok = ok && ConfigureEmissionLayer( emissionlayer );
	ok = ok && opticalstate.AddSpecies( SKCLIMATOLOGY_AIRNUMBERDENSITY_CM3, msis90,      rayleigh );
	ok = ok && opticalstate.AddSpecies( SKCLIMATOLOGY_O3_CM3, o3numberdensity,           o3_opticalprops);
	ok = ok && opticalstate.SetAlbedo( 1.0 );
	ok = ok && opticalstate.AddEmission( SKEMISSION_PHOTOCHEMICAL_0, emissionlayer );	

	if (!ok)
	{
		nxLog::Record(NXLOG_WARNING,"MakeSpeciesList, there was an error making the species list");
	}
	return ok;
}

/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::Initialize		2014-4-7*/
/** **/
/*---------------------------------------------------------------------------*/

bool SKTRAN_Emission_Test::Initialize()
{
	bool ok = true;

	ok = ok && MakeOpticalState( m_opticalstateso);
	if (m_dolimb)
	{
		ok = ok && MakeLimbBasedLinesOfSight();
	}
	else
	{
		ok = ok && MakeGroundBasedLinesOfSight();
	}

	ok = ok && MakeWavelengths();

	return ok;
}


/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::RunTests		 2015- 3- 10*/
/** **/
/*---------------------------------------------------------------------------*/

bool SKTRAN_Emission_Test::RunTests()
{
	bool		ok;

	m_dolimb = true;;					// if true then do the limb tests
//	m_doSO   = true;						// IF true then do SO testing;
	ok =		Initialize( );
	ok = ok &&	RunStandardTest();

	return ok;
}


/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::RunStandardTest		 2015- 3- 10*/
/** **/
/*---------------------------------------------------------------------------*/

bool SKTRAN_Emission_Test::RunStandardTest()
{
	bool					ok = true;
	nx2dArray<double>		sk_radiance;
	FILE*					f;


	printf("---- Starting Mesospheric Limb Viewing, Single Scatter + Emission Test ----\n");
	SO_Scatter( sk_radiance, 1 );

	f = fopen("mesosphericlimbdata.txt", "wt");
	for( size_t altidx = 0; altidx < m_linesofsight.NumRays(); altidx++ )
	{
		printf (  " %12.3f", (double)m_tanheights_meters.at(altidx));
		fprintf(f," %12.3f", (double)m_tanheights_meters.at(altidx));
		for( size_t waveidx = 0; waveidx < m_wavelen.size(); waveidx++ )
		{
			printf (  " %25.15e", sk_radiance.At(altidx, waveidx) );
			fprintf(f," %25.15e", sk_radiance.At(altidx, waveidx) );
		}
		printf("\n");
		fprintf(f, "\n");

	}
	fclose(f);
	return ok;
}

/*-----------------------------------------------------------------------------
 *					SKTRAN_Emission_Test::SO_Scatter		2014-4-7*/
/** **/
/*---------------------------------------------------------------------------*/

bool SKTRAN_Emission_Test::SO_Scatter( nx2dArray<double>& radiance, size_t scattorder)
{
	bool								ok = true;
	bool								ok1;
	SKTRANSO_Engine						sk_engine;
	std::vector<SKTRAN_StokesScalar>    sk_radiance_temp;
	//skEmission_Constant*				constant;													

	//constant = new skEmission_Constant(1.0E-06);
	//constant->AddRef();
	//m_opticalstateso.AddEmission( SKCLIMATOLOGY_ALBEDO, constant );	

	ok = radiance.SetSize( m_linesofsight.NumRays(), m_wavelen.size() );
	sk_radiance_temp.resize( m_linesofsight.NumRays() );
	ok =       m_sospecs.RayTracingRegionManagerVar()->SetSun( m_sun );
//		nxLog::Record(NXLOG_INFO, "SO engine, manually setting the reference point");
//		ok = ok && specs.RayTracingRegionManagerVar()->SetReferencePoint( refpt_lat, refpt_lng, 13000.00531, refpt_mjd);
	ok = ok && sk_engine.ConfigureModel( m_sospecs, m_linesofsight, 0 );
	if (ok)
	{
		for( size_t i = 0; i < m_wavelen.size(); i++ )
		{
			ok1 = sk_engine.CalculateRadiance(&sk_radiance_temp, m_wavelen[i], scattorder, &m_opticalstateso );
			ok = ok && ok1;
			if (ok1)
			{
				for(size_t j = 0; j < sk_radiance_temp.size(); j++ )
				{
					radiance.At(j,i) = sk_radiance_temp[j];
				}
			}
		}
	}
	if (!ok)
	{
		nxLog::Record(NXLOG_WARNING, "SKTRAN_Emission_Test::SK_Scatter, There were errors executing the SO model. This should be investigated in more detail.");
	}
//	constant->Release();

	return ok;
}


/*-----------------------------------------------------------------------------
 *					Run_SKTRAN_Emission_Test		 2015- 3- 10*/
/** **/
/*---------------------------------------------------------------------------*/

void Run_SKTRAN_Emission_Test()
{
	SKTRAN_Emission_Test	test;

	test.RunTests();
}



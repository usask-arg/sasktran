<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Collecting diagnostic data during radiative transfer calculation with HR &mdash; SASKTRAN 0+untagged.1.g2fb30b9 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/nbsphinx-code-cells.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/_static/theme_overrides.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/sasktran-favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Calculating optical depths along lines of sight in HR" href="cell_opticaldepths.html" />
    <link rel="prev" title="Single Scatter in HR" href="single_scatter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/sasktran-light.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0+untagged.1.g2fb30b9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Installing SASKTRAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../constructing_atmosphere.html">Specifying the Atmosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../constructing_geometry.html">Constructing the Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other_engines.html">Choosing an Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_aerosol.html">Specifying Aerosol</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../climatology_examples.html">Climatology Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../brdf_examples.html">BRDF Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../opticalproperty_examples.html">Optical Property Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geometry_examples.html">Geometry Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../hr_examples.html">SASKTRAN-HR Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="basic_radtran.html">Basic Radiative Transfer Calculation with HR</a></li>
<li class="toctree-l3"><a class="reference internal" href="polarized_calculation.html">Polarized Radiative Transfer Calculation with HR</a></li>
<li class="toctree-l3"><a class="reference internal" href="onedim_wf.html">Calculating Weighting Functions with HR</a></li>
<li class="toctree-l3"><a class="reference internal" href="single_scatter.html">Single Scatter in HR</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Collecting diagnostic data during radiative transfer calculation with HR</a></li>
<li class="toctree-l3"><a class="reference internal" href="cell_opticaldepths.html">Calculating optical depths along lines of sight in HR</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_cloud.html">Using the Baum Ice Crystal Database with HR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mc_examples.html">SASKTRAN-MC Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir_examples.html">SASKTRAN-TIR Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../do_examples.html">SASKTRAN-DO Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../experimental.html">Experimental Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sasktran_hr.html">SASKTRAN-HR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tir/index.html">SASKTRAN Thermal InfraRed Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../do/index.html">SASKTRAN-DO</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SASKTRAN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../examples.html">Examples</a></li>
          <li class="breadcrumb-item"><a href="../hr_examples.html">SASKTRAN-HR Examples</a></li>
      <li class="breadcrumb-item active">Collecting diagnostic data during radiative transfer calculation with HR</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/hr/diagnostic.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Collecting-diagnostic-data-during-radiative-transfer-calculation-with-HR">
<h1>Collecting diagnostic data during radiative transfer calculation with HR<a class="headerlink" href="#Collecting-diagnostic-data-during-radiative-transfer-calculation-with-HR" title="Permalink to this heading">¶</a></h1>
<p>In this example we collect diagnostic data, namely in- and out-radiance at specified diffuse profiles and orders of scattering, and store it to an hdf5 file. To enable data collection, at least one of the following two HR engine options should be set:</p>
<ul class="simple">
<li><p>diagnosticscatterorders - the list of orders of scattering,</p></li>
<li><p>diagnosticdiffuseprofiles - the list of diffuse profiles.</p></li>
</ul>
<p>If only one option is set manually, the second will be set to default value. Deafults are [1] for the scattering orders and [0] for the diffuse profiles.</p>
<p>The data is stored to DiagnosticData.h5 file in the working directory. If the file already exists, it is overwritten.</p>
<p>To stop collecting diagnostic data without re-initializing the engine, one should set both parameters to zero-length arrays: engine.options[‘optname’] = [].</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="kn">from</span> <span class="nn">sasktran.geometry</span> <span class="kn">import</span> <span class="n">VerticalImage</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">h5py</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create geometry</span>
<span class="n">tanalts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">]</span>
<span class="n">geometry</span> <span class="o">=</span> <span class="n">VerticalImage</span><span class="p">()</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">from_sza_saa</span><span class="p">(</span><span class="n">sza</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">saa</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tanalts_km</span><span class="o">=</span><span class="n">tanalts</span><span class="p">,</span> <span class="n">mjd</span><span class="o">=</span><span class="mi">54372</span><span class="p">,</span>
                      <span class="n">locallook</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">satalt_km</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">refalt_km</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Create an atmosphere with aerosol absorption and Rayleigh scattering</span>
<span class="n">atmosphere</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Atmosphere</span><span class="p">()</span>
<span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">optical_property</span><span class="o">=</span><span class="n">sk</span><span class="o">.</span><span class="n">Rayleigh</span><span class="p">(),</span> <span class="n">climatology</span><span class="o">=</span><span class="n">sk</span><span class="o">.</span><span class="n">MSIS90</span><span class="p">())</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">EngineHR</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">atmosphere</span><span class="o">=</span><span class="n">atmosphere</span><span class="p">)</span>
<span class="n">wlens</span> <span class="o">=</span> <span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">400</span><span class="p">]</span>
<span class="n">engine</span><span class="o">.</span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">wlens</span>

<span class="c1"># To collect diagnostic data,</span>
<span class="c1"># specify scattering orders</span>
<span class="n">myorders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">engine</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;diagnosticscatterorders&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myorders</span>

<span class="c1"># Use more than one diffuse profile</span>
<span class="n">engine</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;numdiffuseprofilesinplane&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">myprofiles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">engine</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;diagnosticdiffuseprofiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myprofiles</span>

<span class="c1"># Execute</span>
<span class="n">rad</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_radiance</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>One can have a look at the list of data that was collected:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h5f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;DiagnosticData.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The following diagnostic data was stored:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">h5f</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">dsinf</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">h5f</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dsinf</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="n">dsinf</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">h5f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The following diagnostic data was stored:
&#34;heights&#34;: shape (102,)
&#34;in_wlen_350.00_ord_1_ground&#34;: shape (3, 133)
&#34;in_wlen_350.00_ord_1_prof_0&#34;: shape (102, 290, 4)
&#34;in_wlen_350.00_ord_1_prof_1&#34;: shape (102, 290, 4)
&#34;in_wlen_350.00_ord_1_prof_2&#34;: shape (102, 290, 4)
&#34;in_wlen_350.00_ord_2_ground&#34;: shape (3, 133)
&#34;in_wlen_350.00_ord_2_prof_0&#34;: shape (102, 290, 4)
&#34;in_wlen_350.00_ord_2_prof_1&#34;: shape (102, 290, 4)
&#34;in_wlen_350.00_ord_2_prof_2&#34;: shape (102, 290, 4)
&#34;in_wlen_350.00_ord_3_ground&#34;: shape (3, 133)
&#34;in_wlen_350.00_ord_3_prof_0&#34;: shape (102, 290, 4)
&#34;in_wlen_350.00_ord_3_prof_1&#34;: shape (102, 290, 4)
&#34;in_wlen_350.00_ord_3_prof_2&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_1_ground&#34;: shape (3, 133)
&#34;in_wlen_400.00_ord_1_prof_0&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_1_prof_1&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_1_prof_2&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_2_ground&#34;: shape (3, 133)
&#34;in_wlen_400.00_ord_2_prof_0&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_2_prof_1&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_2_prof_2&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_3_ground&#34;: shape (3, 133)
&#34;in_wlen_400.00_ord_3_prof_0&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_3_prof_1&#34;: shape (102, 290, 4)
&#34;in_wlen_400.00_ord_3_prof_2&#34;: shape (102, 290, 4)
&#34;out_wlen_350.00_ord_1_ground&#34;: shape (3,)
&#34;out_wlen_350.00_ord_1_prof_0&#34;: shape (102, 169, 4)
&#34;out_wlen_350.00_ord_1_prof_1&#34;: shape (102, 169, 4)
&#34;out_wlen_350.00_ord_1_prof_2&#34;: shape (102, 169, 4)
&#34;out_wlen_350.00_ord_2_ground&#34;: shape (3,)
&#34;out_wlen_350.00_ord_2_prof_0&#34;: shape (102, 169, 4)
&#34;out_wlen_350.00_ord_2_prof_1&#34;: shape (102, 169, 4)
&#34;out_wlen_350.00_ord_2_prof_2&#34;: shape (102, 169, 4)
&#34;out_wlen_350.00_ord_3_ground&#34;: shape (3,)
&#34;out_wlen_350.00_ord_3_prof_0&#34;: shape (102, 169, 4)
&#34;out_wlen_350.00_ord_3_prof_1&#34;: shape (102, 169, 4)
&#34;out_wlen_350.00_ord_3_prof_2&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_1_ground&#34;: shape (3,)
&#34;out_wlen_400.00_ord_1_prof_0&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_1_prof_1&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_1_prof_2&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_2_ground&#34;: shape (3,)
&#34;out_wlen_400.00_ord_2_prof_0&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_2_prof_1&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_2_prof_2&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_3_ground&#34;: shape (3,)
&#34;out_wlen_400.00_ord_3_prof_0&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_3_prof_1&#34;: shape (102, 169, 4)
&#34;out_wlen_400.00_ord_3_prof_2&#34;: shape (102, 169, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Keep the first file under different name</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">def</span> <span class="nf">convert_bytes</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;KB&#39;</span><span class="p">,</span> <span class="s1">&#39;MB&#39;</span><span class="p">,</span> <span class="s1">&#39;GB&#39;</span><span class="p">,</span> <span class="s1">&#39;TB&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mf">1024.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%3.1f</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">/=</span> <span class="mf">1024.0</span>
<span class="k">def</span> <span class="nf">file_size</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="n">file_info</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">convert_bytes</span><span class="p">(</span><span class="n">file_info</span><span class="o">.</span><span class="n">st_size</span><span class="p">)</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;DiagnosticData.h5&#39;</span>
<span class="c1"># print the file size</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39; :&#39;</span><span class="p">,</span> <span class="n">file_size</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DiagnosticData.h5  : 25.9 MB
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To dismiss collecting diagnostic data:</span>
<span class="n">engine</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;diagnosticscatterorders&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">engine</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;diagnosticdiffuseprofiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Execute</span>
<span class="n">rad</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_radiance</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WARNING :ISKEngine HR, The diagnosticscatterorders property has 0 length; Diagnostics will most likely be disabled
WARNING :ISKEngine HR, The diagnosticdiffuseprofiles property has 0 length; Diagnostics will most likely be disabled
</pre></div></div>
</div>
<p>Note: for polarized light scattering, the shape of incoming radiance data is (nheights, npoints, 10), and row structure is [x, y, z, rad, true_x, true_y, true_z, stokes_x, stokes_y, stokes_z]</p>
<p>Following are two useful plotting functions to visualize the collected data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotOnSphere</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">wlen</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">profile</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4500</span><span class="p">,</span>
                 <span class="n">mycolormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Poly3DCollection</span>
    <span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">ConvexHull</span>
    <span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>

    <span class="n">h5f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">h5f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;heights&#39;</span><span class="p">)</span> <span class="p">)</span>
    <span class="c1"># get 3d rad data</span>
    <span class="c1"># non-polarized: [heights][points][x y z rad]</span>
    <span class="c1"># polarized: [heights][points][x y z rad tru_x tru_y tru_z stokes_x stokes_y stokes_z]</span>
    <span class="n">rads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">h5f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span> <span class="o">+</span> <span class="s1">&#39;_wlen_&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">wlen</span> + &#39;_ord_&#39; + str(order) +
                             <span class="s1">&#39;_prof_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">profile</span><span class="p">))</span> <span class="p">)</span>
    <span class="n">h5f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">hidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">heights</span><span class="o">-</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">rads</span><span class="p">[</span><span class="n">hidx</span><span class="p">]</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">rad</span><span class="p">[:,</span><span class="mi">3</span><span class="p">])]</span>
    <span class="n">xyz</span><span class="p">,</span> <span class="n">rvals</span> <span class="o">=</span> <span class="n">rad</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">rad</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">hull</span><span class="o">.</span><span class="n">simplices</span>
    <span class="n">verts</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">idxs</span><span class="p">]</span>
    <span class="n">facevals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">rvals</span><span class="p">[</span><span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mynorm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">facevals</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">facevals</span><span class="p">))</span>
    <span class="n">facecols</span> <span class="o">=</span> <span class="n">mycolormap</span><span class="p">(</span><span class="n">mynorm</span><span class="p">(</span><span class="n">facevals</span><span class="p">))</span>

    <span class="n">coll</span> <span class="o">=</span> <span class="n">Poly3DCollection</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">facecols</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">mycolormap</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_array</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">facevals</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">facevals</span><span class="p">)])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">facevals</span><span class="p">),</span>
                                                             <span class="nb">max</span><span class="p">(</span><span class="n">facevals</span><span class="p">),</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">type</span><span class="o">+</span><span class="s1">&#39; radiance, wavelength = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">wlen</span> +
              <span class="s1">&#39;; profile = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;; order of scatter = &#39;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;; height = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">height</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot2DHeightProf</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">wlen</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">profile</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span> <span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                     <span class="n">theta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">np2int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">):</span>
    <span class="c1"># where np2int is a number of points to interpolate</span>
    <span class="c1"># and the target point can be specified either as [x y z] or as {theta, phi}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">theta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">phi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="n">h5f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">h5f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;heights&#39;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">h5f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">mylegend</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">:</span>
        <span class="n">rads</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">h5f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="c1"># get 3d rad data</span>
        <span class="c1"># n/pol.: [heights][points][x y z rad]</span>
        <span class="c1"># pol.: [heights][points][x y z rad tru_x tru_y tru_z stokes_x stokes_y stokes_z]</span>
        <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">h5f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span> <span class="o">+</span> <span class="s1">&#39;_wlen_&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">wlen</span> + &#39;_ord_&#39; +
                                <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_prof_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">profile</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">h5f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">hidx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rad</span><span class="p">)):</span>
            <span class="n">mynum</span><span class="p">,</span> <span class="n">myden</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="n">mags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rad</span><span class="p">[</span><span class="n">hidx</span><span class="p">,:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">mags</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">mags</span><span class="p">)]</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">np2int</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">):</span>
                <span class="c1">#if perfect match found, ignore np2int</span>
                <span class="n">rads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rad</span><span class="p">[</span><span class="n">hidx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">mags</span><span class="p">),</span> <span class="mi">3</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># use modified Shepard interp. for limited num. points</span>
                <span class="n">my_radius</span> <span class="o">=</span> <span class="n">mags</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">mags</span><span class="p">)[</span><span class="n">np2int</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">npt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np2int</span><span class="p">):</span>
                    <span class="n">coef</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span> <span class="nb">max</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">my_radius</span><span class="o">-</span><span class="n">mags</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">mags</span><span class="p">)[</span><span class="n">npt</span><span class="p">]])</span> <span class="o">/</span>
                    <span class="p">(</span> <span class="n">mags</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">mags</span><span class="p">)[</span><span class="n">npt</span><span class="p">]]</span> <span class="o">*</span> <span class="n">my_radius</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">mynum</span> <span class="o">+=</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">rad</span><span class="p">[</span><span class="n">hidx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">mags</span><span class="p">)[</span><span class="n">npt</span><span class="p">],</span> <span class="mi">3</span><span class="p">]</span>
                    <span class="n">myden</span> <span class="o">+=</span> <span class="n">coef</span>
                <span class="n">rads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">mynum</span> <span class="o">/</span> <span class="n">myden</span> <span class="p">)</span>
        <span class="n">mylegend</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;scat.ord. &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rads</span><span class="p">,</span> <span class="n">heights</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">mylegend</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;height (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="nb">type</span> <span class="o">+</span> <span class="s1">&#39;. rad.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np2int</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">subtitle</span> <span class="o">=</span> <span class="s1">&#39;Nearest-neighbor interpolation&#39;</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">subtitle</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np2int</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-pt interpolation&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">type</span> <span class="o">+</span> <span class="s1">&#39;. rad. at the point &#39;</span> <span class="o">+</span>
              <span class="s2">&quot;[</span><span class="si">%s</span><span class="s2">]&quot;</span><span class="o">%</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">point</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">)))</span> <span class="o">+</span>
              <span class="s1">&#39;; &#39;</span> <span class="o">+</span> <span class="n">subtitle</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;DiagnosticData.h5&#39;</span>

<span class="c1"># - plot on unisphere, one plot per one order, profile, height</span>
<span class="n">plotOnSphere</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10500</span><span class="p">,</span> <span class="n">mycolormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">)</span>
<span class="n">plotOnSphere</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10500</span><span class="p">,</span> <span class="n">mycolormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">)</span>
<span class="c1"># - plot on unisphere, one plot per one order, profile, height</span>
<span class="n">plotOnSphere</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plotOnSphere</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_3227/2621053390.py:9: DeprecationWarning: `product` is deprecated as of NumPy 1.25.0, and will be removed in NumPy 2.0. Please use `prod` instead.
  heights = np.array( h5f.get(&#39;heights&#39;) )
/tmp/ipykernel_3227/2621053390.py:13: DeprecationWarning: `product` is deprecated as of NumPy 1.25.0, and will be removed in NumPy 2.0. Please use `prod` instead.
  rads = np.array( h5f.get(type + &#39;_wlen_&#39; + &#39;%.2f&#39;%wlen + &#39;_ord_&#39; + str(order) +
/tmp/ipykernel_3227/2621053390.py:39: MatplotlibDeprecationWarning: Unable to determine Axes to steal space for Colorbar. Using gca(), but will raise in the future. Either provide the *cax* argument to use as the Axes for the Colorbar, provide the *ax* argument to steal space from it, or add *mappable* to an Axes.
  fig.colorbar(m, shrink=0.5, aspect=15, ticks=np.linspace(min(facevals),
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_hr_diagnostic_10_1.png" src="../../_images/examples_hr_diagnostic_10_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_hr_diagnostic_10_2.png" src="../../_images/examples_hr_diagnostic_10_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_hr_diagnostic_10_3.png" src="../../_images/examples_hr_diagnostic_10_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_hr_diagnostic_10_4.png" src="../../_images/examples_hr_diagnostic_10_4.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;DiagnosticData.h5&#39;</span>
<span class="c1"># - or plot a height profile for particular diffuse point</span>
<span class="n">plot2DHeightProf</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">myorders</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.85</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">plot2DHeightProf</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">myorders</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">np2int</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot2DHeightProf</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">91</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">np2int</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_3227/2621053390.py:60: DeprecationWarning: `product` is deprecated as of NumPy 1.25.0, and will be removed in NumPy 2.0. Please use `prod` instead.
  heights = np.array( h5f.get(&#39;heights&#39;) )
/tmp/ipykernel_3227/2621053390.py:70: DeprecationWarning: `product` is deprecated as of NumPy 1.25.0, and will be removed in NumPy 2.0. Please use `prod` instead.
  rad = np.array( h5f.get(type + &#39;_wlen_&#39; + &#39;%.2f&#39;%wlen + &#39;_ord_&#39; +
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_hr_diagnostic_11_1.png" src="../../_images/examples_hr_diagnostic_11_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_hr_diagnostic_11_2.png" src="../../_images/examples_hr_diagnostic_11_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_hr_diagnostic_11_3.png" src="../../_images/examples_hr_diagnostic_11_3.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="single_scatter.html" class="btn btn-neutral float-left" title="Single Scatter in HR" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cell_opticaldepths.html" class="btn btn-neutral float-right" title="Calculating optical depths along lines of sight in HR" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, ARG University of Saskatchewan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
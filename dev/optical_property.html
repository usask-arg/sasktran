<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Optical Properties &mdash; SASKTRAN 1.8.1+2.g0944a46 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/_static/theme_overrides.css" type="text/css" />
    <link rel="shortcut icon" href="_static/sasktran-favicon.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=cfaf87bc"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Emission" href="emission.html" />
    <link rel="prev" title="Lines of Sight" href="lines_of_sight.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/sasktran-light.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.8.1+2.g0944a46
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing SASKTRAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructing_atmosphere.html">Specifying the Atmosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructing_geometry.html">Constructing the Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_engines.html">Choosing an Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_aerosol.html">Specifying Aerosol</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="api_reference.html#complete-api-reference-pages">Complete API Reference Pages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="atmosphere.html">Atmosphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="brdf.html">BRDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="climatology.html">Climatology</a></li>
<li class="toctree-l3"><a class="reference internal" href="engine.html">Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="geodetic.html">Geodetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="lines_of_sight.html">Lines of Sight</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Optical Properties</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#base-classes">Base Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#useful-shorthands">Useful Shorthands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="emission.html">Emission</a></li>
<li class="toctree-l3"><a class="reference internal" href="solar_spectrum.html">Solar Spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="species.html">Species</a></li>
<li class="toctree-l3"><a class="reference internal" href="stokes_vector.html">Stokes Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="weighting_functions.html">Weighting Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#additional-topics">Additional Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="experimental.html">Experimental Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sasktran_hr.html">SASKTRAN-HR</a></li>
<li class="toctree-l1"><a class="reference internal" href="tir/index.html">SASKTRAN Thermal InfraRed Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="do/index.html">SASKTRAN-DO</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SASKTRAN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api_reference.html">API Reference</a></li>
      <li class="breadcrumb-item active">Optical Properties</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/optical_property.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="optical-properties">
<span id="optical-property"></span><h1>Optical Properties<a class="headerlink" href="#optical-properties" title="Link to this heading">¶</a></h1>
<p>Module: <code class="docutils literal notranslate"><span class="pre">sasktran.opticalproperty</span></code></p>
<p>Classes that describe the optical properties of some atmospheric <a class="reference internal" href="species.html#species"><span class="std std-ref">Species</span></a>. These objects are used to
create <a class="reference internal" href="species.html#species"><span class="std std-ref">Species</span></a> objects.</p>
<p>See our <a class="reference internal" href="#useful-shorthands">Useful Shorthands</a> for optical properties that we use a lot.</p>
<section id="base-classes">
<h2>Base Classes<a class="headerlink" href="#base-classes" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sasktran.OpticalProperty">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">OpticalProperty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.OpticalProperty" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generic optical property container that is applicable to a wide variety of optical properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – Name of the optical property to create</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sasktran</span> <span class="kn">import</span> <span class="n">OpticalProperty</span><span class="p">,</span> <span class="n">Climatology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt_prop</span> <span class="o">=</span> <span class="n">OpticalProperty</span><span class="p">(</span><span class="s1">&#39;O3_OSIRISRES&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">opt_prop</span><span class="p">)</span>
<span class="go">SasktranIF Optical Property: O3_OSIRISRES</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmospheric_state</span> <span class="o">=</span> <span class="n">Climatology</span><span class="p">(</span><span class="s1">&#39;msis90&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt_prop</span><span class="o">.</span><span class="n">calculate_cross_sections</span><span class="p">(</span><span class="n">atmospheric_state</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">mjd</span><span class="o">=</span><span class="mi">54372</span><span class="p">,</span>                                          <span class="n">wavelengths</span><span class="o">=</span><span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">600</span><span class="p">])</span>
<span class="go">CrossSections(wavelengths=array([350, 600]), absorption=array([  7.09857544e-23,   5.27719024e-21]), scattering=array([ 0.,  0.]), total=array([  7.09857544e-23,   5.27719024e-21]))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sasktran.OpticalProperty.calculate_cross_sections">
<span class="sig-name descname"><span class="pre">calculate_cross_sections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmospheric_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="climatology.html#sasktran.Climatology" title="sasktran.climatology.Climatology"><span class="pre">Climatology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.OpticalProperty.calculate_cross_sections" title="Link to this definition">¶</a></dt>
<dd><p>Calculates absorption and scattering cross sections for the given optical property with a specific atmospheric
state and location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmospheric_state</strong> (<a class="reference internal" href="climatology.html#sasktran.Climatology" title="sasktran.Climatology"><em>sasktran.Climatology</em></a>) – Atmospheric state (sometime called background climatology, corresponds to
<a class="reference internal" href="atmosphere.html#sasktran.Atmosphere.atmospheric_state" title="sasktran.Atmosphere.atmospheric_state"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasktran.Atmosphere.atmospheric_state</span></code></a>). Typically the background climatology must
support temperature and pressure, e.g. msis90.  Some optical properties may not need a background
climatology, for example Mie aerosols, however one must still be passed in for the function to operate.</p></li>
<li><p><strong>latitude</strong> (<em>float</em>) – Latitude in degrees.</p></li>
<li><p><strong>longitude</strong> (<em>float</em>) – Longitude in degrees.</p></li>
<li><p><strong>altitude</strong> (<em>float</em>) – Altitude in meters.</p></li>
<li><p><strong>mjd</strong> (<em>float</em>) – Modified Julian Date.</p></li>
<li><p><strong>wavelengths</strong> (<em>np.array</em>) – Wavelengths in nm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>NamedTuple with fields wavelengths, absorption, scattering, total.  wavelengths field matches the input
wavelengths, absorption and scattering are the absorption and scattering cross sections respectively in
<span class="math notranslate nohighlight">\(\mathrm{cm^2}\)</span> and total is the sum of the two.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CrossSections</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sasktran</span> <span class="kn">import</span> <span class="n">OpticalProperty</span><span class="p">,</span> <span class="n">Climatology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt_prop</span> <span class="o">=</span> <span class="n">OpticalProperty</span><span class="p">(</span><span class="s1">&#39;O3_OSIRISRES&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">opt_prop</span><span class="p">)</span>
<span class="go">SasktranIF Optical Property: O3_OSIRISRES</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmospheric_state</span> <span class="o">=</span> <span class="n">Climatology</span><span class="p">(</span><span class="s1">&#39;msis90&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt_prop</span><span class="o">.</span><span class="n">calculate_cross_sections</span><span class="p">(</span><span class="n">atmospheric_state</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">mjd</span><span class="o">=</span><span class="mi">54372</span><span class="p">,</span>                                              <span class="n">wavelengths</span><span class="o">=</span><span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">600</span><span class="p">])</span>
<span class="go">CrossSections(wavelengths=array([350, 600]), absorption=array([  7.09857544e-23,   5.27719024e-21]), scattering=array([ 0.,  0.]), total=array([  7.09857544e-23,   5.27719024e-21]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sasktran.OpticalProperty.calculate_phase_matrix">
<span class="sig-name descname"><span class="pre">calculate_phase_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmospheric_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="climatology.html#sasktran.Climatology" title="sasktran.climatology.Climatology"><span class="pre">Climatology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_scatter_angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.OpticalProperty.calculate_phase_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the scattering phase matrix for the given optical property with a specific atmospheric
state and location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmospheric_state</strong> (<a class="reference internal" href="climatology.html#sasktran.Climatology" title="sasktran.Climatology"><em>sasktran.Climatology</em></a>) – Atmospheric state (sometime called background climatology, corresponds to
<a class="reference internal" href="atmosphere.html#sasktran.Atmosphere.atmospheric_state" title="sasktran.Atmosphere.atmospheric_state"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasktran.Atmosphere.atmospheric_state</span></code></a>). Typically the background climatology must
support temperature and pressure, e.g. msis90.  Some optical properties may not need a background
climatology, for example Mie aerosols, however one must still be passed in for the function to operate.</p></li>
<li><p><strong>latitude</strong> (<em>float</em>) – Latitude in degrees.</p></li>
<li><p><strong>longitude</strong> (<em>float</em>) – Longitude in degrees.</p></li>
<li><p><strong>altitude</strong> (<em>float</em>) – Altitude in meters.</p></li>
<li><p><strong>mjd</strong> (<em>float</em>) – Modified Julian Date.</p></li>
<li><p><strong>wavelengths</strong> (<em>np.array</em>) – Wavelengths in nm. Shape (N_wavel,)</p></li>
<li><p><strong>cosine_scatter_angles</strong> (<em>np.array</em>) – Array of cosine of the scattering angle. Shape (N_angle,)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>phase_matrix</strong> – Array of shape (N_wavel, N_angle, 4, 4) of phase matrices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt_prop</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Rayleigh</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmospheric_state</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">MSIS90</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt_prop</span><span class="o">.</span><span class="n">calculate_phase_matrix</span><span class="p">(</span><span class="n">atmospheric_state</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">mjd</span><span class="o">=</span><span class="mi">54372</span><span class="p">,</span>                                              <span class="n">wavelengths</span><span class="o">=</span><span class="p">[</span><span class="mi">350</span><span class="p">],</span> <span class="n">cosine_scatter_angles</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">array([[[[ 1.47818063, -0.        ,  0.        ,  0.        ],</span>
<span class="go">         [-0.        ,  1.4345419 ,  0.        ,  0.        ],</span>
<span class="go">         [ 0.        ,  0.        ,  1.4345419 ,  0.        ],</span>
<span class="go">         [ 0.        ,  0.        ,  0.        ,  1.39018959]]]])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.OpticalPropertyConvolved">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">OpticalPropertyConvolved</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optical_property</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><span class="pre">OpticalProperty</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavel_spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_stdev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.OpticalPropertyConvolved" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>Generic optical property container that is applicable to a wide variety of optical properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the optical property to create</p></li>
<li><p><strong>psf_wavelength</strong> (<em>np.ndarray</em>) – array of wavelengths in nanometers where the point spread function is defined.</p></li>
<li><p><strong>psf</strong> (<em>np.ndarray</em>) – array of point spread function values in nanometers. Same length as psf_wavelength</p></li>
<li><p><strong>wavel_spacing</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Spacing to calculate the high resolution wavelengths on in nanometers, default is 0.01nm</p></li>
<li><p><strong>num_stdev</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Number of standard deviations to use in the gaussian for convolution, default is 4</p></li>
<li><p><strong>output_spacing</strong> (<em>scalar</em><em>, </em><em>string optional</em>) – Spacing to calculate the convolved cross section on. Either a scalar to use a fixed spacing, or None to use
the wavelengths of the point spread function (wavel parameter). Default is none.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sasktran</span> <span class="kn">import</span> <span class="n">OpticalPropertyConvolved</span><span class="p">,</span> <span class="n">MSIS90</span><span class="p">,</span> <span class="n">O3DBM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convolved_dbm</span> <span class="o">=</span> <span class="n">OpticalPropertyConvolved</span><span class="p">(</span><span class="n">O3DBM</span><span class="p">(),</span> <span class="n">psf_wavelength</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>                                                 <span class="n">psf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">convolved_dbm</span><span class="p">)</span>
<span class="go">SasktranIF Optical Property: O3_DBM_Convolved</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convolved_dbm</span><span class="o">.</span><span class="n">calculate_cross_sections</span><span class="p">(</span><span class="n">MSIS90</span><span class="p">(),</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">mjd</span><span class="o">=</span><span class="mi">54372</span><span class="p">,</span>                                               <span class="n">wavelengths</span><span class="o">=</span><span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">600</span><span class="p">])</span>
<span class="go">CrossSections(wavelengths=array([350, 600]), absorption=array([  2.83084701e-22,   5.01481379e-21]), scattering=array([ 0.,  0.]), total=array([  2.83084701e-22,   5.01481379e-21]))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sasktran.OpticalPropertyConvolved.convolved_optical_property">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convolved_optical_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hires_optprop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><span class="pre">OpticalProperty</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavel_spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_stdev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.OpticalPropertyConvolved.convolved_optical_property" title="Link to this definition">¶</a></dt>
<dd><p>Convolves down the hi-resolution cross sections and creates a user defined optical property. Convolution assumes
the hi-resolution version has infinite resolution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hires_optprop</strong> (<a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.OpticalProperty"><em>sasktran.OpticalProperty</em></a>) – sasktran OpticalProperty that will be convolved down to desired resolution.</p></li>
<li><p><strong>wavel</strong> (<em>numpy array</em>) – Wavelengths to calculate the new cross section for in nm</p></li>
<li><p><strong>psf</strong> (<em>numpy array</em>) – Standard deviations of the gaussian to convolve by for each wavelength
Can be the same size as wavel, or size 1 in which case the psf is assumed
to be the same for all wavelengths</p></li>
<li><p><strong>wavel_spacing</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Spacing to calculate the high resolution wavelengths on in nanometers, default is 0.01nm</p></li>
<li><p><strong>num_stdev</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Number of standard deviations to use in the gaussian for convolution, default is 4</p></li>
<li><p><strong>output_spacing</strong> (<em>scalar</em><em>,</em><em>string optional</em>) – Spacing to calculate the convolved cross section on. Either a scalar to use a fixed spacing, or None to use
the wavelengths of the point spread function (wavel parameter). Default is none.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>optprop</strong> – Convolved optical property</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ISKOpticalProperty</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="useful-shorthands">
<h2>Useful Shorthands<a class="headerlink" href="#useful-shorthands" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sasktran.Rayleigh">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">Rayleigh</span></span><a class="headerlink" href="#sasktran.Rayleigh" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>An optical property object that provides Rayleigh molecular scattering in dry-air. The code closely follows the
algorithm published by Bates 1984 and exactly replicates his cross-section calculations to the 4 significant digits
in his Table 1. The cross-section is weighted to account for the different gas ratios in standard atmospheric
composition. No attempt is made to track changes in CO2 composition. Note that water vapour effects are implicitly
ignored as it only considers dry air. The only difference with Bates is that this object takes into account the
tiny fraction of gas that is not N2, O2, Argon or CO2. Bates ignores this component while this object assumes it
the residual gas with properties similar to Argon.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.O3DBM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">O3DBM</span></span><a class="headerlink" href="#sasktran.O3DBM" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>Tabulated high resolution cross-sections of O3 measured by Daumont, Brion and Malicet in the early 1990’s [1].
The wavelength range slightly varies with temperature but covers the entire UV to NIR region, from 194.50 nm to
830.00 nm at 0.01 to 0.02 nm resolution. The cross-section data were collected at 0.01-0.02 nm resolution and
each wavelength/cross-section table varies in size from 22,052 to 63,501 entries. The data consists of 5 tables
of wavelength versus cross-section for 5 temperatures.</p>
<p class="rubric">Notes</p>
<dl>
<dt>Temerature Range</dt><dd><p>Measurements are provided at 5 temperatures covering typical stratospheric and
tropospheric conditions:</p>
<blockquote>
<div><div class="line-block">
<div class="line">218 K</div>
<div class="line">228 K</div>
<div class="line">243 K</div>
<div class="line">273 K</div>
<div class="line">295 K</div>
</div>
</div></blockquote>
</dd>
<dt>Wavelength Range</dt><dd><p>The wavelength range of each temperature table is slightly different and is given below.
Note that most of the temperature variation occurs in the Huggins band
between 315 and 360 nm:</p>
<blockquote>
<div><div class="line-block">
<div class="line">218K -&gt; 194.50nm to 650.01nm</div>
<div class="line">228K -&gt; 194.50nm to 520.01nm</div>
<div class="line">243K -&gt; 194.50nm to 519.01nm</div>
<div class="line">273K -&gt; 299.50nm to 520.01nm</div>
<div class="line">295K -&gt; 195.00nm to 830.00nm</div>
</div>
</div></blockquote>
<p>We looked into temperature interpolation and while DBM suggest that a quadratic interpolation scheme [3] they do
not indicate an explicit technique. We tested several quadratic fitting routines and found that a truncated linear
fit in temperature was visually more appealing than any of the quadratic fits and had none of the undesirable
artifacts (excessive curvature etc.) that naturally arise with quadratic curve fitting. Consequently this object
uses a truncated linear fit in temperature.</p>
</dd>
<dt>Data Source</dt><dd><p>These data are an exact replication of the data files:</p>
<blockquote>
<div><div class="line-block">
<div class="line">O3_CRS_BDM_218K.dat</div>
<div class="line">O3_CRS_BDM_228K.dat</div>
<div class="line">O3_CRS_BDM_243K.dat</div>
<div class="line">O3_CRS_BDM_273K.dat</div>
<div class="line">O3_CRS_BDM_295K.dat</div>
</div>
</div></blockquote>
<p>Data is from the IGACO site, <a class="reference external" href="http://igaco-o3.fmi.fi/ACSO/files/cross_sections">http://igaco-o3.fmi.fi/ACSO/files/cross_sections</a>. The files were copied on
July 16-July 25 2012.</p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Daumont, D., et al. “Ozone UV spectroscopy I: Absorption cross-sections at room temperature.”
Journal of Atmospheric Chemistry 15.2 (1992): 145-155.</p>
</aside>
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Brion, J., et al. “High-resolution laboratory absorption cross section of O3. Temperature effect.”
Chemical physics letters 213.5 - 6(1993): 610-612.</p>
</aside>
<aside class="footnote brackets" id="id3" role="note">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Malicet, J., et al. “Ozone UV spectroscopy. II. Absorption cross-sections and temperature dependence.”
Journal of Atmospheric Chemistry 21.3 (1995): 263-273.</p>
</aside>
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<p>Brion, J., et al. “Absorption spectra measurements for the ozone molecule in the 350–830 nm region.”
Journal of Atmospheric Chemistry 30.2 (1998): 291-299.</p>
</aside>
</aside>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.O3OSIRISRes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">O3OSIRISRes</span></span><a class="headerlink" href="#sasktran.O3OSIRISRes" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>”
These are the cross-sections used in the OSIRIS level 2 analysis for Saskmart V5.07. This table is based upon
the cross-sections of Bogumil Orphal and Burrows and has been reduced to the nominal resolution of the OSIRIS
instrument (approx. 1.0 nm). The cross-sections range from 270nm to 820 nm in 0.1 nm steps.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.NO2Vandaele1998">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">NO2Vandaele1998</span></span><a class="headerlink" href="#sasktran.NO2Vandaele1998" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>Calculates the absorption cross section of NO2 molecules from 230 nm to 1000 nm at 220 K to 294 K following [1]</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Vandaele, Ann Carine, et al. “Measurements of the NO2 absorption cross-section from 42 000 cm− 1 to
10 000 cm− 1 (238–1000 nm) at 220 K and 294 K.” Journal of Quantitative Spectroscopy and Radiative Transfer
59.3-5 (1998): 171-184.</p>
</aside>
</aside>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.NO2OSIRISRes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">NO2OSIRISRes</span></span><a class="headerlink" href="#sasktran.NO2OSIRISRes" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>Calculates the absorption cross section of NO2 molecules from 230 nm to 795 nm and 221K to 293K. The cross-sections
have been reduced to the resolution of OSIRIS and these cross-sections have been used in the OSIRIS level 2 MART
retrievals.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.HITRANChemical">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">HITRANChemical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemical_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_line_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotope_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.HITRANChemical" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>Calculates the optical absorption and extinction of various atmospheric molecules using the Voigt line-shape and
the HITRAN spectral line database. The object supports all of the HITRAN species specified in the HITRAN database
file molparam.txt.  This optical property requires additional configuration, see <a class="reference internal" href="config.html#configuration"><span class="std std-ref">Configuration</span></a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemical_name</strong> (<em>str</em>) – Chemical abbreviation of the molecule of interest.</p></li>
<li><p><strong>isotope_filter</strong> (<em>int</em><em>, </em><em>optional</em>) – Allows the HITRAN object to load in just one isotope of the requested molecule. The value set must match one of
the isotope labels used for the given molecule in the HITRAN database file, molparam.txt. Note that the code
does not adjust the line strength but uses the line strength value as written in the HITRAN database. This
means you may have to account for and/or remove the abundance automatically built into the HITRAN database line
strength values.</p></li>
<li><p><strong>line_tolerance</strong> (<em>float</em><em>, </em><em>optional</em>) – Allows the user to set the tolerance used to reject weak lines from the current micro-window as part of a speed optimization strategy. The default value
is 0.0 which disables the optimization. Larger values speed up calculation of spectra but may result in choppy spectra at the smaller
intensities, especially in extinction/absorption spectra which typically follow the log of the cross-section. A
smaller value will reduce choppiness but increase computational speed. Only values greater
than or equal to zero are acceptable. A value of 1.0E-09 is a good starting value for users wishing to investigate
the effectiveness of the speed optimization.</p></li>
<li><p><strong>max_line_strength</strong> (<em>float</em><em>, </em><em>optional</em>) – Allows the user to manually set the maximum line strength within a micro-window. By default the object will take this value
from the strongest line in the micro-window. The value is used with the line tolerance to reject weak lines from
spectral calculations. A value of zero will disable the manual setting and reinstate usage of the default.</p></li>
<li><p><strong>use_cache</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true then cross sections will be cached when used internally inside a radiative transfer calculation.
The default is True, this should be left as True unless trying to calculate millions of wavelengths where
memory starts to become an issue.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sasktran.HITRANChemical.skif_object">
<span class="sig-name descname"><span class="pre">skif_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.HITRANChemical.skif_object" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Underlying ISKOpticalProperty object</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>skif.ISKOpticalProperty</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.MieAerosol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">MieAerosol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particlesize_climatology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="climatology.html#sasktran.Climatology" title="sasktran.climatology.Climatology"><span class="pre">Climatology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.MieAerosol" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>Specialized OpticalProperty which supports Mie Aerosol calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particlesize_climatology</strong> (<a class="reference internal" href="climatology.html#sasktran.Climatology" title="sasktran.Climatology"><em>sasktran.Climatology</em></a>) – </p></li>
<li><p><strong>species</strong> (<em>str</em>) – Molecule to use, one of [‘H2SO4’, ‘ICE’, ‘WATER’]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.SimpleRayleigh">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">SimpleRayleigh</span></span><a class="headerlink" href="#sasktran.SimpleRayleigh" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>An optical property object that provides Rayleigh molecular scattering without any corrections.
This is very similar to the <a class="reference internal" href="#sasktran.Rayleigh" title="sasktran.Rayleigh"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasktran.Rayleigh</span></code></a> optical property except that the Bates correction factor
is not included. For most calculations it is preferred to use the <a class="reference internal" href="#sasktran.Rayleigh" title="sasktran.Rayleigh"><code class="xref py py-class docutils literal notranslate"><span class="pre">sasktran.Rayleigh</span></code></a> optical property
instead.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.BaumIceCrystal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">BaumIceCrystal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">effective_size_microns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_delta_eddington</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.BaumIceCrystal" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>Scattering non-spherical ice crystals based upon the database from Baum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>effective_size_microns</strong> (<em>float</em>) – Size of the particles, typically from 10 microns to 50 microns</p></li>
<li><p><strong>use_delta_eddington</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if the delta eddington approximation is to be used.  Should be True for use
in either the HR or DO engines. Default: True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.SO2Vandaele2009">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">SO2Vandaele2009</span></span><a class="headerlink" href="#sasktran.SO2Vandaele2009" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>Calculates the absorption cross section of SO2 molecules from 227 nm to 420 nm at 298 K, 318 K, 338 K, and 358 K
following [1] and [2].</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id6" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>C. Hermans, A.C. Vandaele, and S. Fally. “Fourier transform measurements of SO2 absorption cross sections:
I. Temperature dependence in the 24000-29000 cm-1 (345-420 nm) region,” J. Quant. Spectrosc. Radiat.
Transfer 110, 756-765 (2009); DOI: 10.1016/j.jqsrt.2009.01.031</p>
</aside>
<aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>A.C. Vandaele, C. Hermans, and S. Fally, “Fourier transform measurements of SO2 absorption cross sections:
II. Temperature dependence in the 29000-44000 cm-1 (227-345 nm) region,” J. Quant. Spectrosc. Radiat.
Transfer 110, 2115-2126 (2009); DOI: 10.1016/j.jqsrt.2009.05.006</p>
</aside>
</aside>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.O2O2Fally2000">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">O2O2Fally2000</span></span><a class="headerlink" href="#sasktran.O2O2Fally2000" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>The collision induced absorption cross-sections measured by Fally et al. 2000.
The cross-sections were measured at room temperature with a Fourier Transform spectrometer in the 15000 to 29800 cm−1 region (335-667 nm) at a maximal optical path difference of 0.45 cm (resolution 2 cm-1).
Note that an appropriate climatology is the square of the O2 number density.
This is provided by climatologies that support SKCLIMATOLOGY_O2_O2_CM6.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.O2O2HITRAN2016">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">O2O2HITRAN2016</span></span><a class="headerlink" href="#sasktran.O2O2HITRAN2016" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>The O2-O2 collision induced absorption cross-sections distributed in Hitran 2016 as described by Karman et al. 2019.
It is composed of 8 spectral regions measured by several researchers that extend from 335nm to over 8 microns.
Some of the regions are temperature dependent and others are not</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.O2O2Thalman2013">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">O2O2Thalman2013</span></span><a class="headerlink" href="#sasktran.O2O2Thalman2013" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>The collision induced absorption cross-sections measured by Thalman et al. 2013.
The cross-sections were measured at room temperature with a Fourier Transform spectrometer in the 15000 to 29800 cm−1 region (335-667 nm) at a maximal optical path difference of 0.45 cm (resolution 2 cm-1).
Note that an appropriate climatology is the square of the O2 number density.
This is provided by climatologies that support SKCLIMATOLOGY_O2_O2_CM6. For example, see MSIS90 and ECMWF:</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.UserDefinedAbsorptionPressure">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">UserDefinedAbsorptionPressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broadener_vmr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperatures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavel_nm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadener_clim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="climatology.html#sasktran.Climatology" title="sasktran.climatology.Climatology"><span class="pre">Climatology</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadener_handle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.UserDefinedAbsorptionPressure" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>A user defined absorption optical property that is a function of temperature, pressure, wavelength, and VMR
of a secondary species that broadens the profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broadener_vmr</strong> (<em>np.array</em>) – VMR of the broadening species.  Must be in ascending order. Shape (Nv)</p></li>
<li><p><strong>pressures</strong> (<em>np.array</em>) – Pressure in Pa, must be in ascending order. Shape (Np)</p></li>
<li><p><strong>temperatures</strong> (<em>np.array</em>) – Temperatures in K at each pressure level.  Must be in ascending order. Shape (Np, Nt)</p></li>
<li><p><strong>wavel_nm</strong> (<em>np.array</em>) – Wavelengths in nm.  Must be in ascending order. Shape (Nw)</p></li>
<li><p><strong>xs</strong> (<em>np.ndarray</em>) – Cross sections in cm^2.  Shape (Nv, Np, Nt, Nw)</p></li>
<li><p><strong>broadener_clim</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="climatology.html#sasktran.Climatology" title="sasktran.Climatology"><em>Climatology</em></a><em>]</em>) – A climatology for the broadening species, can be None if there is no broadener. Default None.</p></li>
<li><p><strong>broadener_handle</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – The climatology handle for the broadener. Can be None if there is no broadener. Default None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.UserDefinedScatterConstantHeight">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">UserDefinedScatterConstantHeight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xs_scat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xs_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legendre_moments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_a1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_a2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_a3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_a4</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_b1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_b2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_m_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.UserDefinedScatterConstantHeight" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.OpticalProperty" title="sasktran.opticalproperty.OpticalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalProperty</span></code></a></p>
<p>A user defined optical property for a scattering species that has constant optical properties in location space.</p>
<p>Currently this optical property only supports specifying the phase function in terms of the Legendre expansion,
this means that it is only useful for the SASKTRAN-DO engine.</p>
<p>The Legendre expansion is defined in terms of “greek” coefficients, where the phase matrix has the standard form</p>
<div class="math notranslate nohighlight">
\[\begin{split}P(\Theta) = \begin{pmatrix}
              a1(\Theta) &amp; b1(\Theta) &amp; 0 &amp; 0 \\
              b1(\Theta) &amp; a2(\Theta) &amp; 0 &amp; 0 \\
              0 &amp; 0 &amp; a3(\Theta) &amp; b2(\Theta) \\
              0 &amp; 0 &amp; -b2(\Theta) &amp; a4(\Theta)
            \end{pmatrix}\end{split}\]</div>
<p>The phase function is then expanded in terms of Wigner functions (generalized spherical functions related to
Legendre polynomials/associated Legendre functions)</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a_1(\Theta) = \sum_l \alpha_{1,l} \, d^{l}_{00}(\Theta)\\a_2(\Theta) + a_3(\Theta) = \sum_l (\alpha_{2,l} + \alpha_{3,l}) \, d^{l}_{2,2}(\Theta)\\a_2(\Theta) - a_3(\Theta) = \sum_l (\alpha_{2,l} - \alpha_{3,l}) \, d^{l}_{2,-2}(\Theta)\\a_4(\Theta) = \sum_l \alpha_{4,l} \, d^{l}_{00}(\Theta)\\b_1(\Theta) = \sum_l \beta_{1,l} \, d^{l}_{02}(\Theta)\\b_2(\Theta) = -\sum_l \beta_{2,l} \, d^{l}_{02}(\Theta)\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelengths</strong> (<em>np.array</em>) – Array of wavelengths in nm.  Shape (n,)</p></li>
<li><p><strong>xs_scat</strong> (<em>np.array</em>) – Scattering cross section in cm2 at wavelengths. Shape (n,)</p></li>
<li><p><strong>xs_abs</strong> (<em>np.array</em>) – Absorption cross section in cm2 at wavelengths. Shape (n,)</p></li>
<li><p><strong>lm_a1</strong> (<em>np.ndarray</em>) – Legendre coefficients <span class="math notranslate nohighlight">\(\alpha_{1,l}\)</span>.  Shape (n, m).</p></li>
<li><p><strong>lm_a2</strong> (<em>np.ndarray</em>) – Legendre coefficients <span class="math notranslate nohighlight">\(\alpha_{2,l}\)</span>.  Shape (n, m).</p></li>
<li><p><strong>lm_a3</strong> (<em>np.ndarray</em>) – Legendre coefficients <span class="math notranslate nohighlight">\(\alpha_{3,l}\)</span>.  Shape (n, m).</p></li>
<li><p><strong>lm_a4</strong> (<em>np.ndarray</em>) – Legendre coefficients <span class="math notranslate nohighlight">\(\alpha_{4,l}\)</span>.  Shape (n, m).</p></li>
<li><p><strong>lm_b1</strong> (<em>np.ndarray</em>) – Legendre coefficients <span class="math notranslate nohighlight">\(\beta_{1,l}\)</span>.  Shape (n, m).</p></li>
<li><p><strong>lm_b2</strong> (<em>np.ndarray</em>) – Legendre coefficients <span class="math notranslate nohighlight">\(\beta_{2,l}\)</span>.  Shape (n, m).</p></li>
<li><p><strong>delta_m_order</strong> (<em>int</em>) – Delta-m order to truncaate the optical property by.  None implies no scaling</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt><a class="reference internal" href="species.html#species"><span class="std std-ref">Species</span></a></dt><dd><p>Representation of a atmospheric constituent.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="tir/climatology.html#climatology"><span class="std std-ref">Climatology</span></a></dt><dd><p>A profile quantifying something in/about the atmosphere. For example climatologies could be
used to define profiles for temperature, pressure, gas number densities, etc.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="atmosphere.html#atmosphere"><span class="std std-ref">Atmosphere</span></a></dt><dd><p>An object that describes the atmospheric constituents, and surface type to the engine.
Atmospheric constituents are defined by a list of <a class="reference internal" href="species.html#species"><span class="std std-ref">Species</span></a>, and surfaces are defined by
a given <a class="reference internal" href="brdf.html#brdf"><span class="std std-ref">BRDF</span></a>.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lines_of_sight.html" class="btn btn-neutral float-left" title="Lines of Sight" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="emission.html" class="btn btn-neutral float-right" title="Emission" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, ARG University of Saskatchewan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
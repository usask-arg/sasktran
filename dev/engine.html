<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Engine &mdash; SASKTRAN 1.8.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/_static/theme_overrides.css" />

  
    <link rel="shortcut icon" href="_static/sasktran-favicon.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=496f73d5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Geodetic" href="geodetic.html" />
    <link rel="prev" title="Climatology" href="climatology.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/sasktran-light.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.8.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing SASKTRAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructing_atmosphere.html">Specifying the Atmosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructing_geometry.html">Constructing the Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_engines.html">Choosing an Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_aerosol.html">Specifying Aerosol</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="api_reference.html#complete-api-reference-pages">Complete API Reference Pages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="atmosphere.html">Atmosphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="brdf.html">BRDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="climatology.html">Climatology</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Engine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#base-class">Base Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sasktran-hr">SASKTRAN HR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sasktran-do">SASKTRAN-DO</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sasktran-tir">SASKTRAN-TIR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sasktran-occ">SASKTRAN-OCC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sasktran-mc">SASKTRAN-MC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geodetic.html">Geodetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="lines_of_sight.html">Lines of Sight</a></li>
<li class="toctree-l3"><a class="reference internal" href="optical_property.html">Optical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="emission.html">Emission</a></li>
<li class="toctree-l3"><a class="reference internal" href="solar_spectrum.html">Solar Spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="species.html">Species</a></li>
<li class="toctree-l3"><a class="reference internal" href="stokes_vector.html">Stokes Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="weighting_functions.html">Weighting Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#additional-topics">Additional Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="experimental.html">Experimental Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sasktran_hr.html">SASKTRAN-HR</a></li>
<li class="toctree-l1"><a class="reference internal" href="tir/index.html">SASKTRAN Thermal InfraRed Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="do/index.html">SASKTRAN-DO</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SASKTRAN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api_reference.html">API Reference</a></li>
      <li class="breadcrumb-item active">Engine</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/engine.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="engine">
<span id="id1"></span><h1>Engine<a class="headerlink" href="#engine" title="Link to this heading">¶</a></h1>
<p>Module: <code class="docutils literal notranslate"><span class="pre">sasktran.engine</span></code></p>
<p>Engines are objects that can calculate radiances. Some of these engines can also calculate
analytic or optimized <a class="reference internal" href="weighting_functions.html#weighting-functions"><span class="std std-ref">Weighting Functions</span></a>. One of the primary design objectives of SASKTRAN
is to build a flexible radiative transfer framework so that the different components of a radiative
transfer calculation are as modular as possible. This is our motivation for calling these objects
engines as opposed to radiative transfer algorithms.</p>
<p>SASKTRAN’s primary engine product is <a class="reference internal" href="#sasktran-hr">SASKTRAN HR</a>.</p>
<section id="base-class">
<h2>Base Class<a class="headerlink" href="#base-class" title="Link to this heading">¶</a></h2>
<p>Engines require a <a class="reference internal" href="geometry.html#geometry"><span class="std std-ref">Geometry</span></a> object, and an <a class="reference internal" href="atmosphere.html#atmosphere"><span class="std std-ref">Atmosphere</span></a> object at a minimum to get the
gemetric and atmospheric specifications for the calculation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sasktran.Engine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">Engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#sasktran.Geometry" title="sasktran.geometry.Geometry"><span class="pre">Geometry</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.atmosphere.Atmosphere"><span class="pre">Atmosphere</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.Engine" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for objects which can perform radative transfer calculations.</p>
<dl class="py property">
<dt class="sig sig-object py" id="sasktran.Engine.atmosphere">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atmosphere</span></span><a class="headerlink" href="#sasktran.Engine.atmosphere" title="Link to this definition">¶</a></dt>
<dd><p>The engines atmosphere definition object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.Atmosphere">sasktran.Atmosphere</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sasktran.Engine.calculate_radiance">
<span class="sig-name descname"><span class="pre">calculate_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_stokes_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stokes_orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'geographic'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.Engine.calculate_radiance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate radiances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Determines the output format, one of [‘numpy’ or ‘xarray’].  If output_format=’numpy’, the radiance
and optionally the weighting functions are returned as numpy arrays.  If output_format=’xarray’ the
radiance and weighting functions are returned inside of an xarray Dataset object.</p></li>
<li><p><strong>full_stokes_vector</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the full stokes vector is output.  If False only the first element of the stokes vector
is included. Note that setting this does not automatically enable vector calculations
within the model, it only changes the output format, every model requires a different setting
to be changed to change the calculation mode.  Default: False</p></li>
<li><p><strong>stokes_orientation</strong> (<em>str</em><em>, </em><em>optional</em>) – One of ‘geographic.  The geographic basis is defined relative to the plane formed by the
observer position and look vector.  Here, Q, would be the linear polarization component for the nominal
‘up’ direction of an instrument.
Default: ‘geographic’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If output_format=’numpy’:
The first np.ndarray is always the computed radiances. The shape of the computed
radiances is (W, L) where W is the number of wavelengths, and L is the number of
lines of sight.
If <code class="docutils literal notranslate"><span class="pre">atmosphere.wf_species</span> <span class="pre">!=</span> <span class="pre">None</span></code> then a second np.ndarray will be returned
containing the computed weighting functions. The shape of this np.ndarray is
engine specific but typically (W, L, A) where A is the number of altitudes at which
at which the weighting functions were calculated.
If full_stokes_vector is set to True, then what is returned is an array of <cite>sasktran.StokesVector</cite>
objects.</p>
<p>If output_format=’xarray’:
A dataset containing the radiance and weighting functions with appropriate coordinates.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray <strong>or</strong> np.ndarray, np.ndarray <strong>or</strong> xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.Engine.geometry">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geometry</span></span><a class="headerlink" href="#sasktran.Engine.geometry" title="Link to this definition">¶</a></dt>
<dd><p>The engines geometry definition object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="geometry.html#sasktran.Geometry" title="sasktran.Geometry">sasktran.Geometry</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.Engine.options">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">options</span></span><a class="headerlink" href="#sasktran.Engine.options" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary map of additional engine options.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">EngineHR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;numordersofscatter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.Engine.wavelengths">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wavelengths</span></span><a class="headerlink" href="#sasktran.Engine.wavelengths" title="Link to this definition">¶</a></dt>
<dd><p>Wavelengths in nm to perform the radiative transfer calculation at.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">EngineHR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">wavelengths</span> <span class="o">=</span> <span class="mi">600</span> <span class="c1"># Single wavelength</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">wavelengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">340</span><span class="p">]</span> <span class="c1"># Multiple wavelengths</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most engines have a lot of features and configuration options. We have tried to make engine
default configurations as reasonable as possible but obviously these defaults cannot efficiently
handle every possible case. Because of this, users have to be aware additional engine
configuration might be necessary to obtain efficinent and accurate results. These additional
configuration options are set through engine options (see <a class="reference internal" href="#sasktran.Engine.options" title="sasktran.Engine.options"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sasktran.Engine.options</span></code></a>).</p>
</div>
</section>
<section id="sasktran-hr">
<h2>SASKTRAN HR<a class="headerlink" href="#sasktran-hr" title="Link to this heading">¶</a></h2>
<p>SASKTRAN HR is our primary engine product. The HR engine solves the radiative transfer equation
in a region of interest using the successive orders technique on a true spherical Earth. The main
highlights of the engine are:</p>
<ul class="simple">
<li><p>Support to calculate the <a class="reference internal" href="weighting_functions.html#weighting-functions"><span class="std std-ref">Weighting Functions</span></a> of target species</p></li>
<li><p>Adapative integration within optically thick regions</p></li>
<li><p>Polarized or scalar radiance calculations</p></li>
<li><p>Support for gradients across a region of interest using high resolution diffusive fields</p></li>
<li><p>Support for terminator conditions</p></li>
<li><p>Support for thermal emissions</p></li>
<li><p>Support for elevated surface topology</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sasktran.EngineHR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">EngineHR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#sasktran.Geometry" title="sasktran.geometry.Geometry"><span class="pre">Geometry</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.atmosphere.Atmosphere"><span class="pre">Atmosphere</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineHR" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.Engine" title="sasktran.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># configure your geometry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">VerticalImage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">from_sza_saa</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="mi">54372</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># configure your atmosphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Atmosphere</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;rayleigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">Rayleigh</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">MSIS90</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="o">.</span><span class="n">atmospheric_state</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">MSIS90</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;o3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">O3DBM</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">Labow</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;no2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">NO2Vandaele1998</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">Pratmo</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="o">.</span><span class="n">brdf</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Lambertian</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make your engine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">EngineHR</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">atmosphere</span><span class="o">=</span><span class="n">atmosphere</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">450</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rad</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_radiance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span> 
<span class="go">[[ 0.11674...  0.10872...  0.04904...  0.01456...]</span>
<span class="go"> [ 0.10837...  0.08537...  0.02897...  0.00804...]</span>
<span class="go"> [ 0.10318...  0.06396...  0.01829...  0.00483...]]</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.atmosphere_dimensions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atmosphere_dimensions</span></span><a class="headerlink" href="#sasktran.EngineHR.atmosphere_dimensions" title="Link to this definition">¶</a></dt>
<dd><p>Sets the number of dimensions for the atmosphere in the radiative transfer calculation.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>One-dimensional in altitude</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Two-dimensional in altitude and angle
along the line of sight</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Fully three-dimensional</p></td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> 1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sasktran.EngineHR.calculate_radiance">
<span class="sig-name descname"><span class="pre">calculate_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_stokes_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stokes_orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'geographic'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineHR.calculate_radiance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate radiances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Determines the output format, one of [‘numpy’ or ‘xarray’].  If output_format=’numpy’, the radiance
and optionally the weighting functions are returned as numpy arrays.  If output_format=’xarray’ the
radiance and weighting functions are returned inside of an xarray Dataset object.</p></li>
<li><p><strong>full_stokes_vector</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the full stokes vector is output.  If False only the first element of the stokes vector
is included. Note that setting this does not automatically enable vector calculations
within the model, it only changes the output format, every model requires a different setting
to be changed to change the calculation mode.  Default: False</p></li>
<li><p><strong>stokes_orientation</strong> (<em>str</em><em>, </em><em>optional</em>) – One of ‘geographic.  The geographic basis is defined relative to the plane formed by the
observer position and look vector.  Here, Q, would be the linear polarization component for the nominal
‘up’ direction of an instrument.
Default: ‘geographic’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If output_format=’numpy’:
The first np.ndarray is always the computed radiances. The shape of the computed
radiances is (W, L) where W is the number of wavelengths, and L is the number of
lines of sight.
If <code class="docutils literal notranslate"><span class="pre">atmosphere.wf_species</span> <span class="pre">!=</span> <span class="pre">None</span></code> then a second np.ndarray will be returned
containing the computed weighting functions. The shape of this np.ndarray is
engine specific but typically (W, L, A) where A is the number of altitudes at which
at which the weighting functions were calculated.
If full_stokes_vector is set to True, then what is returned is an array of <cite>sasktran.StokesVector</cite>
objects.</p>
<p>If output_format=’xarray’:
A dataset containing the radiance and weighting functions with appropriate coordinates.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray <strong>or</strong> np.ndarray, np.ndarray <strong>or</strong> xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sasktran.EngineHR.cell_optical_depths">
<span class="sig-name descname"><span class="pre">cell_optical_depths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineHR.cell_optical_depths" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the optical depths along each line of sight at each wavelength to each cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A two-dimensional list of shape (num_wavelength, num_los) where each element is a dictionary containing the keys
‘cell_start_optical_depth’ which has the optical depth at the start of the cell and ‘cell_start_distance’ which
has the distance from the observer to the start of the cell along the line of sight vector.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[List[Dict]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sasktran.EngineHR.configure_for_cloud">
<span class="sig-name descname"><span class="pre">configure_for_cloud</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_spacing_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cloud_altitudes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cloud_diffuse_spacing_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_optical_depth_of_cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_extinction_ratio_of_cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_adaptive_optical_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineHR.configure_for_cloud" title="Link to this definition">¶</a></dt>
<dd><p>Configures the HR model for use with a cloud.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_spacing_m</strong> (<em>float</em>) – Desired grid spacing of the model for all parameters exluding the cloud.</p></li>
<li><p><strong>cloud_altitudes</strong> (<em>np.array</em>) – Altitudes that the cloud is non-zero at. [m]</p></li>
<li><p><strong>cloud_diffuse_spacing_m</strong> (<em>float</em><em>, </em><em>Optional</em>) – Spacing in m that diffuse points should be placed inside the cloud. Lower values will result in a more
accurate multiple scattering calculatino within the cloud.  Default: 100 m</p></li>
<li><p><strong>max_optical_depth_of_cell</strong> (<em>float</em><em>, </em><em>Optional</em>) – Maximumum optical depth that is allowed for the adaptive integration step within HR.  Lower values will
result in a more accurate calculation.  Default: 0.01</p></li>
<li><p><strong>min_extinction_ratio_of_cell</strong> (<em>float</em><em>, </em><em>Optional</em>) – The minimum ratio of extinction that must be hit for the adaptive integration to split a cell in two, between 0 and 1.
Higher values will result in a more accurate calculation. It is recommended to leave this at 1 unless you know what you
are doing.  Default: 1</p></li>
<li><p><strong>max_adaptive_optical_depth</strong> (<em>float</em><em>, </em><em>Optional</em>) – The maximum optical depth along the ray where splitting where occur.  Default: 2</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.disable_los_single_scattering">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">disable_los_single_scattering</span></span><a class="headerlink" href="#sasktran.EngineHR.disable_los_single_scattering" title="Link to this definition">¶</a></dt>
<dd><p>Experimental option.  If set to true, then single scattering along the line of sight is not calculated.
Note that single scatter from the ground is still included if the line of sight intersects the Earth.
Default: False.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.grid_spacing">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grid_spacing</span></span><a class="headerlink" href="#sasktran.EngineHR.grid_spacing" title="Link to this definition">¶</a></dt>
<dd><p>Sets many options dealing with general grids and discretizations in the model.  In general, if you are interested
in things on the scale of 1000 m, then set this to 1000 m.  For most applications setting this property is
sufficient, however for advanced users it may be necessary to set some grids individually.</p>
<p><strong>Default:</strong> 1000 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.include_emissions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">include_emissions</span></span><a class="headerlink" href="#sasktran.EngineHR.include_emissions" title="Link to this definition">¶</a></dt>
<dd><p>Enables support for atmospheric emissions inside the model.  If set to True, any <a class="reference internal" href="emission.html#sasktran.Emission" title="sasktran.Emission"><code class="xref py py-class docutils literal notranslate"><span class="pre">Emission</span></code></a>
objects that are included in the <a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.Atmosphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atmosphere</span></code></a> will be used in the radiative
transfer calculation.  Note that the default value is False, ignoring emissions.</p>
<p><strong>Default:</strong> False</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.num_diffuse_profiles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_diffuse_profiles</span></span><a class="headerlink" href="#sasktran.EngineHR.num_diffuse_profiles" title="Link to this definition">¶</a></dt>
<dd><p>Advanced option that controls the number of diffuse profiles in the model.  If worried about the accuracy
of the multiple scatter signal, this should be the first option to try changing.  A diffuse profile
represents a (latitude, longitude) where the multiple scatter signal is calculated.  The default value of 1
indicates that the multiple scatter signal is only calculated at the reference point, or the average tangent
point.  If you increase the value to 5, then there will be 5 locations along the line of sight where the full
multiple scatter calculation is done.  Outside of these areas the multiple scatter signal is interpolated. Odd
numbers of diffuse profiles are preferred (but not necessary) since this facilitates one profile being placed
at the tangent point.</p>
<p>To determine if this setting has an effect on your calculation it is recommended to first compare the results
between 1, 5, and 11 diffuse profiles.</p>
<p>The amount of diffuse profiles to obtain an accurate depends heavily on a variety of things, but most heavily
the solar zenith and solar scattering angles.  When the sun is high in the sky (low solar zenith angle) 1–3
diffuse profiles is usually sufficient.  However, when looking across the solar terminator (sza ~90, ssa &lt; 90)
it might be necessary to use upwards of 50 diffuse profiles to obtain a signal accurate to better than 0.5%.
More information on the number of required diffuse profiles can be found in
Zawada, D. J., Dueck, S. R., Rieger, L. A., Bourassa, A. E., Lloyd, N. D., and Degenstein, D. A.: High-resolution and Monte Carlo additions to the SASKTRAN radiative transfer model, Atmos. Meas. Tech., 8, 2609-2623, <a class="reference external" href="https://doi.org/10.5194/amt-8-2609-2015">https://doi.org/10.5194/amt-8-2609-2015</a>, 2015.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.num_orders_of_scatter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_orders_of_scatter</span></span><a class="headerlink" href="#sasktran.EngineHR.num_orders_of_scatter" title="Link to this definition">¶</a></dt>
<dd><p>Controls the number of orders of scatter used inside the model. The number of orders of scatter controls the
accuracy of the model.  When set to 1, only light directly scattered from the sun is accounted for, with no
multiple scattering.</p>
<p>The model runs substantially faster when set
to 1 scatter order, therefore a common use case is to do development/testing with this property set to 1.  There
is very little speed difference between 2 orders of scatter and 50 orders of scatter, so usually it is
recommended to set this to either 1 or 50.</p>
<p><strong>Default:</strong> 50</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.num_threads">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_threads</span></span><a class="headerlink" href="#sasktran.EngineHR.num_threads" title="Link to this definition">¶</a></dt>
<dd><p>Controls the number of threads to use when multithreading the radiative transfer calculation.  The default value
of 0 indicates that the number of threads used will be equal to the number of available logical cores on
the target machine.</p>
<p>Setting this value to a lower number than the number of available cores can be useful when running a radiative
transfer calculation in the background and the computer is too slow to multitask.</p>
<p><strong>Default:</strong> 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.polarization">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">polarization</span></span><a class="headerlink" href="#sasktran.EngineHR.polarization" title="Link to this definition">¶</a></dt>
<dd><p>The polarization mode of the model.  Can either be set to ‘scalar’ or ‘vector’.</p>
<p><strong>Default:</strong> ‘scalar’</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.prefill_solartransmission_table">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prefill_solartransmission_table</span></span><a class="headerlink" href="#sasktran.EngineHR.prefill_solartransmission_table" title="Link to this definition">¶</a></dt>
<dd><p>Experimental option. If set to true, then the solar table will be prefilled instead of filling dynamically.
Default: False.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.refraction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">refraction</span></span><a class="headerlink" href="#sasktran.EngineHR.refraction" title="Link to this definition">¶</a></dt>
<dd><p>Determines whether or not refraction effects should be included in the radiative transfer calculation.
If set to true, then refraction effects will be considered where the model supports it.  Currently this is
only available for the observer line of sight rays (solar rays and multiple scattering will not account
for refraction).</p>
<p>Note that refraction support is experimental and may have some side effects.  Currently known limitations
are that the surface_elevation and top_of_atmosphere_altitudeproperty may not work properly with refraction
enabled.</p>
<p>Enabling refraction also changes the ray tracer slightly, meaning that calculations with and without refraction
enabled may differ slightly due to integration accuracies/quadrature points, etc.  It is recommended to
experiment with the grid_spacing property to ensure that the calculation is done with enough precision.</p>
<p><strong>Default:</strong> false</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.surface_elevation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">surface_elevation</span></span><a class="headerlink" href="#sasktran.EngineHR.surface_elevation" title="Link to this definition">¶</a></dt>
<dd><p>Sets the elevation of the surface in [m] for the model.  This setting can be used to account for changes in the Earth’s
topography.</p>
<p><strong>Default:</strong> 0 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.top_of_atmosphere_altitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top_of_atmosphere_altitude</span></span><a class="headerlink" href="#sasktran.EngineHR.top_of_atmosphere_altitude" title="Link to this definition">¶</a></dt>
<dd><p>Sets the altitude of the top of the atmosphere.  Above this altitude it is assumed there is no atmosphere.
The default value of 100000 m is typically suitable for stratospheric applications but for the mesosphere it
is sometimes necessary to increase this value.</p>
<p><strong>Default:</strong> 100000 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineHR.use_solartable_for_singlescatter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">use_solartable_for_singlescatter</span></span><a class="headerlink" href="#sasktran.EngineHR.use_solartable_for_singlescatter" title="Link to this definition">¶</a></dt>
<dd><p>Experimental option. If set to true, then the solar table will be used for single scattering calculations
instead of directly tracing solar rays.
Default: False.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sasktran.EngineHRSSApprox">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">EngineHRSSApprox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#sasktran.Geometry" title="sasktran.geometry.Geometry"><span class="pre">Geometry</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.atmosphere.Atmosphere"><span class="pre">Atmosphere</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ms_wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineHRSSApprox" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.EngineHR" title="sasktran.engine.EngineHR"><code class="xref py py-class docutils literal notranslate"><span class="pre">EngineHR</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sasktran.EngineHRSSApprox.calculate_radiance">
<span class="sig-name descname"><span class="pre">calculate_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_stokes_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stokes_orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'geographic'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineHRSSApprox.calculate_radiance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate radiances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Determines the output format, one of [‘numpy’ or ‘xarray’].  If output_format=’numpy’, the radiance
and optionally the weighting functions are returned as numpy arrays.  If output_format=’xarray’ the
radiance and weighting functions are returned inside of an xarray Dataset object.</p></li>
<li><p><strong>full_stokes_vector</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the full stokes vector is output.  If False only the first element of the stokes vector
is included. Note that setting this does not automatically enable vector calculations
within the model, it only changes the output format, every model requires a different setting
to be changed to change the calculation mode.  Default: False</p></li>
<li><p><strong>stokes_orientation</strong> (<em>str</em><em>, </em><em>optional</em>) – One of ‘geographic.  The geographic basis is defined relative to the plane formed by the
observer position and look vector.  Here, Q, would be the linear polarization component for the nominal
‘up’ direction of an instrument.
Default: ‘geographic’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If output_format=’numpy’:
The first np.ndarray is always the computed radiances. The shape of the computed
radiances is (W, L) where W is the number of wavelengths, and L is the number of
lines of sight.
If <code class="docutils literal notranslate"><span class="pre">atmosphere.wf_species</span> <span class="pre">!=</span> <span class="pre">None</span></code> then a second np.ndarray will be returned
containing the computed weighting functions. The shape of this np.ndarray is
engine specific but typically (W, L, A) where A is the number of altitudes at which
at which the weighting functions were calculated.
If full_stokes_vector is set to True, then what is returned is an array of <cite>sasktran.StokesVector</cite>
objects.</p>
<p>If output_format=’xarray’:
A dataset containing the radiance and weighting functions with appropriate coordinates.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray <strong>or</strong> np.ndarray, np.ndarray <strong>or</strong> xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="simple">
<dt>Additional Documentation</dt><dd><p>For additional documentation and options see: <a class="reference external" href="https://arg.usask.ca/docs/SasktranIF/hr.html">https://arg.usask.ca/docs/SasktranIF/hr.html</a>.</p>
</dd>
</dl>
</section>
<section id="sasktran-do">
<h2>SASKTRAN-DO<a class="headerlink" href="#sasktran-do" title="Link to this heading">¶</a></h2>
<p>SASKTRAN-DO is a radiative transfer engine similar to the well known DISORT and (V)LIDORT
radiative transfer algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sasktran.EngineDO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">EngineDO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#sasktran.Geometry" title="sasktran.geometry.Geometry"><span class="pre">Geometry</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.atmosphere.Atmosphere"><span class="pre">Atmosphere</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineDO" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.Engine" title="sasktran.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Configure the geometry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">NadirGeometry</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tempo</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Geodetic</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tempo</span><span class="o">.</span><span class="n">from_lat_lon_alt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">35786000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lats</span><span class="p">,</span> <span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">from_lat_lon</span><span class="p">(</span><span class="n">mjd</span><span class="o">=</span><span class="mf">57906.63472</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">tempo</span><span class="p">,</span> <span class="n">lats</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="o">=</span><span class="n">lons</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Configure the atmosphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">ConstituentAtmosphere</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;rayleigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">Rayleigh</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">MSIS90</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;o3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">O3DBM</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">Labow</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;no2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">NO2Vandaele1998</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">Pratmo</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="o">.</span><span class="n">brdf</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Kokhanovsky</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calcualte radiance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">EngineDO</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">atmosphere</span><span class="o">=</span><span class="n">atmosphere</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">450</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rad</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_radiance</span><span class="p">(</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># print radiances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span> <span class="c1"># radiance at 350nm</span>
<span class="go">[[ 0.15726175  0.19468353  0.22767423]</span>
<span class="go"> [ 0.1666762   0.20027906  0.22962238]</span>
<span class="go"> [ 0.17116222  0.1995542   0.22411801]</span>
<span class="go"> [ 0.17099479  0.1932349   0.21235274]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span> <span class="c1"># radiance at 450nm</span>
<span class="go">[[ 0.15884236  0.19815234  0.23287579]</span>
<span class="go"> [ 0.16822132  0.20341264  0.23415734]</span>
<span class="go"> [ 0.17226753  0.20184478  0.22736965]</span>
<span class="go"> [ 0.1716201   0.19441591  0.21402527]]</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineDO.alt_grid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alt_grid</span></span><a class="headerlink" href="#sasktran.EngineDO.alt_grid" title="Link to this definition">¶</a></dt>
<dd><p>Internal altitude grid inside the model.  ALl climatologies/optical properties are sampled on this grid, and
then integrated over it to find the layer quantities.
Default: Linearly spaced from 0 to 100 km with spacing of 0.5 km</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sasktran.EngineDO.calculate_radiance">
<span class="sig-name descname"><span class="pre">calculate_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xarray'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineDO.calculate_radiance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate radiances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Determines the output format, one of [‘numpy’ or ‘xarray’].  If output_format=’numpy’, the radiance
and optionally the weighting functions are returned as numpy arrays.  If output_format=’xarray’ the
radiance and weighting functions are returned inside of an xarray Dataset object.</p></li>
<li><p><strong>full_stokes_vector</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the full stokes vector is output.  If False only the first element of the stokes vector
is included. Note that setting this does not automatically enable vector calculations
within the model, it only changes the output format, every model requires a different setting
to be changed to change the calculation mode.  Default: False</p></li>
<li><p><strong>stokes_orientation</strong> (<em>str</em><em>, </em><em>optional</em>) – One of ‘geographic.  The geographic basis is defined relative to the plane formed by the
observer position and look vector.  Here, Q, would be the linear polarization component for the nominal
‘up’ direction of an instrument.
Default: ‘geographic’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If output_format=’numpy’:
The first np.ndarray is always the computed radiances. The shape of the computed
radiances is (W, L) where W is the number of wavelengths, and L is the number of
lines of sight.
If <code class="docutils literal notranslate"><span class="pre">atmosphere.wf_species</span> <span class="pre">!=</span> <span class="pre">None</span></code> then a second np.ndarray will be returned
containing the computed weighting functions. The shape of this np.ndarray is
engine specific but typically (W, L, A) where A is the number of altitudes at which
at which the weighting functions were calculated.
If full_stokes_vector is set to True, then what is returned is an array of <cite>sasktran.StokesVector</cite>
objects.</p>
<p>If output_format=’xarray’:
A dataset containing the radiance and weighting functions with appropriate coordinates.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray <strong>or</strong> np.ndarray, np.ndarray <strong>or</strong> xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineDO.layer_construction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">layer_construction</span></span><a class="headerlink" href="#sasktran.EngineDO.layer_construction" title="Link to this definition">¶</a></dt>
<dd><p>Method used to place the layer boundaries in altitude.  Should be one of <cite>uniform_pressure</cite> for
uniform pressure layers, <cite>uniform_optical_depth</cite> for layers of equal optical depth, <cite>uniform_height</cite> for layers
spaced linearly in height, <cite>match_altitude_grid</cite> to match layers with the internal altitude grid, or a numpy
array of altitudes for manually specified layer boundaries.
Default: uniform_pressure</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineDO.num_brdf_quadrature_terms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_brdf_quadrature_terms</span></span><a class="headerlink" href="#sasktran.EngineDO.num_brdf_quadrature_terms" title="Link to this definition">¶</a></dt>
<dd><p>The number of quadrature terms used to calculate the Legendre coefficients for the BRDF.  Only has an effect
if a Non-Lambertian surface is being used.
Default: 64</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineDO.num_spherical_sza">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_spherical_sza</span></span><a class="headerlink" href="#sasktran.EngineDO.num_spherical_sza" title="Link to this definition">¶</a></dt>
<dd><p>Number of solar zenith angles to calculate the plane parallel solution at when operating in spherical mode.
Default: 2</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineDO.num_stokes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_stokes</span></span><a class="headerlink" href="#sasktran.EngineDO.num_stokes" title="Link to this definition">¶</a></dt>
<dd><p>Number of stokes parameters to include in the calculation and output.  Set to 1 for scalar calculations, and
to 3 for vector calculations.
Default: 1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineDO.num_streams">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_streams</span></span><a class="headerlink" href="#sasktran.EngineDO.num_streams" title="Link to this definition">¶</a></dt>
<dd><p>The number of streams used inside the calculation.  Together with the number of layers, the number of streams
is one of the primary settings that controls the accuracy of the model.
Default: 16</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineDO.num_threads">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_threads</span></span><a class="headerlink" href="#sasktran.EngineDO.num_threads" title="Link to this definition">¶</a></dt>
<dd><p>Number of threads to use in the calculation when running on multiple wavelengths.  The value of 0 indicates
use every logical core present on the machine.  It is recommended to set this value to the number of physical
cores on the machine for maximum performance.
Default: 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineDO.viewing_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">viewing_mode</span></span><a class="headerlink" href="#sasktran.EngineDO.viewing_mode" title="Link to this definition">¶</a></dt>
<dd><p>Geometry viewing mode of the model for the line of sight rays, either <cite>spherical</cite> or <cite>plane_parallel</cite>.
Default: plane_parallel</p>
</dd></dl>

</dd></dl>

</section>
<section id="sasktran-tir">
<h2>SASKTRAN-TIR<a class="headerlink" href="#sasktran-tir" title="Link to this heading">¶</a></h2>
<p>SASKTRAN-TIR is a spherical radiative transfer engine designed for the thermal infrared regime where scattering
is negligible.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sasktran.EngineTIR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">EngineTIR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#sasktran.Geometry" title="sasktran.geometry.Geometry"><span class="pre">Geometry</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.atmosphere.Atmosphere"><span class="pre">Atmosphere</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineTIR" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.Engine" title="sasktran.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sasktran.tir.engine</span> <span class="kn">import</span> <span class="n">EngineTIR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sasktran.tir.opticalproperty</span> <span class="kn">import</span> <span class="n">HITRANChemicalTIR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Select wavenumbers to do calculation at</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavenum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">775.0</span><span class="p">,</span> <span class="mf">775.003</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Wavelengths passed to engine must in increasing order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelen</span> <span class="o">=</span> <span class="mf">1.0e7</span> <span class="o">/</span> <span class="n">wavenum</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create limb view geometry for a 20 km tangent altitude observed from a 40 km balloon altitude</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">VerticalImage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">from_sza_saa</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="mi">54372</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create an atmosphere with absorbing/emitting ozone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Atmosphere</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o3_opt</span> <span class="o">=</span> <span class="n">HITRANChemicalTIR</span><span class="p">(</span><span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="n">micro_window_margin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;ozone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">o3_opt</span><span class="p">,</span> <span class="n">sk</span><span class="o">.</span><span class="n">Labow</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the engine and perform the calculation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">EngineTIR</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">atmosphere</span><span class="o">=</span><span class="n">atmosphere</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelen</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rad</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_radiance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span>
<span class="go">[[8.73341577e+12 1.09506519e+13 1.32697534e+13 4.41957608e+12]</span>
<span class="go"> [1.47059359e+13 1.67048571e+13 2.02328109e+13 1.51375632e+13]</span>
<span class="go"> [1.06787128e+13 1.28978370e+13 1.59440769e+13 7.41160317e+12]</span>
<span class="go"> [5.22908338e+12 7.13817250e+12 7.17447283e+12 9.33290088e+11]]</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.adaptive_integration">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adaptive_integration</span></span><a class="headerlink" href="#sasktran.EngineTIR.adaptive_integration" title="Link to this definition">¶</a></dt>
<dd><p>A boolean property that, if True, enables dynamic cell splitting during the radiative transfer integration.
During the ray tracing process, the line of sight is split into cells based on the intersection of the line of
sight with geometric shapes used to split the atmosphere into homogeneous layers. When the optical depth of a
cell is computed, the cell is split if one or both of the following conditions are satisfied:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The optical depth of the cell exceeds the value specified by the property <code class="docutils literal notranslate"><span class="pre">max_optical_depth_of_cell</span></code></p></li>
<li><p>The ratio of the smaller of the two values of extinction at the endpoints of the cell to the larger
value is less than the property <code class="docutils literal notranslate"><span class="pre">min_extinction_ratio_of_cell</span></code></p></li>
</ol>
</div></blockquote>
<p><strong>Default:</strong> True</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.atmosphere_dimensions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atmosphere_dimensions</span></span><a class="headerlink" href="#sasktran.EngineTIR.atmosphere_dimensions" title="Link to this definition">¶</a></dt>
<dd><p>Sets the number of dimensions for the atmosphere in the radiative transfer calculation.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>One-dimensional in altitude</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Two-dimensional in altitude and along
along the line of sight</p></td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> 1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sasktran.EngineTIR.calculate_radiance">
<span class="sig-name descname"><span class="pre">calculate_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_stokes_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineTIR.calculate_radiance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate radiances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Determines the output format, one of [‘numpy’ or ‘xarray’].  If output_format=’numpy’, the radiance
and optionally the weighting functions are returned as numpy arrays.  If output_format=’xarray’ the
radiance and weighting functions are returned inside of an xarray Dataset object.</p></li>
<li><p><strong>full_stokes_vector</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the full stokes vector is output.  If False only the first element of the stokes vector
is included. Note that setting this does not automatically enable vector calculations
within the model, it only changes the output format, every model requires a different setting
to be changed to change the calculation mode.  Default: False</p></li>
<li><p><strong>stokes_orientation</strong> (<em>str</em><em>, </em><em>optional</em>) – One of ‘geographic.  The geographic basis is defined relative to the plane formed by the
observer position and look vector.  Here, Q, would be the linear polarization component for the nominal
‘up’ direction of an instrument.
Default: ‘geographic’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If output_format=’numpy’:
The first np.ndarray is always the computed radiances. The shape of the computed
radiances is (W, L) where W is the number of wavelengths, and L is the number of
lines of sight.
If <code class="docutils literal notranslate"><span class="pre">atmosphere.wf_species</span> <span class="pre">!=</span> <span class="pre">None</span></code> then a second np.ndarray will be returned
containing the computed weighting functions. The shape of this np.ndarray is
engine specific but typically (W, L, A) where A is the number of altitudes at which
at which the weighting functions were calculated.
If full_stokes_vector is set to True, then what is returned is an array of <cite>sasktran.StokesVector</cite>
objects.</p>
<p>If output_format=’xarray’:
A dataset containing the radiance and weighting functions with appropriate coordinates.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray <strong>or</strong> np.ndarray, np.ndarray <strong>or</strong> xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.do_temperature_wf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_temperature_wf</span></span><a class="headerlink" href="#sasktran.EngineTIR.do_temperature_wf" title="Link to this definition">¶</a></dt>
<dd><p>Set this property to True to enable temperature weighting function calculations.</p>
<p><strong>Default:</strong> False</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.do_vmr_wf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_vmr_wf</span></span><a class="headerlink" href="#sasktran.EngineTIR.do_vmr_wf" title="Link to this definition">¶</a></dt>
<dd><p>Controls the units of gas species weighting functions. The default setting configures weighting functions
to be given in (radiance / number density) where number density has units of cm^-3.
Setting this property to True tells the engine to calculate weighting functions with units of
(radiance / VMR).</p>
<p><strong>Default:</strong> False</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.grid_spacing">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grid_spacing</span></span><a class="headerlink" href="#sasktran.EngineTIR.grid_spacing" title="Link to this definition">¶</a></dt>
<dd><p>Sets the vertical spacing of homogeneous atmosphere layers in [m].</p>
<p><strong>Default:</strong> 1000 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.ground_emissivity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ground_emissivity</span></span><a class="headerlink" href="#sasktran.EngineTIR.ground_emissivity" title="Link to this definition">¶</a></dt>
<dd><p>Sets the scalar emissivity of the surface of the Earth. If the line of sight ends at the ground, the emission
from the Earth’s surface must be taken into account. In the TIR engine this emission is modelled as a
black body with constant emissivity. For limb-viewing geometries this setting will have no effect as there are
no scattering effects in the TIR engine.</p>
<p><strong>Default:</strong> 1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.linear_extinction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">linear_extinction</span></span><a class="headerlink" href="#sasktran.EngineTIR.linear_extinction" title="Link to this definition">¶</a></dt>
<dd><p>If this property is set to True, the engine calculates the optical depth of a cell by allowing the extinction
to vary linearly with height, between the values at the endpoints of the cell. If this property is set to False,
the extinction of a cell is constant, calculated as the average of the values at the endpoints.</p>
<p><strong>Default:</strong> True</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.max_optical_depth_of_cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_optical_depth_of_cell</span></span><a class="headerlink" href="#sasktran.EngineTIR.max_optical_depth_of_cell" title="Link to this definition">¶</a></dt>
<dd><p>Set the maximum optical depth of a single cell is allowed to have before it is split into two cells, when
adaptive integration is enabled. If the property <code class="docutils literal notranslate"><span class="pre">adaptive_integration</span></code> is set to False, this property has no
effect.</p>
<p><strong>Default:</strong> 0.1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.min_extinction_ratio_of_cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">min_extinction_ratio_of_cell</span></span><a class="headerlink" href="#sasktran.EngineTIR.min_extinction_ratio_of_cell" title="Link to this definition">¶</a></dt>
<dd><p>Set the minimum ratio between the extinction at the endpoints of single cell that is allowed before the cell
is split, when adaptive integration is enabled. If the property <code class="docutils literal notranslate"><span class="pre">adaptive_integration</span></code> is set to False, this
property has no effect. The ratio is calculated as the smaller of the two extinction values divided by the
larger.</p>
<p><strong>Default</strong> 0.9</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.num_threads">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_threads</span></span><a class="headerlink" href="#sasktran.EngineTIR.num_threads" title="Link to this definition">¶</a></dt>
<dd><p>Controls the number of threads to use when multithreading the radiative transfer calculation.  The default value
of 0 indicates that the number of threads used will be equal to the number of available logical cores on
the target machine.</p>
<p>Setting this value to a lower number than the number of available cores can be useful when running a radiative
transfer calculation in the background and the computer is too slow to multitask.</p>
<p><strong>Default:</strong> 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.refraction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">refraction</span></span><a class="headerlink" href="#sasktran.EngineTIR.refraction" title="Link to this definition">¶</a></dt>
<dd><p>If set to true, then refractive ray tracing is performed for the observer line of sight rays.</p>
<p><strong>Default:</strong> false</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.surface_elevation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">surface_elevation</span></span><a class="headerlink" href="#sasktran.EngineTIR.surface_elevation" title="Link to this definition">¶</a></dt>
<dd><p>Sets the surface elevation in meters.</p>
<p><strong>Default:</strong> 0 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.top_of_atmosphere_altitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top_of_atmosphere_altitude</span></span><a class="headerlink" href="#sasktran.EngineTIR.top_of_atmosphere_altitude" title="Link to this definition">¶</a></dt>
<dd><p>Sets the altitude of the top of the atmosphere. Above this altitude it is assumed there is no atmosphere.
Due to the assumption of local thermodynamic equilibrium within the Thermal InfraRed engine, increasing
the value above 100000 m is not recommended because this simplification can not be used at higher altitudes.</p>
<p><strong>Default:</strong> 100000 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.use_cached_cross_sections">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">use_cached_cross_sections</span></span><a class="headerlink" href="#sasktran.EngineTIR.use_cached_cross_sections" title="Link to this definition">¶</a></dt>
<dd><p>Designed to enable faster iterative radiance calculations, this setting instructs the TIR engine to compute
cross sections using cached results. This can only be done if:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calculate_radiance()</span></code> has been called at least once</p></li>
<li><p>The only change to the engine object since the last call to <code class="docutils literal notranslate"><span class="pre">calculate_radiance()</span></code> is the number density
climatology of one or more species in the atmosphere property. The optical properties used for these
species must the same; if a new optical property is specified, the resulting radiance will be as though
the old optical property were used.</p></li>
<li><p>The species whose climatologies have been changed must also be set as the <code class="docutils literal notranslate"><span class="pre">wf_species</span></code> of the atmosphere
property, i.e. only the species for which weighting functions are computed may have their climatologies
changed</p></li>
</ol>
</div></blockquote>
<p><strong>Default:</strong> True</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.wavelengths">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wavelengths</span></span><a class="headerlink" href="#sasktran.EngineTIR.wavelengths" title="Link to this definition">¶</a></dt>
<dd><p>Wavelengths in nm to perform the radiative transfer calculation at.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">EngineHR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">wavelengths</span> <span class="o">=</span> <span class="mi">600</span> <span class="c1"># Single wavelength</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">wavelengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">340</span><span class="p">]</span> <span class="c1"># Multiple wavelengths</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.wf_heights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wf_heights</span></span><a class="headerlink" href="#sasktran.EngineTIR.wf_heights" title="Link to this definition">¶</a></dt>
<dd><p>Heights, in meters, to compute analytic weighting functions at.</p>
<p><strong>Default:</strong> <code class="docutils literal notranslate"><span class="pre">np.linspace(500,</span> <span class="pre">99500,</span> <span class="pre">100)</span></code>  # 500, 1500, 2500, …, 99500</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineTIR.wf_widths">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wf_widths</span></span><a class="headerlink" href="#sasktran.EngineTIR.wf_widths" title="Link to this definition">¶</a></dt>
<dd><p>Weighting function widths. The weighting functions determine the effect of perturbing a species population at
each height specified by <code class="docutils literal notranslate"><span class="pre">wf_heights</span></code> on the radiance. The property wf_widths species the vertical distance
from each value in <code class="docutils literal notranslate"><span class="pre">wf_heights</span></code> to the height where the perturbation is zero. Therefore, <code class="docutils literal notranslate"><span class="pre">wf_heights</span></code> and <code class="docutils literal notranslate"><span class="pre">wf_widths</span></code>
must have identical lengths.</p>
<p>i.e. for a weighting function calculation at <code class="docutils literal notranslate"><span class="pre">wf_heights[i]</span></code>, the perturbation is maximum at <code class="docutils literal notranslate"><span class="pre">wf_heights[i]</span></code> and
decreases linearly (with height) to 0 at <code class="docutils literal notranslate"><span class="pre">(wf_heights[i]</span> <span class="pre">-</span> <span class="pre">wf_widths[i])</span></code> and <code class="docutils literal notranslate"><span class="pre">(wf_heights[i]</span> <span class="pre">+</span> <span class="pre">wf_widths[i])</span></code>.</p>
<p><strong>Default:</strong> <code class="docutils literal notranslate"><span class="pre">np.array([1000]</span> <span class="pre">*</span> <span class="pre">100)</span></code>  # sets a width of 1000 m at every height in wf_heights</p>
</dd></dl>

</dd></dl>

</section>
<section id="sasktran-occ">
<h2>SASKTRAN-OCC<a class="headerlink" href="#sasktran-occ" title="Link to this heading">¶</a></h2>
<p>An occultation engine.  This engine calculates the optical depth along a curved line of sight in the atmosphere.</p>
<figure class="align-default" id="id2">
<img alt="_images/co2_occult.png" src="_images/co2_occult.png" />
<figcaption>
<p><span class="caption-text">Figure generated from the data generated by the example given below.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<dl class="py class">
<dt class="sig sig-object py" id="sasktran.EngineOCC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">EngineOCC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#sasktran.Geometry" title="sasktran.geometry.Geometry"><span class="pre">Geometry</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.atmosphere.Atmosphere"><span class="pre">Atmosphere</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineOCC" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.Engine" title="sasktran.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></p>
<p>”
The <code class="docutils literal notranslate"><span class="pre">OCC</span></code> engine was built as a radiative transfer model for solar occultation observations from a satellite. It was
originally built as a plug-in subsititute engine for the Fortran code used in the <a class="reference external" href="http://www.ace.uwaterloo.ca/instruments_acefts.php">ACE-FTS</a>
analysis and is well-suited for atmospheric transmission calculations in near infra-red and infra-red micro-windows. The algorithm
traces curved rays using a spherically symmetric version of Snells law,  Thompson et al. 1982. The refractive index of the
atmosphere follows the dry-air formula published by Filippenko 1982 which only requires a single profile of pressure
and temperature; we note that the atmospheric refractive index does not include effects due to moist air which
may be significant at tropospheric altitudes.</p>
<p>The code for the OCC engine was frequently compared to the original Fortran code during development to ensure
they are identical. The engine calculates transmission through the atmosphere, rather than radiance, and has
the following features:</p>
<blockquote>
<div><ul class="simple">
<li><p>curved ray tracing in a spherically symmetric atmosphere. The path length of the
curved ray is the same as the ACE-FTS code to within 1 micron.</p></li>
<li><p>The code provides efficient calculation of Voigt profiles across micro-windows in the near infra-red and infra-red.</p></li>
</ul>
</div></blockquote>
<p class="rubric">References</p>
<p><strong>Dennis A. Thompson</strong>, Theodore J. Pepin, and Frances W. Simon. Ray tracing in a refracting spherically symmetric atmosphere.
J. Opt. Soc. Am., 72(11):1498–1501, Nov 1982. URL: <a class="reference external" href="http://www.osapublishing.org/abstract.cfm?URI=josa-72-11-1498">http://www.osapublishing.org/abstract.cfm?URI=josa-72-11-1498</a>,
doi:10.1364/JOSA.72.001498.</p>
<p><strong>A. V. Filippenko</strong>. The importance of atmospheric differential refraction in spectrophotometry. Publications of the Astronomical Society of the Pacific , 94:715–721, August 1982. doi:10.1086/131052.</p>
<p class="rubric">Example</p>
<p>Here is an example that calculates the optical depth at 5000 wavenumbers across a CO2 band at 934 to 936 cm-1. This example is almost the same as ACE-FTS scan ace.sr20314 except the sun is no longer
in the correct location. The test example creates a user defined profile of CO2 number density used for CO2 absorption and the MSIS climatology for Rayleigh extinction. Lines of sights are specified
as an array of tangent altitudes and the satellite is placed at 600 km. Optical depth through the atmosphere is calculated for each tangent altitude across the 4000 wavenumbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>

<span class="k">def</span> <span class="nf">test_occ_engine</span><span class="p">():</span>

    <span class="n">co2profile</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span>    <span class="mf">0.000</span><span class="p">,</span> <span class="mf">9.5620350469e+15</span><span class="p">,</span>  <span class="mf">1000.000</span><span class="p">,</span> <span class="mf">8.5604676285e+15</span><span class="p">,</span>  <span class="mf">2000.000</span><span class="p">,</span> <span class="mf">7.7062120091e+15</span><span class="p">,</span>  <span class="mf">3000.000</span><span class="p">,</span> <span class="mf">6.9531991470e+15</span><span class="p">,</span>  <span class="mf">4000.000</span><span class="p">,</span> <span class="mf">6.2702731320e+15</span><span class="p">,</span>  <span class="mf">5000.000</span><span class="p">,</span> <span class="mf">5.6375862919e+15</span><span class="p">,</span>
                    <span class="mf">6000.000</span><span class="p">,</span> <span class="mf">5.0651291274e+15</span><span class="p">,</span>  <span class="mf">7000.000</span><span class="p">,</span> <span class="mf">4.4975838604e+15</span><span class="p">,</span>  <span class="mf">8000.000</span><span class="p">,</span> <span class="mf">3.9468136861e+15</span><span class="p">,</span>  <span class="mf">9000.000</span><span class="p">,</span> <span class="mf">3.4348048814e+15</span><span class="p">,</span> <span class="mf">10000.000</span><span class="p">,</span> <span class="mf">2.9871067830e+15</span><span class="p">,</span> <span class="mf">11000.000</span><span class="p">,</span> <span class="mf">2.5656416175e+15</span><span class="p">,</span>
                   <span class="mf">12000.000</span><span class="p">,</span> <span class="mf">2.1874053365e+15</span><span class="p">,</span> <span class="mf">13000.000</span><span class="p">,</span> <span class="mf">1.8533816021e+15</span><span class="p">,</span> <span class="mf">14000.000</span><span class="p">,</span> <span class="mf">1.6023327829e+15</span><span class="p">,</span> <span class="mf">15000.000</span><span class="p">,</span> <span class="mf">1.3568375796e+15</span><span class="p">,</span> <span class="mf">16000.000</span><span class="p">,</span> <span class="mf">1.1279532788e+15</span><span class="p">,</span> <span class="mf">17000.000</span><span class="p">,</span> <span class="mf">9.7672446573e+14</span><span class="p">,</span>
                   <span class="mf">18000.000</span><span class="p">,</span> <span class="mf">8.4173283897e+14</span><span class="p">,</span> <span class="mf">19000.000</span><span class="p">,</span> <span class="mf">7.1576699275e+14</span><span class="p">,</span> <span class="mf">20000.000</span><span class="p">,</span> <span class="mf">6.2070908062e+14</span><span class="p">,</span> <span class="mf">21000.000</span><span class="p">,</span> <span class="mf">5.2364297410e+14</span><span class="p">,</span> <span class="mf">22000.000</span><span class="p">,</span> <span class="mf">4.3181248841e+14</span><span class="p">,</span> <span class="mf">23000.000</span><span class="p">,</span> <span class="mf">3.7860567983e+14</span><span class="p">,</span>
                   <span class="mf">24000.000</span><span class="p">,</span> <span class="mf">3.2428122678e+14</span><span class="p">,</span> <span class="mf">25000.000</span><span class="p">,</span> <span class="mf">2.7110791383e+14</span><span class="p">,</span> <span class="mf">26000.000</span><span class="p">,</span> <span class="mf">2.3526785090e+14</span><span class="p">,</span> <span class="mf">27000.000</span><span class="p">,</span> <span class="mf">2.0344493146e+14</span><span class="p">,</span> <span class="mf">28000.000</span><span class="p">,</span> <span class="mf">1.7304110039e+14</span><span class="p">,</span> <span class="mf">29000.000</span><span class="p">,</span> <span class="mf">1.4714113133e+14</span><span class="p">,</span>
                   <span class="mf">30000.000</span><span class="p">,</span> <span class="mf">1.2544180466e+14</span><span class="p">,</span> <span class="mf">31000.000</span><span class="p">,</span> <span class="mf">1.0738346125e+14</span><span class="p">,</span> <span class="mf">32000.000</span><span class="p">,</span> <span class="mf">9.2442937053e+13</span><span class="p">,</span> <span class="mf">33000.000</span><span class="p">,</span> <span class="mf">8.0342242281e+13</span><span class="p">,</span> <span class="mf">34000.000</span><span class="p">,</span> <span class="mf">6.9455591820e+13</span><span class="p">,</span> <span class="mf">35000.000</span><span class="p">,</span> <span class="mf">5.9095214441e+13</span><span class="p">,</span>
                   <span class="mf">36000.000</span><span class="p">,</span> <span class="mf">5.0374561563e+13</span><span class="p">,</span> <span class="mf">37000.000</span><span class="p">,</span> <span class="mf">4.3515754800e+13</span><span class="p">,</span> <span class="mf">38000.000</span><span class="p">,</span> <span class="mf">3.7794009046e+13</span><span class="p">,</span> <span class="mf">39000.000</span><span class="p">,</span> <span class="mf">3.2874895083e+13</span><span class="p">,</span> <span class="mf">40000.000</span><span class="p">,</span> <span class="mf">2.8685628465e+13</span><span class="p">,</span> <span class="mf">41000.000</span><span class="p">,</span> <span class="mf">2.4978923024e+13</span><span class="p">,</span>
                   <span class="mf">42000.000</span><span class="p">,</span> <span class="mf">2.1682117851e+13</span><span class="p">,</span> <span class="mf">43000.000</span><span class="p">,</span> <span class="mf">1.8864809592e+13</span><span class="p">,</span> <span class="mf">44000.000</span><span class="p">,</span> <span class="mf">1.6431826141e+13</span><span class="p">,</span> <span class="mf">45000.000</span><span class="p">,</span> <span class="mf">1.4348899126e+13</span><span class="p">,</span> <span class="mf">46000.000</span><span class="p">,</span> <span class="mf">1.2595260698e+13</span><span class="p">,</span> <span class="mf">47000.000</span><span class="p">,</span> <span class="mf">1.1093125765e+13</span><span class="p">,</span>
                   <span class="mf">48000.000</span><span class="p">,</span> <span class="mf">9.8376261311e+12</span><span class="p">,</span> <span class="mf">49000.000</span><span class="p">,</span> <span class="mf">8.8026864921e+12</span><span class="p">,</span> <span class="mf">50000.000</span><span class="p">,</span> <span class="mf">7.8993464447e+12</span><span class="p">,</span> <span class="mf">51000.000</span><span class="p">,</span> <span class="mf">7.0038829664e+12</span><span class="p">,</span> <span class="mf">52000.000</span><span class="p">,</span> <span class="mf">6.0771348455e+12</span><span class="p">,</span> <span class="mf">53000.000</span><span class="p">,</span> <span class="mf">5.2887296427e+12</span><span class="p">,</span>
                   <span class="mf">54000.000</span><span class="p">,</span> <span class="mf">4.6787494256e+12</span><span class="p">,</span> <span class="mf">55000.000</span><span class="p">,</span> <span class="mf">4.1667051367e+12</span><span class="p">,</span> <span class="mf">56000.000</span><span class="p">,</span> <span class="mf">3.6751620506e+12</span><span class="p">,</span> <span class="mf">57000.000</span><span class="p">,</span> <span class="mf">3.1811011797e+12</span><span class="p">,</span> <span class="mf">58000.000</span><span class="p">,</span> <span class="mf">2.7604364326e+12</span><span class="p">,</span> <span class="mf">59000.000</span><span class="p">,</span> <span class="mf">2.4249492298e+12</span><span class="p">,</span>
                   <span class="mf">60000.000</span><span class="p">,</span> <span class="mf">2.1420175118e+12</span><span class="p">,</span> <span class="mf">61000.000</span><span class="p">,</span> <span class="mf">1.8772791073e+12</span><span class="p">,</span> <span class="mf">62000.000</span><span class="p">,</span> <span class="mf">1.6195294613e+12</span><span class="p">,</span> <span class="mf">63000.000</span><span class="p">,</span> <span class="mf">1.3994285676e+12</span><span class="p">,</span> <span class="mf">64000.000</span><span class="p">,</span> <span class="mf">1.2229247260e+12</span><span class="p">,</span> <span class="mf">65000.000</span><span class="p">,</span> <span class="mf">1.0734951007e+12</span><span class="p">,</span>
                   <span class="mf">66000.000</span><span class="p">,</span> <span class="mf">9.3270881894e+11</span><span class="p">,</span> <span class="mf">67000.000</span><span class="p">,</span> <span class="mf">7.9345730980e+11</span><span class="p">,</span> <span class="mf">68000.000</span><span class="p">,</span> <span class="mf">6.7795327304e+11</span><span class="p">,</span> <span class="mf">69000.000</span><span class="p">,</span> <span class="mf">5.9174431127e+11</span><span class="p">,</span> <span class="mf">70000.000</span><span class="p">,</span> <span class="mf">5.2173619614e+11</span><span class="p">,</span> <span class="mf">71000.000</span><span class="p">,</span> <span class="mf">4.5523334147e+11</span><span class="p">,</span>
                   <span class="mf">72000.000</span><span class="p">,</span> <span class="mf">3.8840635314e+11</span><span class="p">,</span> <span class="mf">73000.000</span><span class="p">,</span> <span class="mf">3.3304529951e+11</span><span class="p">,</span> <span class="mf">74000.000</span><span class="p">,</span> <span class="mf">2.9045416707e+11</span><span class="p">,</span> <span class="mf">75000.000</span><span class="p">,</span> <span class="mf">2.5517516779e+11</span><span class="p">,</span> <span class="mf">76000.000</span><span class="p">,</span> <span class="mf">2.2127024526e+11</span><span class="p">,</span> <span class="mf">77000.000</span><span class="p">,</span> <span class="mf">1.8582366434e+11</span><span class="p">,</span>
                   <span class="mf">78000.000</span><span class="p">,</span> <span class="mf">1.5596546276e+11</span><span class="p">,</span> <span class="mf">79000.000</span><span class="p">,</span> <span class="mf">1.3362547386e+11</span><span class="p">,</span> <span class="mf">80000.000</span><span class="p">,</span> <span class="mf">1.1541990113e+11</span><span class="p">,</span> <span class="mf">81000.000</span><span class="p">,</span> <span class="mf">9.8756976417e+10</span><span class="p">,</span> <span class="mf">82000.000</span><span class="p">,</span> <span class="mf">8.2629944315e+10</span><span class="p">,</span> <span class="mf">83000.000</span><span class="p">,</span> <span class="mf">6.8563739750e+10</span><span class="p">,</span>
                   <span class="mf">84000.000</span><span class="p">,</span> <span class="mf">5.6814363571e+10</span><span class="p">,</span> <span class="mf">85000.000</span><span class="p">,</span> <span class="mf">4.6797966799e+10</span><span class="p">,</span> <span class="mf">86000.000</span><span class="p">,</span> <span class="mf">3.8795906044e+10</span><span class="p">,</span> <span class="mf">87000.000</span><span class="p">,</span> <span class="mf">3.2908654369e+10</span><span class="p">,</span> <span class="mf">88000.000</span><span class="p">,</span> <span class="mf">2.7811184596e+10</span><span class="p">,</span> <span class="mf">89000.000</span><span class="p">,</span> <span class="mf">2.2974282383e+10</span><span class="p">,</span>
                   <span class="mf">90000.000</span><span class="p">,</span> <span class="mf">1.8716304570e+10</span><span class="p">,</span> <span class="mf">91000.000</span><span class="p">,</span> <span class="mf">1.5254396937e+10</span><span class="p">,</span> <span class="mf">92000.000</span><span class="p">,</span> <span class="mf">1.2548308770e+10</span><span class="p">,</span> <span class="mf">93000.000</span><span class="p">,</span> <span class="mf">1.0295593615e+10</span><span class="p">,</span> <span class="mf">94000.000</span><span class="p">,</span> <span class="mf">8.3338827301e+09</span><span class="p">,</span> <span class="mf">95000.000</span><span class="p">,</span> <span class="mf">6.6488536883e+09</span><span class="p">,</span>
                   <span class="mf">96000.000</span><span class="p">,</span> <span class="mf">5.2936443303e+09</span><span class="p">,</span> <span class="mf">97000.000</span><span class="p">,</span> <span class="mf">4.2242029799e+09</span><span class="p">,</span> <span class="mf">98000.000</span><span class="p">,</span> <span class="mf">3.3594428424e+09</span><span class="p">,</span> <span class="mf">99000.000</span><span class="p">,</span> <span class="mf">2.6511281727e+09</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">altitudes</span> <span class="o">=</span> <span class="n">co2profile</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span>    <span class="o">=</span> <span class="n">co2profile</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">co2numberdensity</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">ClimatologyUserDefined</span><span class="p">(</span><span class="n">altitudes</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;SKCLIMATOLOGY_CO2_CM3&#39;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>

    <span class="n">atmosphere</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Atmosphere</span><span class="p">()</span>
    <span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;rayleigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">Rayleigh</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">MSIS90</span><span class="p">())</span>
    <span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">HITRANChemical</span><span class="p">(</span><span class="s1">&#39;CO2&#39;</span><span class="p">),</span> <span class="n">co2numberdensity</span> <span class="p">)</span>

    <span class="n">tanalts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="mf">95.542934418655</span><span class="p">,</span> <span class="mf">93.030998230911</span><span class="p">,</span> <span class="mf">90.518486023880</span><span class="p">,</span> <span class="mf">87.999366761185</span><span class="p">,</span> <span class="mf">85.485855103470</span><span class="p">,</span> <span class="mf">82.971916199661</span><span class="p">,</span> <span class="mf">80.457603455521</span><span class="p">,</span> <span class="mf">77.942962647415</span><span class="p">,</span> <span class="mf">75.421955109573</span><span class="p">,</span> <span class="mf">72.906806946732</span><span class="p">,</span>
                 <span class="mf">70.391479493118</span><span class="p">,</span> <span class="mf">67.869934082962</span><span class="p">,</span> <span class="mf">65.354396820999</span><span class="p">,</span> <span class="mf">62.838825226761</span><span class="p">,</span> <span class="mf">60.317182541824</span><span class="p">,</span> <span class="mf">57.801700592972</span><span class="p">,</span> <span class="mf">55.286336899734</span><span class="p">,</span> <span class="mf">52.765050888992</span><span class="p">,</span> <span class="mf">50.250070572830</span><span class="p">,</span> <span class="mf">47.735359192825</span><span class="p">,</span>
                 <span class="mf">45.220966340042</span><span class="p">,</span> <span class="mf">42.682148825007</span><span class="p">,</span> <span class="mf">40.254586233282</span><span class="p">,</span> <span class="mf">37.901745439957</span><span class="p">,</span> <span class="mf">35.689252976524</span><span class="p">,</span> <span class="mf">33.619203107470</span><span class="p">,</span> <span class="mf">31.633878541417</span><span class="p">,</span> <span class="mf">29.706157206720</span><span class="p">,</span> <span class="mf">27.941217916525</span><span class="p">,</span> <span class="mf">26.315136637345</span><span class="p">,</span>
                 <span class="mf">24.759740931714</span><span class="p">,</span> <span class="mf">23.273057386890</span><span class="p">,</span> <span class="mf">21.701357220703</span><span class="p">,</span> <span class="mf">20.435203333687</span><span class="p">,</span> <span class="mf">19.296175927224</span><span class="p">,</span> <span class="mf">18.238125008002</span><span class="p">,</span> <span class="mf">17.137857798933</span><span class="p">,</span> <span class="mf">15.665431416870</span><span class="p">,</span> <span class="mf">14.623809766528</span><span class="p">,</span> <span class="mf">13.581115284387</span><span class="p">,</span>
                 <span class="mf">12.793781944543</span><span class="p">,</span> <span class="mf">11.901170623281</span><span class="p">,</span> <span class="mf">10.978181776555</span><span class="p">,</span> <span class="mf">10.1851695349872</span><span class="p">,</span> <span class="mf">9.4383271471788</span><span class="p">,</span> <span class="mf">8.7424541473265</span><span class="p">,</span> <span class="mf">8.0540969039894</span><span class="p">,</span> <span class="mf">7.5483134223615</span><span class="p">,</span> <span class="mf">7.0824804787830</span><span class="p">,</span> <span class="mf">6.7903857771487</span><span class="p">,</span>
                 <span class="mf">6.3015475934096</span><span class="p">]</span> <span class="p">)</span>

    <span class="n">mjd</span> <span class="o">=</span> <span class="mf">54242.26386852</span>                    <span class="c1"># MJD(&quot;2007-05-22 06:19:58.24&quot;) Use ACE-FTS scan ace.sr20314 as an example.</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="mf">68.91</span>
    <span class="n">lng</span> <span class="o">=</span> <span class="o">-</span><span class="mf">79.65</span>
    <span class="n">sza</span> <span class="o">=</span> <span class="mf">60.0</span>
    <span class="n">saa</span> <span class="o">=</span> <span class="mf">157.5</span>
    <span class="n">rayazi</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">VerticalImage</span><span class="p">()</span>
    <span class="n">geometry</span><span class="o">.</span><span class="n">from_sza_saa</span><span class="p">(</span><span class="n">sza</span><span class="p">,</span> <span class="n">saa</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">tanalts</span><span class="p">,</span> <span class="n">mjd</span><span class="p">,</span> <span class="n">rayazi</span><span class="p">,</span> <span class="n">satalt_km</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">refalt_km</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="n">wavenum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span> <span class="mf">934.0</span><span class="p">,</span> <span class="mf">936.0</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">)</span>
    <span class="n">wavelengths</span> <span class="o">=</span> <span class="mf">1.0E7</span><span class="o">/</span><span class="n">wavenum</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">EngineOCC</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">atmosphere</span><span class="o">=</span><span class="n">atmosphere</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">)</span>

    <span class="n">extinction</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_radiance</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">wavenum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">extinction</span><span class="p">[:,</span><span class="mi">25</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber cm-1&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Log10(Optical Depth)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CO2 Optical Depth. Tan Alt=</span><span class="si">{:7.3f}</span><span class="s1"> km&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tanalts</span><span class="p">[</span><span class="mi">25</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.ray_tracing_wavenumber">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ray_tracing_wavenumber</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sasktran.EngineOCC.ray_tracing_wavenumber" title="Link to this definition">¶</a></dt>
<dd><p>Sets the wavenumber in cm-1 used for tracing curved rays through the atmosphere. Rays are only traced once in
each model and the trajectories are shared between all wavenumber extinction calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wavenumber</strong> (<em>float</em>) – The wavenumber used for tracing rays.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_ground_altitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_ground_altitude</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_ground_altitude" title="Link to this definition">¶</a></dt>
<dd><p>Sets the altitude in meters of the ground shell above the oblate spheroid/sea level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>heightm</strong> (<em>float</em>) – The height of the ground surface above sea-level in meters</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_lines_of_sight_from_tangent_alt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_lines_of_sight_from_tangent_alt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_lines_of_sight_from_tangent_alt" title="Link to this definition">¶</a></dt>
<dd><p>Adds a line of sight generated from the tangent height and an observer height.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tangentheights</strong> (<em>Array</em><em>[</em><em>2*n</em><em>]</em>) – A 2*n element array specifying <code class="docutils literal notranslate"><span class="pre">n</span></code> lines of sight, the first element of each line of sight entry is the
target tangent height and the 2nd element is the observer height. Both are in meters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_lower_bound_altitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_lower_bound_altitude</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_lower_bound_altitude" title="Link to this definition">¶</a></dt>
<dd><p>The lower altitude of the atmosphere in meters used when considering the reference point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>heightm</strong> (<em>float</em>) – The minimum altitude in meters</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_reference_point">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_reference_point</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_reference_point" title="Link to this definition">¶</a></dt>
<dd><p>Sets the reference point to the given location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>location</strong> (<em>array</em><em>[</em><em>4</em><em>]</em>) – three element array specifing [latitude, longitude, height, mjd]. Note that
the height field is ignored.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_reference_point_target_altitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_reference_point_target_altitude</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_reference_point_target_altitude" title="Link to this definition">¶</a></dt>
<dd><p>The target altitude to be used when determining the reference point. The target altitude is used in zenith
and nadir observations to find the location where a ray intersects this altitude. This altitude is then used to
find an average reference point location. The target altitude is used with the target range variable in limb
viewing geometries to apply an increased weighting to lines of sight tangential in the vicinity of the target
altitude. This encourages the reference point to be closer to the lines of sight which are tangential in the
region of the reference point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>heightm</strong> (<em>float</em>) – The target height in meters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_reference_point_target_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_reference_point_target_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_reference_point_target_range" title="Link to this definition">¶</a></dt>
<dd><p>The reference point target range parameter. This variable is only used when calculating the reference point
from limb viewing geometries. Specifies the altitude range above and below the target altitude for enhanced
weighting of limb viewing lines of sight, default 15000 meters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>range</strong> (<em>float</em>) – The height range value in meters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_shells">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_shells</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_shells" title="Link to this definition">¶</a></dt>
<dd><p>Configures the model to use the altitude shells defined by the user. The
shell altitudes must be in ascending order and are specified in meters above sea level.
By default, shell heights are evenly spaced at 1000 m intervals from 0 to 100,000 m.
The diffuse points, by default, are placed in the middle of the shells and the optical
properties are placed both in the middle and on the boundary of each shell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>heights</strong> (<em>array</em><em>[</em><em>n</em><em>]</em>) – The array of shell altitudes in meters above sea level.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_sun">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_sun</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_sun" title="Link to this definition">¶</a></dt>
<dd><p>Manually sets the sun position. Use with caution as many line-of-sight helper functions will also
set the sun’s position inside the internal engine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sun</strong> (<em>array</em><em>[</em><em>3</em><em>]</em>) – The three element array of the sun’s unit vector. Expressed in global geographic coordinates and is in the
directions from the Earth toward the sun.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineOCC.userdefined_upper_bound_altitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">userdefined_upper_bound_altitude</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sasktran.EngineOCC.userdefined_upper_bound_altitude" title="Link to this definition">¶</a></dt>
<dd><p>The maximum altitude of the atmosphere in meters used when considering the reference point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>heightm</strong> (<em>float</em>) – The maximum altitude in meters</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="sasktran-mc">
<h2>SASKTRAN-MC<a class="headerlink" href="#sasktran-mc" title="Link to this heading">¶</a></h2>
<p>SASKTRAN MC is a fully spherical Monte Carlo radiative transfer engine, primarily used as a slow but accurate calibration for HR. It contains additional features as well, namely air mass factor calculation and rotational Raman scattering.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sasktran.EngineMC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sasktran.</span></span><span class="sig-name descname"><span class="pre">EngineMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#sasktran.Geometry" title="sasktran.geometry.Geometry"><span class="pre">Geometry</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="atmosphere.html#sasktran.Atmosphere" title="sasktran.atmosphere.Atmosphere"><span class="pre">Atmosphere</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineMC" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sasktran.Engine" title="sasktran.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sasktran</span> <span class="k">as</span> <span class="nn">sk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># configure your geometry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">VerticalImage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">from_sza_saa</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="mi">54372</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># configure your atmosphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Atmosphere</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;rayleigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">Rayleigh</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">MSIS90</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="o">.</span><span class="n">atmospheric_state</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">MSIS90</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;o3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">O3DBM</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">Labow</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="p">[</span><span class="s1">&#39;no2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">NO2Vandaele1998</span><span class="p">(),</span> <span class="n">sk</span><span class="o">.</span><span class="n">Pratmo</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atmosphere</span><span class="o">.</span><span class="n">brdf</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">Lambertian</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># configure your options</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;setmcdebugmode&#39;</span><span class="p">:</span> <span class="mi">1234</span><span class="p">,</span> <span class="s1">&#39;setnumphotonsperlos&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;setsolartabletype&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make your engine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">EngineMC</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">atmosphere</span><span class="o">=</span><span class="n">atmosphere</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">450</span><span class="p">],</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rad</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_radiance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span> 
<span class="go">[[ 0.11689...  0.10768...  0.04666...  0.01477...]</span>
<span class="go"> [ 0.10643...  0.08429...  0.02972...  0.00802...]</span>
<span class="go"> [ 0.10589...  0.06424...  0.01797...  0.00499...]]</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.air_mass_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">air_mass_factor</span></span><a class="headerlink" href="#sasktran.EngineMC.air_mass_factor" title="Link to this definition">¶</a></dt>
<dd><p>Sets the type of air mass factor calculation.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>No air mass factor calculation</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Air mass factors calculated via path
length</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Air mass factors calculated via path
optical depth</p></td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.air_mass_factor_shells">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">air_mass_factor_shells</span></span><a class="headerlink" href="#sasktran.EngineMC.air_mass_factor_shells" title="Link to this definition">¶</a></dt>
<dd><p>Sets the altitudes that define the layers to calculate air mass factors in. Only relevant if air_mass_factor is
not 0.</p>
<p><strong>Default:</strong> 500 m intervals from 0 m to 100 000 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.air_mass_factor_species">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">air_mass_factor_species</span></span><a class="headerlink" href="#sasktran.EngineMC.air_mass_factor_species" title="Link to this definition">¶</a></dt>
<dd><p>Sets the species used for air mass factor optical depth calculations.</p>
<p>The first supported species listed by the climatology in the atmosphere object associated with this name will
be used. If a supported species further down the list is required, set the ‘amfspecies’ option manually with
a handle from sk.handles.standard_handles().</p>
<p>Only relevant if air_mass_factor is set to 2.</p>
<p><strong>Default:</strong> None</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sasktran.EngineMC.calculate_radiance">
<span class="sig-name descname"><span class="pre">calculate_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_stokes_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stokes_orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'geographic'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasktran.EngineMC.calculate_radiance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate radiances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Determines the output format, one of [‘numpy’ or ‘xarray’].  If output_format=’numpy’, the radiance
and optionally the weighting functions are returned as numpy arrays.  If output_format=’xarray’ the
radiance and weighting functions are returned inside of an xarray Dataset object.</p></li>
<li><p><strong>full_stokes_vector</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the full stokes vector is output.  If False only the first element of the stokes vector
is included. Note that setting this does not automatically enable vector calculations
within the model, it only changes the output format, every model requires a different setting
to be changed to change the calculation mode.  Default: False</p></li>
<li><p><strong>stokes_orientation</strong> (<em>str</em><em>, </em><em>optional</em>) – One of ‘geographic.  The geographic basis is defined relative to the plane formed by the
observer position and look vector.  Here, Q, would be the linear polarization component for the nominal
‘up’ direction of an instrument.
Default: ‘geographic’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If output_format=’numpy’:
The first np.ndarray is always the computed radiances. The shape of the computed
radiances is (W, L) where W is the number of wavelengths, and L is the number of
lines of sight.
If <code class="docutils literal notranslate"><span class="pre">atmosphere.wf_species</span> <span class="pre">!=</span> <span class="pre">None</span></code> then a second np.ndarray will be returned
containing the computed weighting functions. The shape of this np.ndarray is
engine specific but typically (W, L, A) where A is the number of altitudes at which
at which the weighting functions were calculated.
If full_stokes_vector is set to True, then what is returned is an array of <cite>sasktran.StokesVector</cite>
objects.</p>
<p>If output_format=’xarray’:
A dataset containing the radiance and weighting functions with appropriate coordinates.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray <strong>or</strong> np.ndarray, np.ndarray <strong>or</strong> xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.debug_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">debug_mode</span></span><a class="headerlink" href="#sasktran.EngineMC.debug_mode" title="Link to this definition">¶</a></dt>
<dd><p>A non-zero value will fix the random number generator seed to that value and disable multi-threading.</p>
<p><strong>Default:</strong> 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.max_optical_depth_of_cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_optical_depth_of_cell</span></span><a class="headerlink" href="#sasktran.EngineMC.max_optical_depth_of_cell" title="Link to this definition">¶</a></dt>
<dd><p>Set the maximum optical depth of a cell before the adaptive integrator will split it. Only relevant if
optical_property_integration_type is 1.</p>
<p><strong>Default:</strong> 0.1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.max_photons_per_los">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_photons_per_los</span></span><a class="headerlink" href="#sasktran.EngineMC.max_photons_per_los" title="Link to this definition">¶</a></dt>
<dd><p>Sets the maximum number of photon paths to simulate for every line of sight. Simulation stops when this maximum
or the target precision has been reached.</p>
<p><strong>Default:</strong> 10000</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.max_raman_orders">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_raman_orders</span></span><a class="headerlink" href="#sasktran.EngineMC.max_raman_orders" title="Link to this definition">¶</a></dt>
<dd><p>Defines the maximum order of Raman scatter (equal to the length of the list), as well as the maximum
total order of scatter for each order of Raman scatter (the first element corresponding to the first Raman
order, and so on).</p>
<p>Setting this turns the optimized inelastic mode on; if it is left as an empty list, Raman scattering events
will occur at the same rate they would physically. In optimized inelastic mode, Raman scattering events are
forced in order to minimize the variance of the radiance, or the variance of the secondary output if
secondary_output is not 0.</p>
<p>Only relevant if an inelastic species is included in the atmosphere.</p>
<p><strong>Default:</strong> []</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.min_fraction_higher_order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">min_fraction_higher_order</span></span><a class="headerlink" href="#sasktran.EngineMC.min_fraction_higher_order" title="Link to this definition">¶</a></dt>
<dd><p>Sets the fraction of samples that will automatically propagate to the highest order of scatter, regardless of
contribution to the variance. Remaining samples will be truncated to minimize the variance with the minimum
number of simulated scatter events. Set to 1.0 to disable this optimization.</p>
<p><strong>Default:</strong> 0.1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.min_fraction_higher_raman_order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">min_fraction_higher_raman_order</span></span><a class="headerlink" href="#sasktran.EngineMC.min_fraction_higher_raman_order" title="Link to this definition">¶</a></dt>
<dd><p>Defines the fraction of all samples that will, for each order of Raman scatter, always be simulated up to the
maximum total order defined by max_raman_orders. The length of min_fraction_higher_order must be one greater
than the length of max_raman_order, with the extra element at the front of the list represent the 0th Raman
order.</p>
<p>Another option is to specify a scalar here, which will be divided evenly among the Raman orders (this will
likely not be optimal).</p>
<p>The purpose of these minimum fractions is to reduce the small bias introduced by using variance knowledge
to determine what samples will be taken next.</p>
<p>Only relevant if an inelastic species is included in the atmosphere and max_raman_orders has length
greater than 0.</p>
<p><strong>Default:</strong> 0.1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.min_relative_path_weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">min_relative_path_weight</span></span><a class="headerlink" href="#sasktran.EngineMC.min_relative_path_weight" title="Link to this definition">¶</a></dt>
<dd><p>MC simulation of a single photon path stops at some order if each higher-order scatter could add to the
measured radiance by less than w*{amountAlreadyMeasured}. This can save a lot of time, as only the odd
“important” high-order path has to be simulated, but it does introduce a small bias. The importance of each
order of scattering decreases approximately geometrically (except if there are bright clouds, etc), so only
the first truncated photon contributes significantly to this bias. A value of 0.0 indicates no truncation.</p>
<p>Choosing  w = 1 / ( 3 * numPhotonsPerLOS^2 )  makes the negative bias approximately one third of the magnitude
of random noise in the experiment. Very often a photon could make at most a contribution much less than w, so
the bias is actually much smaller than might be expected.</p>
<p><strong>Default:</strong> 0.0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.num_optical_property_altitudes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_optical_property_altitudes</span></span><a class="headerlink" href="#sasktran.EngineMC.num_optical_property_altitudes" title="Link to this definition">¶</a></dt>
<dd><p>Sets the number of evenly spaced altitudes for caching optical properties.</p>
<p><strong>Default:</strong> 201</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.num_orders_of_scatter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_orders_of_scatter</span></span><a class="headerlink" href="#sasktran.EngineMC.num_orders_of_scatter" title="Link to this definition">¶</a></dt>
<dd><p>Controls the number of orders of scatter used inside the model. The number of orders of scatter controls the
accuracy of the model.  When set to 1, only light directly scattered from the sun is accounted for, with no
multiple scattering.</p>
<p><strong>Default:</strong> 50</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.num_ray_tracing_shells">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_ray_tracing_shells</span></span><a class="headerlink" href="#sasktran.EngineMC.num_ray_tracing_shells" title="Link to this definition">¶</a></dt>
<dd><p>Sets the number of evenly spaced atmospheric shells used for ray tracing.</p>
<p><strong>Default:</strong> 201</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.optical_property_integration_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">optical_property_integration_type</span></span><a class="headerlink" href="#sasktran.EngineMC.optical_property_integration_type" title="Link to this definition">¶</a></dt>
<dd><p>Set the optical property table integrator (quadrature) type. Adaptive will split the integration if the
optical depth exceeds max_optical_depth_of_cell.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Straight</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Adaptive</p></td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.optical_property_wavelengths">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">optical_property_wavelengths</span></span><a class="headerlink" href="#sasktran.EngineMC.optical_property_wavelengths" title="Link to this definition">¶</a></dt>
<dd><p>The wavelengths where optical properties will be cached. This is only relevant if inelastic radiance is being
calculated. If inelastic scatters take a photon outside the range defined here, a warning will be thrown and
optical properties will be extrapolated. If a single number is set here, it will be interpreted as a resolution
and the wavelengths will be automatically set over a suitable range at this resolution.</p>
<p><strong>Default:</strong> 1.0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.optical_table_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">optical_table_type</span></span><a class="headerlink" href="#sasktran.EngineMC.optical_table_type" title="Link to this definition">¶</a></dt>
<dd><p>Sets the type of table used to hold the optical properties of the atmosphere.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>One-dimensional (altitude)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Three-dimensional (Delaunay sphere)</p></td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.primary_wavelength">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">primary_wavelength</span></span><a class="headerlink" href="#sasktran.EngineMC.primary_wavelength" title="Link to this definition">¶</a></dt>
<dd><p>Sets the wavelength that will be used to guide the ray tracing when simultaneous_wavelength is True. If the
wavelength set here does not belong to self.wavelengths, the nearest match will be used. If the wavelength set
here is not positive, the wavelength nearest to the midpoint of the range will be used.</p>
<p><strong>Default:</strong> -1.0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.ray_tracer_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ray_tracer_type</span></span><a class="headerlink" href="#sasktran.EngineMC.ray_tracer_type" title="Link to this definition">¶</a></dt>
<dd><p>Set the ray tracer type for rays from the sun into the atmosphere, rays for the observer line of sight, and
rays traced during multiple scattering.</p>
<p>Solar rays should be straight – we don’t have a good algorithm for tracing curved rays from the sun to a point.
MS rays should probably be straight – using curved rays has almost no effect and is a big performance hit.
Using curved MS rays might be desireable for some people.
LOS rays can be either straight or curved – the performance hit for curved rays is pretty small here.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Straight ray tracing: straight rays
intersecting spherical shells</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Curved ray tracing: considering
refraction</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Generic ray tracing: straight rays
intersecting arbitrary shapes</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Curve the observer line of sight only</p></td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> 2</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.scatter_position_resolution">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scatter_position_resolution</span></span><a class="headerlink" href="#sasktran.EngineMC.scatter_position_resolution" title="Link to this definition">¶</a></dt>
<dd><p>Sets the distance to determine the simulated scatter positions within.</p>
<p><strong>Default:</strong> 50 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.secondary_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">secondary_output</span></span><a class="headerlink" href="#sasktran.EngineMC.secondary_output" title="Link to this definition">¶</a></dt>
<dd><p>Select secondary quantities to return alongside inelastic radiance. Only relevant if an inelastic species is
included in the atmosphere.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>No secondary output</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Elastic radiance</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Ring spectrum</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Filling-in parameter</p></td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.simultaneous_wavelength">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">simultaneous_wavelength</span></span><a class="headerlink" href="#sasktran.EngineMC.simultaneous_wavelength" title="Link to this definition">¶</a></dt>
<dd><p>If true, multiple wavelengths will be calculated simultaneously using common ray tracing. This should not be
used if air mass factors are being calculated.</p>
<p><strong>Default:</strong> False</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.solar_irradiance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solar_irradiance</span></span><a class="headerlink" href="#sasktran.EngineMC.solar_irradiance" title="Link to this definition">¶</a></dt>
<dd><p>The solar spectrum used for inelastic radiance calculation, on the wavelength grid specified by
optical_property_wavelengths. If a scalar is given, the solar spectrum will be constant.</p>
<p><strong>Default:</strong> 1.0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.solar_table_altitude_delta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solar_table_altitude_delta</span></span><a class="headerlink" href="#sasktran.EngineMC.solar_table_altitude_delta" title="Link to this definition">¶</a></dt>
<dd><p>Sets the altitude spacing for the solar transmission table. Only relevant if solar_table_type is 1 or 2.</p>
<p><strong>Default:</strong> 500 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.solar_table_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solar_table_type</span></span><a class="headerlink" href="#sasktran.EngineMC.solar_table_type" title="Link to this definition">¶</a></dt>
<dd><p>Sets the method for calculating solar transmissions.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>No table; solar transmissions
calculated on the fly</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Two-dimensional in altitude and solar
zenith angle
along the line of sight</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Three-dimensional in altitude, solar
zenith angle, and solar longitude</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>No solar contribution.</p></td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> 1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.surface_elevation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">surface_elevation</span></span><a class="headerlink" href="#sasktran.EngineMC.surface_elevation" title="Link to this definition">¶</a></dt>
<dd><p>Sets the elevation of the surface in [m] for the model.  This setting can be used to account for changes in the Earth’s
topography.</p>
<p><strong>Default:</strong> 0 m</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.target_std">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">target_std</span></span><a class="headerlink" href="#sasktran.EngineMC.target_std" title="Link to this definition">¶</a></dt>
<dd><p>Sets the target for the relative precision of the simulation. Precision (stdev/result) varies as N^{-1/2}.
Simulation stops when this target or the maximum number of photon paths has been reached.</p>
<p><strong>Default:</strong> 0.01</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sasktran.EngineMC.top_of_atmosphere_altitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top_of_atmosphere_altitude</span></span><a class="headerlink" href="#sasktran.EngineMC.top_of_atmosphere_altitude" title="Link to this definition">¶</a></dt>
<dd><p>Sets the altitude of the top of the atmosphere.  Above this altitude it is assumed there is no atmosphere.
The default value of 100000 m is typically suitable for stratospheric applications but for the mesosphere it
is sometimes necessary to increase this value.</p>
<p><strong>Default:</strong> 100000 m</p>
</dd></dl>

</dd></dl>

</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt><a class="reference internal" href="geometry.html#geometry"><span class="std std-ref">Geometry</span></a></dt><dd><p>Objects which describe the geometry of the calculations to the engine. At a minimum these
objects define the <a class="reference internal" href="lines_of_sight.html#lines-of-sight"><span class="std std-ref">Lines of Sight</span></a>, but can also specify things such as the suns
position and the polling reference point.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="atmosphere.html#atmosphere"><span class="std std-ref">Atmosphere</span></a></dt><dd><p>An object that describes the atmospheric constituents, and surface type to the engine.
Atmospheric constituents are defined by a list of <a class="reference internal" href="species.html#species"><span class="std std-ref">Species</span></a>, and surfaces are defined by
a given <a class="reference internal" href="brdf.html#brdf"><span class="std std-ref">BRDF</span></a>.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="climatology.html" class="btn btn-neutral float-left" title="Climatology" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="geodetic.html" class="btn btn-neutral float-right" title="Geodetic" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, ARG University of Saskatchewan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
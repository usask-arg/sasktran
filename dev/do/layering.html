<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Layering and Vertical Grids in SASKTRAN-DO &mdash; SASKTRAN 1.8.1+2.g0944a46 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/_static/theme_overrides.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/sasktran-favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=cfaf87bc"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Polarization" href="polarization.html" />
    <link rel="prev" title="Advanced Topics" href="advanced.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/sasktran-light.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.8.1+2.g0944a46
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing SASKTRAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../constructing_atmosphere.html">Specifying the Atmosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../constructing_geometry.html">Constructing the Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other_engines.html">Choosing an Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_aerosol.html">Specifying Aerosol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experimental.html">Experimental Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sasktran_hr.html">SASKTRAN-HR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tir/index.html">SASKTRAN Thermal InfraRed Engine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">SASKTRAN-DO</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quick_start.html">Sasktran-Disco Quick Start</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="advanced.html">Advanced Topics</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Layering and Vertical Grids in SASKTRAN-DO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-altitude-grid">The Altitude Grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#layer-construction">Layer Construction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accuracy-involving-the-number-of-layers">Accuracy Involving the Number of Layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="polarization.html">Polarization</a></li>
<li class="toctree-l3"><a class="reference internal" href="spherical.html">Spherical Approximations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lowlevelmain.html">The Low Level Interface to SASKTRAN-DO</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SASKTRAN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">SASKTRAN-DO</a></li>
          <li class="breadcrumb-item"><a href="advanced.html">Advanced Topics</a></li>
      <li class="breadcrumb-item active">Layering and Vertical Grids in SASKTRAN-DO</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/do/layering.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="layering-and-vertical-grids-in-sasktran-do">
<span id="layering"></span><h1>Layering and Vertical Grids in SASKTRAN-DO<a class="headerlink" href="#layering-and-vertical-grids-in-sasktran-do" title="Link to this heading">¶</a></h1>
<p>The discrete ordinates method (and by extension, SASKTRAN-DO) represents the atmosphere by a set of stacked,
homogenous layers.  Each layer is characterized by the vertical optical depth, single scattering albedo, and
Legendre coefficients of the phase function expansion.  If you are familiar with “pure scattering” radiative transfer
models such as DISORT or LIDORT these are the input quantities you may be used to, however SASKTRAN-DO operates
with a higher level interface.  This page describes internally how SASKTRAN-DO
interprets the input it is provided.</p>
<section id="the-altitude-grid">
<h2>The Altitude Grid<a class="headerlink" href="#the-altitude-grid" title="Link to this heading">¶</a></h2>
<p>We can think of the primary input to SASKTRAN-DO being number density of a variety of species on a fixed altitude grid.
The altitude grid object is set through the <a class="reference internal" href="../engine.html#sasktran.EngineDO.alt_grid" title="sasktran.EngineDO.alt_grid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sasktran.EngineDO.alt_grid()</span></code></a> method of the engine,
with the default being a linearly spaced grid from 0 km to 100 km with a spacing of 0.5 km.  Any climatology
you provide to the atmospheric state will be sampled at this altitude grid.  If you are using user defined climatology
objects we recommend matching the altitude grid in those objects to the altitude grid in the engine, although
this is not strictly necessary. When constructing homogeneous layers the model will internally integrate the atmospheric
state over this altitude grid, assuming linear interpolation between grid points.  Any weighting function with
respect to an atmospheric species will be returned with respect to this altitude grid.  The altitude grid need not be
uniformly spaced, and the bottom and top altitudes can be set to any value.</p>
</section>
<section id="layer-construction">
<h2>Layer Construction<a class="headerlink" href="#layer-construction" title="Link to this heading">¶</a></h2>
<p>While inputs are specified on an altitude grid, internally the discrete ordinate technique requires homogenous layers.
As previously mentioned, the layer properties are calculated by integrating the atmospheric state over the layer boundaries,
but there are multiple ways to determine how the layer boundaries themselves are determined.  SASKTRAN-DO
provides multiple options to do this, which method is preferred can be application dependent.  The two properties that
primarily influence the layer construction are <code class="xref py py-meth docutils literal notranslate"><span class="pre">sasktran.EngineDO.num_layers()</span></code>, which
controls the total number of homogeneous layers, and <a class="reference internal" href="../engine.html#sasktran.EngineDO.layer_construction" title="sasktran.EngineDO.layer_construction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sasktran.EngineDO.layer_construction()</span></code></a> which
controls the technique to determine the layer boundaries.</p>
<section id="uniform-pressure-layers">
<h3>Uniform Pressure Layers<a class="headerlink" href="#uniform-pressure-layers" title="Link to this heading">¶</a></h3>
<p>The default method to construct layers is to place the boundaries uniform in pressure.  This is a good technique
for a variety of applications as it results in layers that are more densely spaced close to the surface where scattering is
the greatest.  It also results in layer boundaries that are independent of the input concentrations.  This is the default
setting but can be manually specified with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="o">.</span><span class="n">layer_construction</span> <span class="o">=</span> <span class="s1">&#39;uniform_pressure&#39;</span>
</pre></div>
</div>
</section>
<section id="uniform-height-layers">
<h3>Uniform Height Layers<a class="headerlink" href="#uniform-height-layers" title="Link to this heading">¶</a></h3>
<p>Another option is to place the layers uniformly in altitude.  This can be beneficial when operating in limb mode
where altitude variation is important or in areas of large absorption.  This can be set through</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="o">.</span><span class="n">layer_construction</span> <span class="o">=</span> <span class="s1">&#39;uniform_height&#39;</span>
</pre></div>
</div>
<p>A secondary option is to match the layers directly with the internal altitude grid through</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="o">.</span><span class="n">layer_construction</span> <span class="o">=</span> <span class="s1">&#39;match_altitude_grid&#39;</span>
</pre></div>
</div>
<p>note that setting this will set both the number of layers and layer construction method options.</p>
</section>
<section id="manually-specifying-layer-boundaries">
<h3>Manually Specifying Layer Boundaries<a class="headerlink" href="#manually-specifying-layer-boundaries" title="Link to this heading">¶</a></h3>
<p>Lastly, layers can be manual specified through</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="o">.</span><span class="n">layer_construction</span> <span class="o">=</span> <span class="n">array_containing_boundaries_in_m</span>
</pre></div>
</div>
<p>this option will simultaneously set the layer boundaries and the number of layers.  The number of layers will be
equal to the number of layer boundaries minus one.</p>
</section>
</section>
<section id="accuracy-involving-the-number-of-layers">
<h2>Accuracy Involving the Number of Layers<a class="headerlink" href="#accuracy-involving-the-number-of-layers" title="Link to this heading">¶</a></h2>
<p>Including more layers both improves the models ability to represent vertical inhomogeneity, and improves the calculation
of the pseudo-spherical beam transmittance.  The number of layers required to achieve a certain level of accuracy will be
highly application dependent.  Generally in areas of the spectrum with little absorption less layers are required, while large
amounts of absorption benefits from more layers.  It is recommended to play around with the number of layers until a specific
level of accuracy has been obtained.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="advanced.html" class="btn btn-neutral float-left" title="Advanced Topics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="polarization.html" class="btn btn-neutral float-right" title="Polarization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, ARG University of Saskatchewan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
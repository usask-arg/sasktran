<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spherical Approximations &mdash; SASKTRAN 0+untagged.1.gabd5774 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/_static/theme_overrides.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/sasktran-favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Low Level Interface to SASKTRAN-DO" href="lowlevelmain.html" />
    <link rel="prev" title="Polarization" href="polarization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/sasktran-light.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0+untagged.1.gabd5774
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing SASKTRAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../constructing_atmosphere.html">Specifying the Atmosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../constructing_geometry.html">Constructing the Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other_engines.html">Choosing an Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_aerosol.html">Specifying Aerosol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experimental.html">Experimental Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sasktran_hr.html">SASKTRAN-HR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tir/index.html">SASKTRAN Thermal InfraRed Engine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">SASKTRAN-DO</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quick_start.html">Sasktran-Disco Quick Start</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="advanced.html">Advanced Topics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="layering.html">Layering and Vertical Grids in SASKTRAN-DO</a></li>
<li class="toctree-l3"><a class="reference internal" href="polarization.html">Polarization</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Spherical Approximations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pseudo-spherical-approximation">Pseudo-Spherical Approximation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#line-of-sight-spherical-corrections">Line of Sight Spherical Corrections</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lowlevelmain.html">The Low Level Interface to SASKTRAN-DO</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SASKTRAN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">SASKTRAN-DO</a></li>
          <li class="breadcrumb-item"><a href="advanced.html">Advanced Topics</a></li>
      <li class="breadcrumb-item active">Spherical Approximations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/do/spherical.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spherical-approximations">
<span id="spherical"></span><h1>Spherical Approximations<a class="headerlink" href="#spherical-approximations" title="Permalink to this heading">¶</a></h1>
<p>While SK-DO is based on the discrete ordinates technique which is designed for a plane-parallel atmosphere, SK-DO
contains several approximations to handle various levels of sphericity.</p>
<section id="pseudo-spherical-approximation">
<h2>Pseudo-Spherical Approximation<a class="headerlink" href="#pseudo-spherical-approximation" title="Permalink to this heading">¶</a></h2>
<p>The pseudo-spherical approximation is a common method where the incoming solar beam is treated in a spherical
atmosphere.  These transmittances are then used to initialize the discrete ordinates technique.  The pseudo-spherical
approximation is enabled by default, and there is usually no reason to disable it as it does not have any computational
overhead involved in using it.  However, it can be disabled with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;usepseudospherical&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>if desired.</p>
</section>
<section id="line-of-sight-spherical-corrections">
<h2>Line of Sight Spherical Corrections<a class="headerlink" href="#line-of-sight-spherical-corrections" title="Permalink to this heading">¶</a></h2>
<p>SK-DO also contains the capability to include spherical effects along the line of sight.  In this mode the
line of sight ray is traced in a fully spherical atmosphere.  Single scattering source terms are calculated exactly
inside the spherical atmosphere.  Multiple scatter source terms are calculated using the discrete ordinates method
at multiple solar zenith angles along the line of sight.  These sources are then integrated along the line of sight
to get the total radiance.  This method is generally very accurate for almost every nadir viewing application, and
can be accurate for some limb-viewing applications at low tangent altitudes.</p>
<p>The technique can be enabled with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="o">.</span><span class="n">viewing_mode</span> <span class="o">=</span> <span class="s1">&#39;spherical&#39;</span>
</pre></div>
</div>
<p>and the main parameter controlling the accuracy of the calculation is</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="o">.</span><span class="n">num_spherical_sza</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># default</span>
</pre></div>
</div>
<p>which controls the number of plane-parallel solutions calculated along the line of sight.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="polarization.html" class="btn btn-neutral float-left" title="Polarization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lowlevelmain.html" class="btn btn-neutral float-right" title="The Low Level Interface to SASKTRAN-DO" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, ARG University of Saskatchewan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>